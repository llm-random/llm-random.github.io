<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Szymon Antoniak&nbsp;*">
<meta name="author" content="Sebastian Jaszczur&nbsp;*&nbsp;†">
<meta name="author" content="Michał Krutul">
<meta name="author" content="Maciej Pióro">
<meta name="author" content="Jakub Krajewski">
<meta name="author" content="Jan Ludziejewski">
<meta name="author" content="Tomasz Odrzygóźdź">
<meta name="author" content="Marek Cygan&nbsp;‡">
<meta name="dcterms.date" content="2023-10-06">

<title>llm-random - Mixture of Tokens</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QHXJCKXK7M"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QHXJCKXK7M', { 'anonymize_ip': true});
</script>
<script charset="utf-8" src="https://cdn.plot.ly/plotly-2.20.0.min.js"> </script>
<style>

  .MK {

  # display: none;
  color: brown;
  }
  .MK::before {

  content: "[MK] ";
  }

  .SA {

  # display: none;
  color: goldenrod;
  }
  .SA::before {

  content: "[SA] ";
  }

  .MP {

  # display: none;
  color: teal;
  }
  .MP::before {

  content: "[MP] ";
  }

  .JK {

  # display: none;
  color: coral;
  }
  .JK::before {

  content: "[JK] ";
  }

  .JL {

  # display: none;
  color: green;
  }
  .JL::before {

  content: "[JL] ";
  }

  .TO {

  # display: none;
  color: purple;
  }
  .TO::before {

  content: "[TO] ";
  }

  .MC {

  # display: none;
  color: red;
  }
  .MC::before {

  content: "[MC] ";
  }

  .SJ {

  # display: none;
  color: blue;
  }
  .SJ::before {

  content: "[SJ] ";
  }

  .NONE {
      display: none;
  }
</style>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">llm-random</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <style>
    .equal-contribution {
      padding: 10px;
      margin: 10px 0px;
      font-size: small;
      text-align: right;
    }
  </style>
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Mixture of Tokens</h1>
                      </div>
  </div>

  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-heading">Affiliations</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Szymon Antoniak&nbsp;* </p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              IDEAS NCBR
            </p>
          <p class="affiliation">
              University of Warsaw
            </p>
        </div>
        <div class="quarto-title-meta-contents">
      <p class="author">Sebastian Jaszczur&nbsp;*&nbsp;† </p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              IDEAS NCBR
            </p>
          <p class="affiliation">
              University of Warsaw
            </p>
        </div>
        <div class="quarto-title-meta-contents">
      <p class="author">Michał Krutul </p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              IDEAS NCBR
            </p>
          <p class="affiliation">
              University of Warsaw
            </p>
        </div>
        <div class="quarto-title-meta-contents">
      <p class="author">Maciej Pióro </p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              IDEAS NCBR
            </p>
          <p class="affiliation">
              University of Warsaw
            </p>
        </div>
        <div class="quarto-title-meta-contents">
      <p class="author">Jakub Krajewski </p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              IDEAS NCBR
            </p>
          <p class="affiliation">
              University of Warsaw
            </p>
        </div>
        <div class="quarto-title-meta-contents">
      <p class="author">Jan Ludziejewski </p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              IDEAS NCBR
            </p>
          <p class="affiliation">
              University of Warsaw
            </p>
        </div>
        <div class="quarto-title-meta-contents">
      <p class="author">Tomasz Odrzygóźdź </p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              IDEAS NCBR
            </p>
          <p class="affiliation">
              University of Warsaw
            </p>
        </div>
        <div class="quarto-title-meta-contents">
      <p class="author">Marek Cygan&nbsp;‡ </p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              University of Warsaw
            </p>
          <p class="affiliation">
              Nomagic
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 6, 2023</p>
      </div>
    </div>
    
      
    </div>
    



  <div class="equal-contribution">
    * core contributors
    <br> † initial idea and project supervision
    <br> ‡ research direction and high-level supervision
    <!-- * equal contribution
    <br /> † initial idea and project supervision
    <br /> ‡ research direction and high-level supervision
    <br /> ♭  -->
  </div>


  <script>
    function replaceTextWithYellowColor() {
      var elements = document.getElementsByClassName("MK");

      for (var i = 0; i < elements.length; i++) {
        elements[i].style.color = "yellow";
      }
    }
  </script>

</header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">

<!-- Taken from https://github.com/quarto-dev/quarto-cli/blob/a5a81f5d2afa2664f8748ac9ae5e70b4a0a2baf7/src/resources/formats/html/templates/banner/title-block.html -->



<!-- # TEST

[new text]{.SA}~~old text~~

[new text]{.MK}~~old text~~

[new text]{.MP}~~old text~~

[new text]{.JK}~~old text~~

[new text]{.JL}~~old text~~

[new text]{.TO}~~old text~~

[new text]{.SJ}~~old text~~

[new text]{.MC}~~old text~~

-->
<!--
# Standardization 
- feed-forward 
- American
- Past vs present? PAST o innym researchu, PRESENT o naszym 
- Vanilla Transformer, not dense baseline
- importance weights vs weights vs ???
- average, not mean
-->
<section id="tldr" class="level2">
<h2 class="anchored" data-anchor-id="tldr">TL;DR</h2>
<p><span class="NONE">We introduce Mixture of Tokens, a novel, fully-differentiable Transformer architecture that allows for increasing model size while keeping computation cost constant. xxxx</span> We introduce Mixture of Tokens, a novel, fully-differentiable Transformer architecture that allows for increasing model size while keeping computation cost constant.</p>
<ul>
<li>It avoids problems typical for Mixture of Experts architectures</li>
<li>It is compatible with causal and masked Large Language Models</li>
<li>Our PoC model achieves the same performance as the baseline Transformer with <span class="math inline">\(3\times\)</span>&nbsp;wall-clock speedup and <span class="math inline">\(4\times\)</span>&nbsp;FLOPS reduction</li>
</ul>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Mixture of Experts (MoE) architectures have recently garnered considerable attention for their ability to increase the size of Transformer models while keeping the computational cost of training and inference constant. The most successful MoE approaches achieve this by activating only subsets of a very large feed forward layer for each processed token (the alternative subsets of parameters are often called <em>experts</em>).</p>
<p>This technique comes at a cost, though: the operation of choosing the most suitable experts for a given token is discrete, and learning discrete choices is difficult; the models are known to suffer from issues including training instability and expert under- and overload. While some of those problems can be alleviated with e.g.&nbsp;the use of various auxiliary losses or reduced initialisation scale, it is certain that existing MoE techniques are more difficult and less intuitive to train than dense counterparts.</p>
<p>Aiming to avoid these problems we propose <strong>Mixture of Tokens</strong>: a new, fully-differentiable type of architecture that retains all efficiency benefits of MoE and alleviates the aformentioned problems by <em>mixing tokens</em> before feeding them into the feed-forward layer instead of routing tokens to experts, in effect allowing the model to simultaneously learn from all token-expert combinations. Crucially, this technique is fully compatible with both masked and causal LLM training.</p>
<p><span class="SA">GENERAL TODOS: grammarly, go over and rephrase, align and make clearer the Methods section, make mail, tweet, settle on contribution attributions,</span></p>
</section>
<section id="motivation" class="level1">
<h1>Motivation</h1>
<section id="scaling-language-models" class="level2">
<h2 class="anchored" data-anchor-id="scaling-language-models">Scaling Language Models</h2>
<p>Large language models based on Transformers currently make up one of the most active fields in ​​Artificial Intelligence, exhibiting human-level performance in a variety of tasks. This is in large part due to their scaling properties - <span class="citation" data-cites="kaplan2020scaling hoffmann2022training">(<a href="#ref-kaplan2020scaling" role="doc-biblioref">Kaplan et al. 2020</a>; <a href="#ref-hoffmann2022training" role="doc-biblioref">Hoffmann et al. 2022</a>)</span> showed that an increase in model size results in a predictable increase in performance. This scaling leads to an ever-growing demand for computational resources, with their effective utilization often deemed as one of the critical challenges of the field <span class="citation" data-cites="rae2022scaling jaszczur2021sparse nawrot2022hierarchical">(<a href="#ref-rae2022scaling" role="doc-biblioref">Rae et al. 2022</a>; <a href="#ref-jaszczur2021sparse" role="doc-biblioref">Jaszczur et al. 2021</a>; <a href="#ref-nawrot2022hierarchical" role="doc-biblioref">Nawrot et al. 2022</a>)</span>.</p>
</section>
<section id="mixture-of-experts" class="level2">
<h2 class="anchored" data-anchor-id="mixture-of-experts">Mixture of Experts</h2>
<p>How can we increase the model size without additional computational cost? Mixture of Expert does this by replacing the feed-forward layer standard for Transformer architectures with a (potentially very large) set of experts, together with a small network often called a <em>controller</em><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. The (trainable) controller matches tokens and experts in a way that each token is processed only by a small subset of experts.</p>
<p>Similarly to vanilla Transformers, the performance of MoE models also scale with parameter count <span class="citation" data-cites="clark2022unified">(<a href="#ref-clark2022unified" role="doc-biblioref">Clark et al. 2022</a>)</span>. For a more detailed background and explanation of variants of the MoE architecture, see <a href="#sec-back">Background</a>.</p>
</section>
<section id="limitations-of-current-approaches" class="level2">
<h2 class="anchored" data-anchor-id="limitations-of-current-approaches">Limitations of current approaches</h2>
<p>While the performance of the huge-parameter-count MoE architectures is impressive, they come with an entirely new set of challenges, during both training and inference. The most notable include:</p>
<ul>
<li><p><strong>Training instability.</strong> Multiple studies <span class="citation" data-cites="fedus2022switch du2022glam mustafa2022multimodal">(<a href="#ref-fedus2022switch" role="doc-biblioref">Fedus, Zoph, and Shazeer 2022</a>; <a href="#ref-du2022glam" role="doc-biblioref">Du et al. 2022</a>; <a href="#ref-mustafa2022multimodal" role="doc-biblioref">Mustafa et al. 2022</a>)</span> report difficulties in training MoE models due to instabilities. This is likely due to with the nature of the technique: the operation of choosing top-k most relevant tokens/experts in discrete, and thus small changes of controller weights can have disproportional effects on controller decisions. We hypothesise that existing techniques used for training the cotnroller with gradient descent, while somewhat effective, do not entirely solve this problem. <span class="citation" data-cites="jaszczur2021sparse">(<a href="#ref-jaszczur2021sparse" role="doc-biblioref">Jaszczur et al. 2021</a>)</span> reported training stability improvements due to using a weighted average of expert outputs instead of sampling.</p></li>
<li><p><strong>Load imbalance.</strong> Typically, in MoE we set the maximum <em>capacity</em> for each expert. However, we are not able to efficiently restrict the choice of the routing network to assign tokens in a perfectly balanced way. This leads to <em>token dropping</em> (when some tokens are not processed by an expert) and <em>mode collapse</em> (when the cotroller sends almost all tokens to a few experts).</p></li>
<li><p><strong>Information leak.</strong> Some of the most successful MoE methods process tokens from different positions in a sequence together (i.e.&nbsp;by comparing scores of all tokens in a batch). This imposes an information leak, and hinders their utility in autoregressive decoding.</p></li>
</ul>
<p>Our technique is as stable as a vanilla Transformer, because the network is fully differentiable and no discrete choices are made during training. As every expert receives the same number of tokens, the issue of load imbalance is side-stepped as well. Finally, our technique is fully compatible with autoregressive decoding. See a detailed explanation of the technique in [Method].</p>
</section>
</section>
<section id="sec-back" class="level1">
<h1>Background</h1>
<p>In the context of language models, Mixture of Experts was originally proposed in <span class="citation" data-cites="shazeer2017outrageously">(<a href="#ref-shazeer2017outrageously" role="doc-biblioref">Shazeer et al. 2017</a>)</span>. The basic idea is as follows: instead of processing all tokens with the standard feed-forward layer, we route each processed token to a small subset of multiple experts. The technique was further simplified by <span class="citation" data-cites="fedus2022switch">(<a href="#ref-fedus2022switch" role="doc-biblioref">Fedus, Zoph, and Shazeer 2022</a>)</span> by proposing the Switch Transformer, which sends each token to only <em>one</em> expert with the highest score produced by the controller. The technique allowed them to train a 1.6T model with a T5 architecture with FLOP cost of an equivalent 1.4B vanilla Transformer. In both cases auxiliary losses are needed in order to encourage exploration and mitigate load imbalance across experts.</p>
<p>More recently, <span class="citation" data-cites="zhou2022mixtureofexperts">(<a href="#ref-zhou2022mixtureofexperts" role="doc-biblioref">Zhou et al. 2022</a>)</span> proposed Expert Choice, where, in contrast to Switch, each <em>expert</em> chooses which token to process. This results in a tradeoff: on one hand, each expert receives the same number of tokens, side stepping the load balancing issue, one the other hand different tokens might be attended to by varying numbers of experts and some tokens might not be chosen by any expert. Both approaches, as well as a standard feed-forward Transformer layer, are illustrated in the diagram below.</p>
<div class="simontwice_style">
  <div>
    <svg width="1750" height="338" viewbox="0 0 1750 338" fill="none" xmlns="http://www.w3.org/2000/svg">
    <rect width="1750" height="338" fill="#E5E5E5"></rect>
    <rect width="5644" height="2464" transform="translate(-1336 -1139)" fill="white"></rect>
    <path d="M409 116.8H271C264.925 116.8 260 121.725 260 127.8V185.8C260 191.875 264.925 196.8 271 196.8H409C415.075 196.8 420 191.875 420 185.8V127.8C420 121.725 415.075 116.8 409 116.8Z" fill="#DAE8FC"></path>
    <path d="M322.523 162.3V152.118H328.628V153.212H323.756V156.652H328.171V157.746H323.756V162.3H322.523ZM330.74 162.3V152.118H336.845V153.212H331.973V156.652H336.387V157.746H331.973V162.3H330.74ZM347.03 152.118V162.3H345.837L340.289 154.306H340.189V162.3H338.957V152.118H340.15L345.718 160.132H345.817V152.118H347.03ZM356.836 152.118V162.3H355.603V153.411H355.543L353.057 155.061V153.809L355.603 152.118H356.836Z" fill="#393D6A"></path>
    <path d="M409 117.3H271C265.201 117.3 260.5 122.001 260.5 127.8V185.8C260.5 191.599 265.201 196.3 271 196.3H409C414.799 196.3 419.5 191.599 419.5 185.8V127.8C419.5 122.001 414.799 117.3 409 117.3Z" stroke="#000066" stroke-opacity="0.6"></path>
    <path d="M589 116.8H451C444.925 116.8 440 121.725 440 127.8V185.8C440 191.875 444.925 196.8 451 196.8H589C595.075 196.8 600 191.875 600 185.8V127.8C600 121.725 595.075 116.8 589 116.8Z" fill="#DAE8FC"></path>
    <path d="M501.539 162.3V152.118H507.644V153.212H502.772V156.652H507.186V157.746H502.772V162.3H501.539ZM509.755 162.3V152.118H515.861V153.212H510.988V156.652H515.403V157.746H510.988V162.3H509.755ZM526.046 152.118V162.3H524.853L519.305 154.306H519.205V162.3H517.972V152.118H519.165L524.734 160.132H524.833V152.118H526.046ZM532.272 162.3V161.405L535.633 157.726C536.027 157.295 536.352 156.921 536.607 156.603C536.862 156.281 537.051 155.979 537.174 155.698C537.3 155.413 537.363 155.114 537.363 154.803C537.363 154.445 537.276 154.135 537.104 153.873C536.935 153.611 536.703 153.409 536.408 153.267C536.113 153.124 535.782 153.053 535.414 153.053C535.023 153.053 534.681 153.134 534.39 153.296C534.101 153.456 533.878 153.679 533.718 153.968C533.563 154.256 533.485 154.594 533.485 154.982H532.312C532.312 154.385 532.449 153.862 532.724 153.411C532.999 152.96 533.374 152.609 533.848 152.357C534.325 152.105 534.86 151.979 535.454 151.979C536.05 151.979 536.579 152.105 537.04 152.357C537.5 152.609 537.861 152.948 538.123 153.376C538.385 153.804 538.516 154.279 538.516 154.803C538.516 155.177 538.448 155.544 538.312 155.902C538.18 156.256 537.948 156.652 537.616 157.09C537.288 157.524 536.832 158.054 536.249 158.681L533.962 161.127V161.206H538.695V162.3H532.272Z" fill="#393D6A"></path>
    <path d="M589 117.3H451C445.201 117.3 440.5 122.001 440.5 127.8V185.8C440.5 191.599 445.201 196.3 451 196.3H589C594.799 196.3 599.5 191.599 599.5 185.8V127.8C599.5 122.001 594.799 117.3 589 117.3Z" stroke="#000066" stroke-opacity="0.6"></path>
    <path d="M769 116.8H631C624.925 116.8 620 121.725 620 127.8V185.8C620 191.875 624.925 196.8 631 196.8H769C775.075 196.8 780 191.875 780 185.8V127.8C780 121.725 775.075 116.8 769 116.8Z" fill="#DAE8FC"></path>
    <path d="M681.32 162.3V152.118H687.425V153.212H682.553V156.652H686.968V157.746H682.553V162.3H681.32ZM689.537 162.3V152.118H695.642V153.212H690.77V156.652H695.184V157.746H690.77V162.3H689.537ZM705.827 152.118V162.3H704.634L699.086 154.306H698.986V162.3H697.753V152.118H698.947L704.515 160.132H704.614V152.118H705.827ZM715.493 162.439C714.837 162.439 714.252 162.327 713.738 162.101C713.228 161.876 712.822 161.563 712.52 161.162C712.222 160.757 712.06 160.288 712.033 159.755H713.286C713.312 160.083 713.425 160.366 713.624 160.605C713.823 160.84 714.083 161.022 714.405 161.152C714.726 161.281 715.082 161.346 715.473 161.346C715.911 161.346 716.299 161.269 716.637 161.117C716.975 160.964 717.24 160.752 717.432 160.48C717.624 160.209 717.721 159.894 717.721 159.536C717.721 159.161 717.628 158.832 717.442 158.546C717.257 158.258 716.985 158.033 716.627 157.87C716.269 157.708 715.831 157.627 715.314 157.627H714.499V156.533H715.314C715.719 156.533 716.073 156.46 716.378 156.314C716.687 156.168 716.927 155.963 717.099 155.698C717.275 155.433 717.363 155.121 717.363 154.763C717.363 154.418 717.286 154.118 717.134 153.863C716.982 153.608 716.766 153.409 716.488 153.267C716.213 153.124 715.888 153.053 715.513 153.053C715.162 153.053 714.83 153.118 714.519 153.247C714.211 153.373 713.959 153.557 713.763 153.799C713.568 154.037 713.462 154.326 713.445 154.664H712.252C712.272 154.13 712.432 153.663 712.734 153.262C713.036 152.857 713.43 152.542 713.917 152.317C714.408 152.092 714.946 151.979 715.533 151.979C716.163 151.979 716.703 152.107 717.154 152.362C717.605 152.614 717.951 152.947 718.193 153.361C718.435 153.775 718.556 154.223 718.556 154.703C718.556 155.277 718.405 155.766 718.103 156.17C717.805 156.574 717.399 156.854 716.885 157.01V157.09C717.528 157.196 718.031 157.469 718.392 157.91C718.753 158.348 718.934 158.89 718.934 159.536C718.934 160.089 718.783 160.587 718.481 161.027C718.183 161.465 717.775 161.81 717.258 162.061C716.741 162.313 716.153 162.439 715.493 162.439Z" fill="#393D6A"></path>
    <path d="M769 117.3H631C625.201 117.3 620.5 122.001 620.5 127.8V185.8C620.5 191.599 625.201 196.3 631 196.3H769C774.799 196.3 779.5 191.599 779.5 185.8V127.8C779.5 122.001 774.799 117.3 769 117.3Z" stroke="#000066" stroke-opacity="0.6"></path>
    <path d="M949 116.8H811C804.925 116.8 800 121.725 800 127.8V185.8C800 191.875 804.925 196.8 811 196.8H949C955.075 196.8 960 191.875 960 185.8V127.8C960 121.725 955.075 116.8 949 116.8Z" fill="#DAE8FC"></path>
    <path d="M861.286 162.3V152.118H867.391V153.212H862.519V156.652H866.933V157.746H862.519V162.3H861.286ZM869.502 162.3V152.118H875.608V153.212H870.735V156.652H875.15V157.746H870.735V162.3H869.502ZM885.793 152.118V162.3H884.6L879.052 154.306H878.952V162.3H877.719V152.118H878.912L884.481 160.132H884.58V152.118H885.793ZM891.78 160.212V159.198L896.255 152.118H896.99V153.689H896.493L893.113 159.039V159.118H899.138V160.212H891.78ZM896.573 162.3V159.904V159.431V152.118H897.746V162.3H896.573Z" fill="#393D6A"></path>
    <path d="M949 117.3H811C805.201 117.3 800.5 122.001 800.5 127.8V185.8C800.5 191.599 805.201 196.3 811 196.3H949C954.799 196.3 959.5 191.599 959.5 185.8V127.8C959.5 122.001 954.799 117.3 949 117.3Z" stroke="#000066" stroke-opacity="0.6"></path>
    <path d="M579.63 47.8V6C579.63 3.23858 577.391 1 574.63 1L547.89 1C545.129 1 542.89 3.23858 542.89 6V47.8C542.89 50.5614 545.129 52.8 547.89 52.8H574.63C577.391 52.8 579.63 50.5614 579.63 47.8Z" fill="#E6726E"></path>
    <path d="M579.63 47.8V6C579.63 3.23858 577.391 1 574.63 1L547.89 1C545.129 1 542.89 3.23858 542.89 6V47.8C542.89 50.5614 545.129 52.8 547.89 52.8H574.63C577.391 52.8 579.63 50.5614 579.63 47.8Z" stroke="#DB3630" stroke-opacity="0.8"></path>
    <path d="M628.37 47.8V6C628.37 3.23858 626.131 1 623.37 1L596.63 1C593.869 1 591.63 3.23858 591.63 6V47.8C591.63 50.5614 593.869 52.8 596.63 52.8H623.37C626.131 52.8 628.37 50.5614 628.37 47.8Z" fill="#82CBE5"></path>
    <path d="M628.37 47.8V6C628.37 3.23858 626.131 1 623.37 1L596.63 1C593.869 1 591.63 3.23858 591.63 6V47.8C591.63 50.5614 593.869 52.8 596.63 52.8H623.37C626.131 52.8 628.37 50.5614 628.37 47.8Z" stroke="#5286C4" stroke-opacity="0.8"></path>
    <path d="M677.11 47.8V6C677.11 3.23858 674.871 1 672.11 1L645.37 1C642.609 1 640.37 3.23858 640.37 6V47.8C640.37 50.5614 642.609 52.8 645.37 52.8H672.11C674.871 52.8 677.11 50.5614 677.11 47.8Z" fill="#F5D44D"></path>
    <path d="M677.11 47.8V6C677.11 3.23858 674.871 1 672.11 1L645.37 1C642.609 1 640.37 3.23858 640.37 6V47.8C640.37 50.5614 642.609 52.8 645.37 52.8H672.11C674.871 52.8 677.11 50.5614 677.11 47.8Z" stroke="#CCAB51" stroke-opacity="0.8"></path>
    <path d="M579.63 331.6V289.8C579.63 287.039 577.391 284.8 574.63 284.8H547.89C545.129 284.8 542.89 287.039 542.89 289.8V331.6C542.89 334.361 545.129 336.6 547.89 336.6H574.63C577.391 336.6 579.63 334.361 579.63 331.6Z" fill="#E6726E"></path>
    <path d="M579.63 331.6V289.8C579.63 287.039 577.391 284.8 574.63 284.8H547.89C545.129 284.8 542.89 287.039 542.89 289.8V331.6C542.89 334.361 545.129 336.6 547.89 336.6H574.63C577.391 336.6 579.63 334.361 579.63 331.6Z" stroke="#DB3630" stroke-opacity="0.8"></path>
    <path d="M628.37 331.6V289.8C628.37 287.039 626.131 284.8 623.37 284.8H596.63C593.869 284.8 591.63 287.039 591.63 289.8V331.6C591.63 334.361 593.869 336.6 596.63 336.6H623.37C626.131 336.6 628.37 334.361 628.37 331.6Z" fill="#82CBE5"></path>
    <path d="M628.37 331.6V289.8C628.37 287.039 626.131 284.8 623.37 284.8H596.63C593.869 284.8 591.63 287.039 591.63 289.8V331.6C591.63 334.361 593.869 336.6 596.63 336.6H623.37C626.131 336.6 628.37 334.361 628.37 331.6Z" stroke="#5286C4" stroke-opacity="0.8"></path>
    <path d="M677.11 331.6V289.8C677.11 287.039 674.871 284.8 672.11 284.8H645.37C642.609 284.8 640.37 287.039 640.37 289.8V331.6C640.37 334.361 642.609 336.6 645.37 336.6H672.11C674.871 336.6 677.11 334.361 677.11 331.6Z" fill="#F5D44D"></path>
    <path d="M677.11 331.6V289.8C677.11 287.039 674.871 284.8 672.11 284.8H645.37C642.609 284.8 640.37 287.039 640.37 289.8V331.6C640.37 334.361 642.609 336.6 645.37 336.6H672.11C674.871 336.6 677.11 334.361 677.11 331.6Z" stroke="#CCAB51" stroke-opacity="0.8"></path>
    <path d="M339.5 116.8C339.5 117.076 339.724 117.3 340 117.3C340.276 117.3 340.5 117.076 340.5 116.8H339.5ZM561.614 52.4465C561.418 52.2512 561.102 52.2512 560.907 52.4465L557.725 55.6285C557.529 55.8237 557.529 56.1403 557.725 56.3356C557.92 56.5308 558.236 56.5308 558.432 56.3356L561.26 53.5072L564.089 56.3356C564.284 56.5308 564.6 56.5308 564.796 56.3356C564.991 56.1403 564.991 55.8237 564.796 55.6285L561.614 52.4465ZM340.5 116.8C340.5 113.131 343.674 110.004 349.712 107.296C355.704 104.608 364.298 102.436 374.66 100.57C395.381 96.84 423.009 94.3616 450.684 91.3722C478.337 88.3852 506.034 84.8881 526.822 79.1162C537.214 76.231 545.92 72.7665 552.039 68.4859C558.164 64.2011 561.76 59.0489 561.76 52.8H560.76C560.76 58.6012 557.442 63.4864 551.466 67.6665C545.485 71.8507 536.906 75.2785 526.554 78.1526C505.857 83.8994 478.239 87.3899 450.576 90.3779C422.936 93.3636 395.249 95.8476 374.483 99.5861C364.103 101.455 355.41 103.644 349.303 106.383C343.24 109.102 339.5 112.469 339.5 116.8H340.5Z" fill="#DD423C"></path>
    <path d="M609.5 284.8C609.5 285.076 609.724 285.3 610 285.3C610.276 285.3 610.5 285.076 610.5 284.8H609.5ZM700.354 196.446C700.158 196.251 699.842 196.251 699.647 196.446L696.465 199.628C696.269 199.824 696.269 200.14 696.465 200.336C696.66 200.531 696.976 200.531 697.172 200.336L700 197.507L702.829 200.336C703.024 200.531 703.34 200.531 703.536 200.336C703.731 200.14 703.731 199.824 703.536 199.628L700.354 196.446ZM610.5 284.8C610.5 274.008 616.004 266.278 624.365 259.945C632.747 253.596 643.936 248.703 655.207 243.58C666.447 238.472 677.762 233.14 686.261 225.922C694.783 218.685 700.5 209.53 700.5 196.8H699.5C699.5 209.17 693.967 218.065 685.614 225.16C677.238 232.273 666.053 237.553 654.793 242.67C643.565 247.773 632.253 252.716 623.761 259.148C615.246 265.597 609.5 273.592 609.5 284.8H610.5Z" fill="#5C94CB"></path>
    <path d="M699.5 116.8C699.5 117.076 699.724 117.3 700 117.3C700.276 117.3 700.5 117.076 700.5 116.8H699.5ZM610.354 52.4465C610.159 52.2512 609.842 52.2512 609.647 52.4465L606.465 55.6285C606.269 55.8237 606.269 56.1403 606.465 56.3356C606.66 56.5308 606.977 56.5308 607.172 56.3356L610 53.5072L612.829 56.3356C613.024 56.5308 613.341 56.5308 613.536 56.3356C613.731 56.1403 613.731 55.8237 613.536 55.6285L610.354 52.4465ZM700.5 116.8C700.5 108.487 694.623 103.499 686.133 99.8991C677.649 96.3013 666.333 93.9926 655.123 91.1405C643.873 88.2778 632.703 84.8637 624.348 79.0673C616.025 73.294 610.5 65.1636 610.5 52.8H609.5C609.5 65.5364 615.225 73.956 623.778 79.889C632.297 85.7989 643.628 89.2473 654.877 92.1096C666.168 94.9825 677.351 97.2614 685.742 100.82C694.128 104.376 699.5 109.113 699.5 116.8H700.5Z" fill="#5C94CB"></path>
    <path d="M699.5 116.8C699.5 117.076 699.724 117.3 700 117.3C700.276 117.3 700.5 117.076 700.5 116.8H699.5ZM659.076 52.4297C658.871 52.2442 658.555 52.2596 658.37 52.4642L655.347 55.7975C655.161 56.0021 655.177 56.3183 655.381 56.5038C655.586 56.6893 655.902 56.6739 656.087 56.4693L658.774 53.5063L661.737 56.1934C661.942 56.3789 662.258 56.3635 662.444 56.1589C662.629 55.9544 662.614 55.6382 662.409 55.4527L659.076 52.4297ZM700.5 116.8C700.5 100.534 690.373 92.3975 680.266 84.4078C670.127 76.3922 660.008 68.5214 659.239 52.7757L658.241 52.8244C659.034 69.0787 669.546 77.2079 679.646 85.1923C689.779 93.2026 699.5 101.066 699.5 116.8H700.5Z" fill="#CCAB51"></path>
    <path d="M658.24 284.8C658.24 285.076 658.464 285.3 658.74 285.3C659.016 285.3 659.24 285.076 659.24 284.8H658.24ZM700.354 196.446C700.158 196.251 699.842 196.251 699.646 196.446L696.464 199.628C696.269 199.824 696.269 200.14 696.464 200.336C696.66 200.531 696.976 200.531 697.172 200.336L700 197.507L702.828 200.336C703.024 200.531 703.34 200.531 703.536 200.336C703.731 200.14 703.731 199.824 703.536 199.628L700.354 196.446ZM659.24 284.8C659.24 265.871 669.406 255.682 679.74 244.286C690.078 232.886 700.5 220.342 700.5 196.8H699.5C699.5 219.958 689.292 232.264 679 243.614C668.704 254.968 658.24 265.43 658.24 284.8H659.24Z" fill="#CCAB51"></path>
    <path d="M560.76 284.8C560.76 285.076 560.984 285.3 561.26 285.3C561.536 285.3 561.76 285.076 561.76 284.8H560.76ZM340.354 196.446C340.158 196.251 339.842 196.251 339.646 196.446L336.464 199.628C336.269 199.824 336.269 200.14 336.464 200.336C336.66 200.531 336.976 200.531 337.172 200.336L340 197.507L342.828 200.336C343.024 200.531 343.34 200.531 343.536 200.336C343.731 200.14 343.731 199.824 343.536 199.628L340.354 196.446ZM561.76 284.8C561.76 278.351 558.164 273.291 552.028 269.244C545.904 265.206 537.194 262.133 526.805 259.637C506.026 254.646 478.324 251.919 450.691 248.516C423.027 245.109 395.426 241.024 374.746 233.327C354.046 225.622 340.5 214.39 340.5 196.8L339.5 196.8C339.5 215.06 353.611 226.528 374.397 234.264C395.204 242.008 422.918 246.103 450.569 249.509C478.251 252.918 505.864 255.635 526.571 260.61C536.926 263.097 545.501 266.137 551.477 270.079C557.441 274.012 560.76 278.799 560.76 284.8H561.76Z" fill="#DD423C"></path>
    <path d="M1350.76 284.8C1350.76 285.076 1350.98 285.3 1351.26 285.3C1351.54 285.3 1351.76 285.076 1351.76 284.8H1350.76ZM1130.35 196.446C1130.16 196.251 1129.84 196.251 1129.65 196.446L1126.46 199.628C1126.27 199.824 1126.27 200.14 1126.46 200.336C1126.66 200.531 1126.98 200.531 1127.17 200.336L1130 197.507L1132.83 200.336C1133.02 200.531 1133.34 200.531 1133.54 200.336C1133.73 200.14 1133.73 199.824 1133.54 199.628L1130.35 196.446ZM1351.76 284.8C1351.76 278.351 1348.16 273.291 1342.03 269.244C1335.9 265.206 1327.19 262.133 1316.8 259.637C1296.03 254.646 1268.32 251.919 1240.69 248.516C1213.03 245.109 1185.43 241.024 1164.75 233.327C1144.05 225.622 1130.5 214.39 1130.5 196.8L1129.5 196.8C1129.5 215.06 1143.61 226.528 1164.4 234.264C1185.2 242.008 1212.92 246.103 1240.57 249.509C1268.25 252.918 1295.86 255.635 1316.57 260.61C1326.93 263.097 1335.5 266.137 1341.48 270.079C1347.44 274.012 1350.76 278.799 1350.76 284.8H1351.76Z" fill="#DD423C"></path>
    <path d="M1199 116.8H1061C1054.92 116.8 1050 121.725 1050 127.8V185.8C1050 191.875 1054.92 196.8 1061 196.8H1199C1205.08 196.8 1210 191.875 1210 185.8V127.8C1210 121.725 1205.08 116.8 1199 116.8Z" fill="#DAE8FC"></path>
    <path d="M1112.52 162.3V152.118H1118.63V153.212H1113.76V156.652H1118.17V157.746H1113.76V162.3H1112.52ZM1120.74 162.3V152.118H1126.84V153.212H1121.97V156.652H1126.39V157.746H1121.97V162.3H1120.74ZM1137.03 152.118V162.3H1135.84L1130.29 154.306H1130.19V162.3H1128.96V152.118H1130.15L1135.72 160.132H1135.82V152.118H1137.03ZM1146.84 152.118V162.3H1145.6V153.411H1145.54L1143.06 155.061V153.809L1145.6 152.118H1146.84Z" fill="#393D6A"></path>
    <path d="M1199 117.3H1061C1055.2 117.3 1050.5 122.001 1050.5 127.8V185.8C1050.5 191.599 1055.2 196.3 1061 196.3H1199C1204.8 196.3 1209.5 191.599 1209.5 185.8V127.8C1209.5 122.001 1204.8 117.3 1199 117.3Z" stroke="#000066" stroke-opacity="0.6"></path>
    <path d="M1379 116.8H1241C1234.92 116.8 1230 121.725 1230 127.8V185.8C1230 191.875 1234.92 196.8 1241 196.8H1379C1385.08 196.8 1390 191.875 1390 185.8V127.8C1390 121.725 1385.08 116.8 1379 116.8Z" fill="#DAE8FC"></path>
    <path d="M1291.54 162.3V152.118H1297.64V153.212H1292.77V156.652H1297.19V157.746H1292.77V162.3H1291.54ZM1299.76 162.3V152.118H1305.86V153.212H1300.99V156.652H1305.4V157.746H1300.99V162.3H1299.76ZM1316.05 152.118V162.3H1314.85L1309.31 154.306H1309.21V162.3H1307.97V152.118H1309.17L1314.73 160.132H1314.83V152.118H1316.05ZM1322.27 162.3V161.405L1325.63 157.726C1326.03 157.295 1326.35 156.921 1326.61 156.603C1326.86 156.281 1327.05 155.979 1327.17 155.698C1327.3 155.413 1327.36 155.114 1327.36 154.803C1327.36 154.445 1327.28 154.135 1327.1 153.873C1326.94 153.611 1326.7 153.409 1326.41 153.267C1326.11 153.124 1325.78 153.053 1325.41 153.053C1325.02 153.053 1324.68 153.134 1324.39 153.296C1324.1 153.456 1323.88 153.679 1323.72 153.968C1323.56 154.256 1323.49 154.594 1323.49 154.982H1322.31C1322.31 154.385 1322.45 153.862 1322.72 153.411C1323 152.96 1323.37 152.609 1323.85 152.357C1324.33 152.105 1324.86 151.979 1325.45 151.979C1326.05 151.979 1326.58 152.105 1327.04 152.357C1327.5 152.609 1327.86 152.948 1328.12 153.376C1328.39 153.804 1328.52 154.279 1328.52 154.803C1328.52 155.177 1328.45 155.544 1328.31 155.902C1328.18 156.256 1327.95 156.652 1327.62 157.09C1327.29 157.524 1326.83 158.054 1326.25 158.681L1323.96 161.127V161.206H1328.7V162.3H1322.27Z" fill="#393D6A"></path>
    <path d="M1379 117.3H1241C1235.2 117.3 1230.5 122.001 1230.5 127.8V185.8C1230.5 191.599 1235.2 196.3 1241 196.3H1379C1384.8 196.3 1389.5 191.599 1389.5 185.8V127.8C1389.5 122.001 1384.8 117.3 1379 117.3Z" stroke="#000066" stroke-opacity="0.6"></path>
    <path d="M1559 116.8H1421C1414.92 116.8 1410 121.725 1410 127.8V185.8C1410 191.875 1414.92 196.8 1421 196.8H1559C1565.08 196.8 1570 191.875 1570 185.8V127.8C1570 121.725 1565.08 116.8 1559 116.8Z" fill="#DAE8FC"></path>
    <path d="M1471.32 162.3V152.118H1477.43V153.212H1472.55V156.652H1476.97V157.746H1472.55V162.3H1471.32ZM1479.54 162.3V152.118H1485.64V153.212H1480.77V156.652H1485.18V157.746H1480.77V162.3H1479.54ZM1495.83 152.118V162.3H1494.63L1489.09 154.306H1488.99V162.3H1487.75V152.118H1488.95L1494.52 160.132H1494.61V152.118H1495.83ZM1505.49 162.439C1504.84 162.439 1504.25 162.327 1503.74 162.101C1503.23 161.876 1502.82 161.563 1502.52 161.162C1502.22 160.757 1502.06 160.288 1502.03 159.755H1503.29C1503.31 160.083 1503.43 160.366 1503.62 160.605C1503.82 160.84 1504.08 161.022 1504.41 161.152C1504.73 161.281 1505.08 161.346 1505.47 161.346C1505.91 161.346 1506.3 161.269 1506.64 161.117C1506.98 160.964 1507.24 160.752 1507.43 160.48C1507.62 160.209 1507.72 159.894 1507.72 159.536C1507.72 159.161 1507.63 158.832 1507.44 158.546C1507.26 158.258 1506.99 158.033 1506.63 157.87C1506.27 157.708 1505.83 157.627 1505.31 157.627H1504.5V156.533H1505.31C1505.72 156.533 1506.07 156.46 1506.38 156.314C1506.69 156.168 1506.93 155.963 1507.1 155.698C1507.28 155.433 1507.36 155.121 1507.36 154.763C1507.36 154.418 1507.29 154.118 1507.13 153.863C1506.98 153.608 1506.77 153.409 1506.49 153.267C1506.21 153.124 1505.89 153.053 1505.51 153.053C1505.16 153.053 1504.83 153.118 1504.52 153.247C1504.21 153.373 1503.96 153.557 1503.76 153.799C1503.57 154.037 1503.46 154.326 1503.45 154.664H1502.25C1502.27 154.13 1502.43 153.663 1502.73 153.262C1503.04 152.857 1503.43 152.542 1503.92 152.317C1504.41 152.092 1504.95 151.979 1505.53 151.979C1506.16 151.979 1506.7 152.107 1507.15 152.362C1507.61 152.614 1507.95 152.947 1508.19 153.361C1508.44 153.775 1508.56 154.223 1508.56 154.703C1508.56 155.277 1508.41 155.766 1508.1 156.17C1507.81 156.574 1507.4 156.854 1506.89 157.01V157.09C1507.53 157.196 1508.03 157.469 1508.39 157.91C1508.75 158.348 1508.93 158.89 1508.93 159.536C1508.93 160.089 1508.78 160.587 1508.48 161.027C1508.18 161.465 1507.78 161.81 1507.26 162.061C1506.74 162.313 1506.15 162.439 1505.49 162.439Z" fill="#393D6A"></path>
    <path d="M1559 117.3H1421C1415.2 117.3 1410.5 122.001 1410.5 127.8V185.8C1410.5 191.599 1415.2 196.3 1421 196.3H1559C1564.8 196.3 1569.5 191.599 1569.5 185.8V127.8C1569.5 122.001 1564.8 117.3 1559 117.3Z" stroke="#000066" stroke-opacity="0.6"></path>
    <path d="M1739 116.8H1601C1594.92 116.8 1590 121.725 1590 127.8V185.8C1590 191.875 1594.92 196.8 1601 196.8H1739C1745.08 196.8 1750 191.875 1750 185.8V127.8C1750 121.725 1745.08 116.8 1739 116.8Z" fill="#DAE8FC"></path>
    <path d="M1651.29 162.3V152.118H1657.39V153.212H1652.52V156.652H1656.93V157.746H1652.52V162.3H1651.29ZM1659.5 162.3V152.118H1665.61V153.212H1660.74V156.652H1665.15V157.746H1660.74V162.3H1659.5ZM1675.79 152.118V162.3H1674.6L1669.05 154.306H1668.95V162.3H1667.72V152.118H1668.91L1674.48 160.132H1674.58V152.118H1675.79ZM1681.78 160.212V159.198L1686.26 152.118H1686.99V153.689H1686.49L1683.11 159.039V159.118H1689.14V160.212H1681.78ZM1686.57 162.3V159.904V159.431V152.118H1687.75V162.3H1686.57Z" fill="#393D6A"></path>
    <path d="M1739 117.3H1601C1595.2 117.3 1590.5 122.001 1590.5 127.8V185.8C1590.5 191.599 1595.2 196.3 1601 196.3H1739C1744.8 196.3 1749.5 191.599 1749.5 185.8V127.8C1749.5 122.001 1744.8 117.3 1739 117.3Z" stroke="#000066" stroke-opacity="0.6"></path>
    <path d="M1369.63 47.8V6C1369.63 3.23858 1367.39 1 1364.63 1L1337.89 1C1335.13 1 1332.89 3.23858 1332.89 6V47.8C1332.89 50.5614 1335.13 52.8 1337.89 52.8H1364.63C1367.39 52.8 1369.63 50.5614 1369.63 47.8Z" fill="#E6726E"></path>
    <path d="M1369.63 47.8V6C1369.63 3.23858 1367.39 1 1364.63 1L1337.89 1C1335.13 1 1332.89 3.23858 1332.89 6V47.8C1332.89 50.5614 1335.13 52.8 1337.89 52.8H1364.63C1367.39 52.8 1369.63 50.5614 1369.63 47.8Z" stroke="#DB3630" stroke-opacity="0.8"></path>
    <path d="M1418.37 47.8V6C1418.37 3.23858 1416.13 1 1413.37 1L1386.63 1C1383.87 1 1381.63 3.23858 1381.63 6V47.8C1381.63 50.5614 1383.87 52.8 1386.63 52.8H1413.37C1416.13 52.8 1418.37 50.5614 1418.37 47.8Z" fill="#82CBE5"></path>
    <path d="M1418.37 47.8V6C1418.37 3.23858 1416.13 1 1413.37 1L1386.63 1C1383.87 1 1381.63 3.23858 1381.63 6V47.8C1381.63 50.5614 1383.87 52.8 1386.63 52.8H1413.37C1416.13 52.8 1418.37 50.5614 1418.37 47.8Z" stroke="#5286C4" stroke-opacity="0.8"></path>
    <path d="M1467.11 47.8V6C1467.11 3.23858 1464.87 1 1462.11 1L1435.37 1C1432.61 1 1430.37 3.23858 1430.37 6V47.8C1430.37 50.5614 1432.61 52.8 1435.37 52.8H1462.11C1464.87 52.8 1467.11 50.5614 1467.11 47.8Z" stroke="#CCAB51" stroke-opacity="0.8"></path>
    <path d="M1369.63 331.6V289.8C1369.63 287.039 1367.39 284.8 1364.63 284.8H1337.89C1335.13 284.8 1332.89 287.039 1332.89 289.8V331.6C1332.89 334.361 1335.13 336.6 1337.89 336.6H1364.63C1367.39 336.6 1369.63 334.361 1369.63 331.6Z" fill="#E6726E"></path>
    <path d="M1369.63 331.6V289.8C1369.63 287.039 1367.39 284.8 1364.63 284.8H1337.89C1335.13 284.8 1332.89 287.039 1332.89 289.8V331.6C1332.89 334.361 1335.13 336.6 1337.89 336.6H1364.63C1367.39 336.6 1369.63 334.361 1369.63 331.6Z" stroke="#DB3630" stroke-opacity="0.8"></path>
    <path d="M1418.37 331.6V289.8C1418.37 287.039 1416.13 284.8 1413.37 284.8H1386.63C1383.87 284.8 1381.63 287.039 1381.63 289.8V331.6C1381.63 334.361 1383.87 336.6 1386.63 336.6H1413.37C1416.13 336.6 1418.37 334.361 1418.37 331.6Z" fill="#82CBE5"></path>
    <path d="M1418.37 331.6V289.8C1418.37 287.039 1416.13 284.8 1413.37 284.8H1386.63C1383.87 284.8 1381.63 287.039 1381.63 289.8V331.6C1381.63 334.361 1383.87 336.6 1386.63 336.6H1413.37C1416.13 336.6 1418.37 334.361 1418.37 331.6Z" stroke="#5286C4" stroke-opacity="0.8"></path>
    <path d="M1467.11 331.6V289.8C1467.11 287.039 1464.87 284.8 1462.11 284.8H1435.37C1432.61 284.8 1430.37 287.039 1430.37 289.8V331.6C1430.37 334.361 1432.61 336.6 1435.37 336.6H1462.11C1464.87 336.6 1467.11 334.361 1467.11 331.6Z" fill="#F5D44D"></path>
    <path d="M1467.11 331.6V289.8C1467.11 287.039 1464.87 284.8 1462.11 284.8H1435.37C1432.61 284.8 1430.37 287.039 1430.37 289.8V331.6C1430.37 334.361 1432.61 336.6 1435.37 336.6H1462.11C1464.87 336.6 1467.11 334.361 1467.11 331.6Z" stroke="#CCAB51" stroke-opacity="0.8"></path>
    <path d="M1669.5 116.8C1669.5 117.076 1669.72 117.3 1670 117.3C1670.28 117.3 1670.5 117.076 1670.5 116.8H1669.5ZM1351.61 52.4465C1351.42 52.2512 1351.1 52.2512 1350.91 52.4465L1347.72 55.6285C1347.53 55.8237 1347.53 56.1403 1347.72 56.3356C1347.92 56.5308 1348.24 56.5308 1348.43 56.3356L1351.26 53.5072L1354.09 56.3356C1354.28 56.5308 1354.6 56.5308 1354.8 56.3356C1354.99 56.1403 1354.99 55.8237 1354.8 55.6285L1351.61 52.4465ZM1670.5 116.8C1670.5 114.571 1669.11 112.567 1666.72 110.763C1664.33 108.954 1660.85 107.279 1656.47 105.713C1647.71 102.577 1635.23 99.8282 1620.28 97.335C1590.38 92.3473 1550.52 88.3644 1510.68 84.3775C1470.83 80.3894 1431.01 76.3973 1401.15 71.3913C1386.21 68.8877 1373.8 66.1349 1365.13 63.012C1360.79 61.4496 1357.42 59.8058 1355.14 58.0756C1352.86 56.3413 1351.76 54.585 1351.76 52.8H1350.76C1350.76 55.0401 1352.15 57.0556 1354.54 58.8716C1356.93 60.6918 1360.41 62.3767 1364.79 63.9529C1373.55 67.1074 1386.03 69.8718 1400.98 72.3775C1430.88 77.3903 1470.74 81.3857 1510.58 85.3726C1550.43 89.3607 1590.25 93.3403 1620.11 98.3214C1635.05 100.812 1647.46 103.55 1656.14 106.654C1660.47 108.207 1663.84 109.841 1666.12 111.561C1668.4 113.284 1669.5 115.029 1669.5 116.8H1670.5Z" fill="#DD423C"></path>
    <path d="M1350.76 284.8C1350.76 285.076 1350.98 285.3 1351.26 285.3C1351.54 285.3 1351.76 285.076 1351.76 284.8H1350.76ZM1670.5 196.806C1670.5 196.53 1670.28 196.303 1670.01 196.3L1665.51 196.25C1665.23 196.246 1665 196.468 1665 196.744C1665 197.02 1665.22 197.246 1665.49 197.249L1669.49 197.294L1669.45 201.294C1669.45 201.57 1669.67 201.797 1669.94 201.8C1670.22 201.803 1670.45 201.582 1670.45 201.305L1670.5 196.806ZM1351.76 284.8C1351.76 279.589 1355.81 274.905 1363.36 270.626C1370.87 266.361 1381.69 262.593 1394.86 259.159C1421.2 252.292 1456.79 246.796 1493.83 241.295C1530.85 235.796 1569.31 230.293 1601.32 223.414C1617.32 219.974 1631.73 216.187 1643.56 211.879C1655.37 207.575 1664.65 202.733 1670.35 197.158L1669.65 196.443C1664.1 201.867 1654.99 206.65 1643.21 210.94C1631.45 215.225 1617.09 219.001 1601.11 222.436C1569.14 229.307 1530.72 234.804 1493.68 240.305C1456.66 245.804 1421.01 251.308 1394.61 258.191C1381.41 261.632 1370.49 265.426 1362.86 269.756C1355.26 274.07 1350.76 279.011 1350.76 284.8H1351.76Z" fill="#DD423C"></path>
    <path d="M1399.5 284.8C1399.5 285.076 1399.72 285.3 1400 285.3C1400.28 285.3 1400.5 285.076 1400.5 284.8H1399.5ZM1490.35 196.446C1490.16 196.251 1489.84 196.251 1489.65 196.446L1486.46 199.628C1486.27 199.824 1486.27 200.14 1486.46 200.336C1486.66 200.531 1486.98 200.531 1487.17 200.336L1490 197.507L1492.83 200.336C1493.02 200.531 1493.34 200.531 1493.54 200.336C1493.73 200.14 1493.73 199.824 1493.54 199.628L1490.35 196.446ZM1400.5 284.8C1400.5 274.006 1406.01 266.15 1414.37 259.661C1422.75 253.156 1433.94 248.075 1445.21 242.828C1456.45 237.596 1467.76 232.202 1476.26 225.08C1484.78 217.941 1490.5 209.037 1490.5 196.8H1489.5C1489.5 208.663 1483.97 217.309 1475.62 224.314C1467.24 231.336 1456.05 236.679 1444.79 241.922C1433.56 247.15 1422.25 252.281 1413.76 258.871C1405.24 265.475 1399.5 273.594 1399.5 284.8H1400.5Z" fill="#5C94CB"></path>
    <path d="M1399.5 284.8C1399.5 285.076 1399.72 285.3 1400 285.3C1400.28 285.3 1400.5 285.076 1400.5 284.8H1399.5ZM1310.35 196.446C1310.16 196.251 1309.84 196.251 1309.65 196.446L1306.46 199.628C1306.27 199.824 1306.27 200.14 1306.46 200.336C1306.66 200.531 1306.98 200.531 1307.17 200.336L1310 197.507L1312.83 200.336C1313.02 200.531 1313.34 200.531 1313.54 200.336C1313.73 200.14 1313.73 199.824 1313.54 199.628L1310.35 196.446ZM1400.5 284.8C1400.5 273.601 1394.76 265.017 1386.26 257.829C1377.77 250.652 1366.47 244.817 1355.23 239.117C1343.96 233.402 1332.76 227.823 1324.37 221.142C1316 214.468 1310.5 206.76 1310.5 196.8L1309.5 196.8C1309.5 207.19 1315.25 215.157 1323.75 221.924C1332.24 228.683 1343.54 234.311 1354.77 240.008C1366.03 245.72 1377.23 251.504 1385.61 258.593C1393.99 265.67 1399.5 273.999 1399.5 284.8H1400.5Z" fill="#5C94CB"></path>
    <path d="M1489.5 116.8C1489.5 117.076 1489.72 117.3 1490 117.3C1490.28 117.3 1490.5 117.076 1490.5 116.8H1489.5ZM1400.35 52.4465C1400.16 52.2512 1399.84 52.2512 1399.65 52.4465L1396.46 55.6285C1396.27 55.8237 1396.27 56.1403 1396.46 56.3356C1396.66 56.5308 1396.98 56.5308 1397.17 56.3356L1400 53.5072L1402.83 56.3356C1403.02 56.5308 1403.34 56.5308 1403.54 56.3356C1403.73 56.1403 1403.73 55.8237 1403.54 55.6285L1400.35 52.4465ZM1490.5 116.8C1490.5 108.526 1484.67 102.346 1476.19 97.2588C1467.71 92.166 1456.41 88.0748 1445.17 84.0296C1433.9 79.9742 1422.7 75.9653 1414.32 71.0316C1405.91 66.0901 1400.5 60.3198 1400.5 52.8H1399.5C1399.5 60.8803 1405.34 66.91 1413.81 71.8935C1422.3 76.8848 1433.6 80.9259 1444.83 84.9705C1456.09 89.0253 1467.29 93.0841 1475.68 98.1163C1484.08 103.155 1489.5 109.074 1489.5 116.8H1490.5Z" fill="#5C94CB"></path>
    <path d="M1309.5 116.8C1309.5 117.076 1309.72 117.3 1310 117.3C1310.28 117.3 1310.5 117.076 1310.5 116.8H1309.5ZM1400.35 52.4465C1400.16 52.2512 1399.84 52.2512 1399.65 52.4465L1396.46 55.6285C1396.27 55.8237 1396.27 56.1403 1396.46 56.3356C1396.66 56.5308 1396.98 56.5308 1397.17 56.3356L1400 53.5072L1402.83 56.3356C1403.02 56.5308 1403.34 56.5308 1403.54 56.3356C1403.73 56.1403 1403.73 55.8237 1403.54 55.6285L1400.35 52.4465ZM1310.5 116.8C1310.5 109.087 1315.91 103.572 1324.3 99.0416C1332.69 94.5141 1343.88 91.064 1355.15 87.4132C1366.39 83.7728 1377.7 79.9341 1386.2 74.6289C1394.71 69.3164 1400.5 62.4695 1400.5 52.8H1399.5C1399.5 61.9805 1394.04 68.5587 1385.67 73.7806C1377.3 79.0097 1366.11 82.8147 1354.85 86.4619C1343.62 90.0986 1332.31 93.5798 1323.82 98.1616C1315.34 102.74 1309.5 108.514 1309.5 116.8H1310.5Z" fill="#5C94CB"></path>
    <path d="M1129.5 116.8C1129.5 117.076 1129.72 117.3 1130 117.3C1130.28 117.3 1130.5 117.076 1130.5 116.8H1129.5ZM1351.61 52.4465C1351.42 52.2512 1351.1 52.2512 1350.91 52.4465L1347.72 55.6285C1347.53 55.8237 1347.53 56.1403 1347.72 56.3356C1347.92 56.5308 1348.24 56.5308 1348.43 56.3356L1351.26 53.5072L1354.09 56.3356C1354.28 56.5308 1354.6 56.5308 1354.8 56.3356C1354.99 56.1403 1354.99 55.8237 1354.8 55.6285L1351.61 52.4465ZM1130.5 116.8C1130.5 113.122 1133.69 109.865 1139.73 106.941C1145.72 104.039 1154.31 101.569 1164.68 99.372C1185.39 94.979 1213.02 91.7039 1240.69 88.1836C1268.34 84.6656 1296.03 80.9029 1316.81 75.5326C1327.2 72.8483 1335.9 69.753 1342.01 66.0639C1348.11 62.3821 1351.76 58.029 1351.76 52.8H1350.76C1350.76 57.4961 1347.49 61.5868 1341.49 65.2077C1335.51 68.8213 1326.92 71.8877 1316.56 74.5644C1295.86 79.916 1268.23 83.672 1240.57 87.1916C1212.92 90.7087 1185.24 93.9898 1164.47 98.3937C1154.09 100.595 1145.4 103.084 1139.29 106.041C1133.23 108.976 1129.5 112.478 1129.5 116.8H1130.5Z" fill="#DD423C"></path>
    <path d="M49.6299 331.6V289.8C49.6299 287.039 47.3913 284.8 44.6299 284.8H17.8899C15.1284 284.8 12.8899 287.039 12.8899 289.8V331.6C12.8899 334.361 15.1284 336.6 17.8899 336.6H44.6299C47.3913 336.6 49.6299 334.361 49.6299 331.6Z" fill="#E6726E"></path>
    <path d="M49.6299 331.6V289.8C49.6299 287.039 47.3913 284.8 44.6299 284.8H17.8899C15.1284 284.8 12.8899 287.039 12.8899 289.8V331.6C12.8899 334.361 15.1284 336.6 17.8899 336.6H44.6299C47.3913 336.6 49.6299 334.361 49.6299 331.6Z" stroke="#DB3630" stroke-opacity="0.8"></path>
    <path d="M98.3701 331.6V289.8C98.3701 287.039 96.1315 284.8 93.3701 284.8H66.6301C63.8687 284.8 61.6301 287.039 61.6301 289.8V331.6C61.6301 334.361 63.8687 336.6 66.6301 336.6H93.3701C96.1315 336.6 98.3701 334.361 98.3701 331.6Z" fill="#82CBE5"></path>
    <path d="M98.3701 331.6V289.8C98.3701 287.039 96.1315 284.8 93.3701 284.8H66.6301C63.8687 284.8 61.6301 287.039 61.6301 289.8V331.6C61.6301 334.361 63.8687 336.6 66.6301 336.6H93.3701C96.1315 336.6 98.3701 334.361 98.3701 331.6Z" stroke="#5286C4" stroke-opacity="0.8"></path>
    <path d="M147.11 331.6V289.8C147.11 287.039 144.871 284.8 142.11 284.8H115.37C112.608 284.8 110.37 287.039 110.37 289.8V331.6C110.37 334.361 112.608 336.6 115.37 336.6H142.11C144.871 336.6 147.11 334.361 147.11 331.6Z" fill="#F5D44D"></path>
    <path d="M147.11 331.6V289.8C147.11 287.039 144.871 284.8 142.11 284.8H115.37C112.608 284.8 110.37 287.039 110.37 289.8V331.6C110.37 334.361 112.608 336.6 115.37 336.6H142.11C144.871 336.6 147.11 334.361 147.11 331.6Z" stroke="#CCAB51" stroke-opacity="0.8"></path>
    <path d="M149 117H11C4.92487 117 0 121.925 0 128V186C0 192.075 4.92487 197 11 197H149C155.075 197 160 192.075 160 186V128C160 121.925 155.075 117 149 117Z" fill="#DAE8FC"></path>
    <path d="M67.7456 162.5V152.318H73.8508V153.412H68.9786V156.852H73.3934V157.946H68.9786V162.5H67.7456ZM75.9624 162.5V152.318H82.0676V153.412H77.1954V156.852H81.6102V157.946H77.1954V162.5H75.9624ZM92.2531 152.318V162.5H91.0599L85.5116 154.506H85.4122V162.5H84.1792V152.318H85.3724L90.9406 160.332H91.04V152.318H92.2531Z" fill="#393D6A"></path>
    <path d="M149 117.5H11C5.20101 117.5 0.5 122.201 0.5 128V186C0.5 191.799 5.20101 196.5 11 196.5H149C154.799 196.5 159.5 191.799 159.5 186V128C159.5 122.201 154.799 117.5 149 117.5Z" stroke="#000066" stroke-opacity="0.6"></path>
    <path d="M49.6299 47.6V5.80005C49.6299 3.03863 47.3913 0.800049 44.6299 0.800049L17.8899 0.800049C15.1284 0.800049 12.8899 3.03863 12.8899 5.80005V47.6C12.8899 50.3615 15.1284 52.6 17.8899 52.6H44.6299C47.3913 52.6 49.6299 50.3615 49.6299 47.6Z" fill="#E6726E"></path>
    <path d="M49.6299 47.6V5.80005C49.6299 3.03863 47.3913 0.800049 44.6299 0.800049L17.8899 0.800049C15.1284 0.800049 12.8899 3.03863 12.8899 5.80005V47.6C12.8899 50.3615 15.1284 52.6 17.8899 52.6H44.6299C47.3913 52.6 49.6299 50.3615 49.6299 47.6Z" stroke="#DB3630" stroke-opacity="0.8"></path>
    <path d="M98.3701 47.6001V5.80005C98.3701 3.03863 96.1315 0.800049 93.3701 0.800049L66.6301 0.800049C63.8687 0.800049 61.6301 3.03863 61.6301 5.80005V47.6001C61.6301 50.3615 63.8687 52.6001 66.6301 52.6001H93.3701C96.1315 52.6001 98.3701 50.3615 98.3701 47.6001Z" fill="#82CBE5"></path>
    <path d="M98.3701 47.6001V5.80005C98.3701 3.03863 96.1315 0.800049 93.3701 0.800049L66.6301 0.800049C63.8687 0.800049 61.6301 3.03863 61.6301 5.80005V47.6001C61.6301 50.3615 63.8687 52.6001 66.6301 52.6001H93.3701C96.1315 52.6001 98.3701 50.3615 98.3701 47.6001Z" stroke="#5286C4" stroke-opacity="0.8"></path>
    <path d="M147.11 47.6001V5.80005C147.11 3.03863 144.871 0.800049 142.11 0.800049L115.37 0.800049C112.608 0.800049 110.37 3.03863 110.37 5.80005V47.6001C110.37 50.3615 112.608 52.6001 115.37 52.6001H142.11C144.871 52.6001 147.11 50.3615 147.11 47.6001Z" fill="#F5D44D"></path>
    <path d="M147.11 47.6001V5.80005C147.11 3.03863 144.871 0.800049 142.11 0.800049L115.37 0.800049C112.608 0.800049 110.37 3.03863 110.37 5.80005V47.6001C110.37 50.3615 112.608 52.6001 115.37 52.6001H142.11C144.871 52.6001 147.11 50.3615 147.11 47.6001Z" stroke="#CCAB51" stroke-opacity="0.8"></path>
    <path d="M128.24 284.8C128.24 285.076 128.464 285.3 128.74 285.3C129.016 285.3 129.24 285.076 129.24 284.8H128.24ZM80.3443 196.637C80.144 196.447 79.8275 196.455 79.6374 196.656L76.539 199.919C76.3489 200.119 76.3571 200.436 76.5574 200.626C76.7576 200.816 77.0741 200.808 77.2642 200.608L80.0183 197.707L82.9192 200.461C83.1194 200.651 83.4359 200.643 83.626 200.443C83.8162 200.242 83.808 199.926 83.6077 199.736L80.3443 196.637ZM129.24 284.8C129.24 262.613 117.177 251.506 105.134 240.53C93.0874 229.552 81.0633 218.705 80.4998 196.987L79.5002 197.013C80.0757 219.195 92.4215 230.298 104.46 241.27C116.502 252.244 128.24 263.087 128.24 284.8H129.24Z" fill="#CCAB51"></path>
    <path d="M30.7598 284.8C30.7598 285.076 30.9836 285.3 31.2598 285.3C31.5359 285.3 31.7598 285.076 31.7598 284.8H30.7598ZM80.3331 196.627C80.1272 196.443 79.8111 196.461 79.6271 196.667L76.6286 200.022C76.4446 200.228 76.4623 200.544 76.6682 200.728C76.8742 200.912 77.1902 200.895 77.3742 200.689L80.0396 197.706L83.0222 200.371C83.2281 200.555 83.5442 200.538 83.7282 200.332C83.9122 200.126 83.8944 199.81 83.6885 199.626L80.3331 196.627ZM31.7598 284.8C31.7598 263.101 44.3862 252.413 56.896 241.502C63.1382 236.058 69.3628 230.546 73.8589 223.59C78.3673 216.616 81.1302 208.205 80.4991 196.972L79.5007 197.028C80.1196 208.045 77.4151 216.247 73.0191 223.047C68.6108 229.867 62.4941 235.292 56.2387 240.748C43.7534 251.638 30.7598 262.599 30.7598 284.8H31.7598Z" fill="#DD423C"></path>
    <path d="M79.5 117C79.5 117.276 79.7239 117.5 80 117.5C80.2761 117.5 80.5 117.276 80.5 117H79.5ZM129.093 52.2465C128.898 52.0513 128.582 52.0513 128.386 52.2465L125.204 55.4285C125.009 55.6238 125.009 55.9404 125.204 56.1356C125.4 56.3309 125.716 56.3309 125.911 56.1356L128.74 53.3072L131.568 56.1356C131.764 56.3309 132.08 56.3309 132.275 56.1356C132.471 55.9404 132.471 55.6238 132.275 55.4285L129.093 52.2465ZM80.5 117C80.5 101.223 92.3903 94.2362 104.634 86.612C116.802 79.0351 129.24 70.8532 129.24 52.6001H128.24C128.24 70.2469 116.308 78.165 104.106 85.7631C91.9796 93.3139 79.5 100.578 79.5 117H80.5Z" fill="#CCAB51"></path>
    <path d="M79.4999 117C79.4999 117.276 79.7238 117.5 79.9999 117.5C80.276 117.5 80.4999 117.276 80.4999 117H79.4999ZM31.5959 52.2299C31.3914 52.0443 31.0752 52.0595 30.8896 52.264L27.8646 55.5955C27.6789 55.8 27.6942 56.1162 27.8986 56.3018C28.1031 56.4875 28.4193 56.4722 28.6049 56.2678L31.2938 53.3064L34.2552 55.9953C34.4596 56.1809 34.7759 56.1657 34.9615 55.9612C35.1471 55.7568 35.1319 55.4406 34.9274 55.2549L31.5959 52.2299ZM80.4999 117C80.4999 100.597 68.4424 92.4085 56.4908 84.385C44.4563 76.3057 32.5216 68.3867 31.7592 52.576L30.7603 52.6242C31.5507 69.0134 43.9861 77.1945 55.9334 85.2152C67.9637 93.2916 79.4999 101.203 79.4999 117H80.4999Z" fill="#DD423C"></path>
    <path d="M80.3536 196.646C80.1583 196.451 79.8417 196.451 79.6464 196.646L76.4645 199.828C76.2692 200.024 76.2692 200.34 76.4645 200.536C76.6597 200.731 76.9763 200.731 77.1716 200.536L80 197.707L82.8284 200.536C83.0237 200.731 83.3403 200.731 83.5355 200.536C83.7308 200.34 83.7308 200.024 83.5355 199.828L80.3536 196.646ZM80.5 285L80.5 197L79.5 197L79.5 285L80.5 285Z" fill="#5C94CB"></path>
    <path d="M80.3535 52.6464C80.1583 52.4512 79.8417 52.4512 79.6464 52.6464L76.4645 55.8284C76.2692 56.0237 76.2692 56.3403 76.4645 56.5355C76.6597 56.7308 76.9763 56.7308 77.1716 56.5355L80 53.7071L82.8284 56.5355C83.0237 56.7308 83.3403 56.7308 83.5355 56.5355C83.7308 56.3403 83.7308 56.0237 83.5355 55.8284L80.3535 52.6464ZM80.5 117L80.5 53L79.5 53L79.5 117L80.5 117Z" fill="#5C94CB"></path>
    </svg>
    <figcaption> The standard feed-forward (left) processes each token independently. In Switch (center), many tokens can choose the same expert, increasing the processing time for that expert. In Expert Choice (right) all experts process the same number of tokens, but some tokens might not be picked by any expert, resulting in no update for that input token.</figcaption>
  </div>
</div>
<p>There is a number of works that try to improve stability and quality of the controller: including methods based on reinforcement learning <span class="citation" data-cites="BengioBPP15">(<a href="#ref-BengioBPP15" role="doc-biblioref">Bengio et al. 2015</a>)</span>, routing by hashing <span class="citation" data-cites="04426">(<a href="#ref-04426" role="doc-biblioref">Roller et al. 2021</a>)</span>, optimal transport <span class="citation" data-cites="clark2022unified">(<a href="#ref-clark2022unified" role="doc-biblioref">Clark et al. 2022</a>)</span> and more <span class="citation" data-cites="dai2022stablemoe chi2022representation">(<a href="#ref-dai2022stablemoe" role="doc-biblioref">Dai et al. 2022</a>; <a href="#ref-chi2022representation" role="doc-biblioref">Chi et al. 2022</a>)</span>. <span class="citation" data-cites="base">(<a href="#ref-base" role="doc-biblioref">Lewis et al. 2021</a>)</span> adress the load balancing problem by linear programming while <span class="citation" data-cites="bpr">(<a href="#ref-bpr" role="doc-biblioref">Riquelme et al. 2021</a>)</span> tries to achieve this by learning to drop unimportant tokens.</p>
<p>Concurrently to our work, <span class="citation" data-cites="puigcerver2023sparse">(<a href="#ref-puigcerver2023sparse" role="doc-biblioref">Puigcerver et al. 2023</a>)</span> proposed a continuous variant of Mixture of Experts for the Vision Transformer, limited to encoder-only models. Another approach allowing to avoid discrete operations in MoE by merging experts was presented in <span class="citation" data-cites="muqeeth2023soft">(<a href="#ref-muqeeth2023soft" role="doc-biblioref">Muqeeth, Liu, and Raffel 2023</a>)</span>.</p>
</section>
<section id="method-mp-1.-zrobić-korektę-2.-podzielić-na-sekcje" class="level1">
<h1>Method <span class="MP">MP: 1. zrobić korektę 2. podzielić na sekcje</span></h1>
<p><span class="SJ">Link to diagrams: https://drive.google.com/file/d/1jvew0ft43zpaG-iCk7Ob2ilJw7VjsyeZ/view?usp=sharing</span> <!-- 
[Move this paragraph to background]{.SJ}
The general idea of Mixture of Tokens is to run multiple experts which independently aggregate and process tokens. The most common (and original) form of MoE, token-choice, operates from the perspective of a single token. [This paragraph will be more detailed in background section.]{.SJ} However, Mixture of Tokens is more similar to expert-choice, where it is an expert who decides which tokens to process. [Korekta]{.MP}

[comparison of both token-choice and expert-choice]{.SJ}

{{< include diagrams/_vanillamoes.qmd >}}  --></p>
<p>Let’s say we have a model and we would like to increase its parameter count without increasing its runtime. One of the ways to achieve this is utilized by Mixture of Experts architectures - only a subset of parameters is used for a given input. The other strategy would be to somehow merge the examples and process them together. The latter design lies at the heart of Mixture of Tokens, allowing it to overcome problems present in MoE.</p>
<div class="simontwice_style_small" id="diag-intuition">
  <div>
  <svg width="747" height="476" viewbox="0 0 747 476" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M590.26 47.7609V5.96094C590.26 3.19951 588.021 0.960938 585.26 0.960938L558.52 0.960938C555.759 0.960938 553.52 3.19951 553.52 5.96094V47.7609C553.52 50.5224 555.759 52.7609 558.52 52.7609H585.26C588.021 52.7609 590.26 50.5224 590.26 47.7609Z" fill="#E6726E"></path>
  <path d="M590.26 47.7609V5.96094C590.26 3.19951 588.021 0.960938 585.26 0.960938L558.52 0.960938C555.759 0.960938 553.52 3.19951 553.52 5.96094V47.7609C553.52 50.5224 555.759 52.7609 558.52 52.7609H585.26C588.021 52.7609 590.26 50.5224 590.26 47.7609Z" stroke="#DB3630" stroke-opacity="0.8"></path>
  <path d="M639 47.7609V5.96094C639 3.19951 636.761 0.960938 634 0.960938L607.26 0.960938C604.499 0.960938 602.26 3.19951 602.26 5.96094V47.7609C602.26 50.5224 604.499 52.7609 607.26 52.7609H634C636.761 52.7609 639 50.5224 639 47.7609Z" fill="#82CBE5"></path>
  <path d="M639 47.7609V5.96094C639 3.19951 636.761 0.960938 634 0.960938L607.26 0.960938C604.499 0.960938 602.26 3.19951 602.26 5.96094V47.7609C602.26 50.5224 604.499 52.7609 607.26 52.7609H634C636.761 52.7609 639 50.5224 639 47.7609Z" stroke="#5286C4" stroke-opacity="0.8"></path>
  <mask id="mask0_632_73" style="mask-type:luminance" maskunits="userSpaceOnUse" x="577" y="95" width="38" height="53">
  <path d="M577.89 100.761V142.561C577.89 145.322 580.129 147.561 582.89 147.561H609.63C612.392 147.561 614.63 145.322 614.63 142.561V100.761C614.63 97.9995 612.392 95.761 609.63 95.761H582.89C580.129 95.761 577.89 97.9995 577.89 100.761Z" fill="white"></path>
  </mask>
  <g mask="url(#mask0_632_73)">
  <path d="M586.553 108.32L596.293 122.052L606.033 108.32H586.553Z" fill="#C3DDE3"></path>
  <path d="M577.89 95.761L596.26 121.661L577.89 147.561V95.761Z" fill="#82CBE5"></path>
  <path d="M577.89 147.516L596.26 121.661L614.63 147.516H577.89Z" fill="#E6726E"></path>
  <path d="M577.89 95.761L587.075 108.711H605.445L596.26 95.761H577.89Z" fill="#A2D4E0"></path>
  <path d="M614.63 95.761H596.26L614.63 121.661V95.761Z" fill="#E05C57"></path>
  <path d="M614.63 121.661L605.445 134.611L614.63 147.561V121.661Z" fill="#F5CAB5"></path>
  <path d="M596.26 121.661L605.445 108.711L614.63 121.661L605.445 134.611L596.26 121.661Z" fill="#ED926F"></path>
  </g>
  <path d="M577.89 100.761V142.561C577.89 145.322 580.129 147.561 582.89 147.561H609.63C612.392 147.561 614.63 145.322 614.63 142.561V100.761C614.63 97.9996 612.392 95.761 609.63 95.761H582.89C580.129 95.761 577.89 97.9996 577.89 100.761Z" stroke="#77767B" stroke-opacity="0.8"></path>
  <path d="M735.948 188.561H456.573C450.877 188.561 446.26 193.486 446.26 199.561V257.561C446.26 263.636 450.877 268.561 456.573 268.561H735.948C741.643 268.561 746.26 263.636 746.26 257.561V199.561C746.26 193.486 741.643 188.561 735.948 188.561Z" fill="#DAE8FC"></path>
  <path d="M578.783 234.061V223.879H584.888V224.973H580.016V228.413H584.431V229.507H580.016V234.061H578.783ZM587 234.061V223.879H593.105V224.973H588.233V228.413H592.648V229.507H588.233V234.061H587ZM603.29 223.879V234.061H602.097L596.549 226.067H596.45V234.061H595.217V223.879H596.41L601.978 231.893H602.077V223.879H603.29ZM613.096 223.879V234.061H611.863V225.172H611.803L609.317 226.822V225.57L611.863 223.879H613.096Z" fill="#393D6A"></path>
  <path d="M735.918 189.061H456.602C451.166 189.061 446.76 193.762 446.76 199.561V257.561C446.76 263.36 451.166 268.061 456.602 268.061H735.918C741.354 268.061 745.76 263.36 745.76 257.561V199.561C745.76 193.762 741.354 189.061 735.918 189.061Z" stroke="#000066" stroke-opacity="0.6"></path>
  <mask id="mask1_632_73" style="mask-type:luminance" maskunits="userSpaceOnUse" x="577" y="308" width="38" height="53">
  <path d="M577.89 313.561V355.361C577.89 358.123 580.129 360.361 582.89 360.361H609.63C612.392 360.361 614.63 358.123 614.63 355.361V313.561C614.63 310.8 612.392 308.561 609.63 308.561H582.89C580.129 308.561 577.89 310.8 577.89 313.561Z" fill="white"></path>
  </mask>
  <g mask="url(#mask1_632_73)">
  <path d="M586.553 321.12L596.293 334.852L606.033 321.12H586.553Z" fill="#C3DDE3"></path>
  <path d="M577.89 308.561L596.26 334.461L577.89 360.361V308.561Z" fill="#82CBE5"></path>
  <path d="M577.89 360.316L596.26 334.461L614.63 360.316H577.89Z" fill="#E6726E"></path>
  <path d="M577.89 308.561L587.075 321.511H605.445L596.26 308.561H577.89Z" fill="#A2D4E0"></path>
  <path d="M614.63 308.561H596.26L614.63 334.461V308.561Z" fill="#E05C57"></path>
  <path d="M614.63 334.461L605.445 347.411L614.63 360.361V334.461Z" fill="#F5CAB5"></path>
  <path d="M596.26 334.461L605.445 321.511L614.63 334.461L605.445 347.411L596.26 334.461Z" fill="#ED926F"></path>
  </g>
  <path d="M577.89 313.561V355.361C577.89 358.123 580.129 360.361 582.89 360.361H609.63C612.392 360.361 614.63 358.123 614.63 355.361V313.561C614.63 310.8 612.392 308.561 609.63 308.561H582.89C580.129 308.561 577.89 310.8 577.89 313.561Z" stroke="#77767B" stroke-opacity="0.8"></path>
  <path d="M590.26 458.661V416.861C590.26 414.1 588.021 411.861 585.26 411.861H558.52C555.759 411.861 553.52 414.1 553.52 416.861V458.661C553.52 461.423 555.759 463.661 558.52 463.661H585.26C588.021 463.661 590.26 461.423 590.26 458.661Z" fill="#E6726E"></path>
  <path d="M590.26 458.661V416.861C590.26 414.1 588.021 411.861 585.26 411.861H558.52C555.759 411.861 553.52 414.1 553.52 416.861V458.661C553.52 461.423 555.759 463.661 558.52 463.661H585.26C588.021 463.661 590.26 461.423 590.26 458.661Z" stroke="#DB3630" stroke-opacity="0.8"></path>
  <path d="M639 458.661V416.861C639 414.1 636.761 411.861 634 411.861H607.26C604.499 411.861 602.26 414.1 602.26 416.861V458.661C602.26 461.423 604.499 463.661 607.26 463.661H634C636.761 463.661 639 461.423 639 458.661Z" fill="#82CBE5"></path>
  <path d="M639 458.661V416.861C639 414.1 636.761 411.861 634 411.861H607.26C604.499 411.861 602.26 414.1 602.26 416.861V458.661C602.26 461.423 604.499 463.661 607.26 463.661H634C636.761 463.661 639 461.423 639 458.661Z" stroke="#5286C4" stroke-opacity="0.8"></path>
  <path d="M635 400.361H557.52C548.96 400.361 542.02 407.301 542.02 415.861V459.661C542.02 468.222 548.96 475.161 557.52 475.161H635C643.56 475.161 650.5 468.222 650.5 459.661V415.861C650.5 407.301 643.56 400.361 635 400.361Z" stroke="#929195"></path>
  <g clip-path="url(#clip0_632_73)">
  <path d="M164 119.661V77.8608C164 75.0994 161.761 72.8608 159 72.8608H132.26C129.499 72.8608 127.26 75.0994 127.26 77.8608V119.661C127.26 122.422 129.499 124.661 132.26 124.661H159C161.761 124.661 164 122.422 164 119.661Z" fill="#E6726E"></path>
  <path d="M164 119.661V77.8608C164 75.0994 161.761 72.8608 159 72.8608H132.26C129.499 72.8608 127.26 75.0994 127.26 77.8608V119.661C127.26 122.422 129.499 124.661 132.26 124.661H159C161.761 124.661 164 122.422 164 119.661Z" stroke="#DB3630" stroke-opacity="0.8"></path>
  <path d="M212.74 119.661V77.8608C212.74 75.0994 210.501 72.8608 207.74 72.8608H181C178.239 72.8608 176 75.0994 176 77.8608V119.661C176 122.422 178.239 124.661 181 124.661H207.74C210.501 124.661 212.74 122.422 212.74 119.661Z" fill="#82CBE5"></path>
  <path d="M212.74 119.661V77.8608C212.74 75.0994 210.501 72.8608 207.74 72.8608H181C178.239 72.8608 176 75.0994 176 77.8608V119.661C176 122.422 178.239 124.661 181 124.661H207.74C210.501 124.661 212.74 122.422 212.74 119.661Z" stroke="#5286C4" stroke-opacity="0.8"></path>
  <path d="M149 188.661H11C4.92487 188.661 0 193.586 0 199.661V257.661C0 263.736 4.92487 268.661 11 268.661H149C155.075 268.661 160 263.736 160 257.661V199.661C160 193.586 155.075 188.661 149 188.661Z" fill="#DAE8FC"></path>
  <path d="M62.5229 234.161V223.979H68.628V225.073H63.7559V228.513H68.1707V229.607H63.7559V234.161H62.5229ZM70.7397 234.161V223.979H76.8449V225.073H71.9727V228.513H76.3874V229.607H71.9727V234.161H70.7397ZM87.0305 223.979V234.161H85.8373L80.289 226.167H80.1894V234.161H78.9565V223.979H80.1498L85.718 231.993H85.8173V223.979H87.0305ZM96.8357 223.979V234.161H95.6026V225.272H95.543L93.0572 226.922V225.669L95.6026 223.979H96.8357Z" fill="#393D6A"></path>
  <path d="M149 189.161H11C5.20101 189.161 0.5 193.862 0.5 199.661V257.661C0.5 263.46 5.20101 268.161 11 268.161H149C154.799 268.161 159.5 263.46 159.5 257.661V199.661C159.5 193.862 154.799 189.161 149 189.161Z" stroke="#000066" stroke-opacity="0.6"></path>
  <path d="M329 188.661H191C184.925 188.661 180 193.586 180 199.661V257.661C180 263.736 184.925 268.661 191 268.661H329C335.075 268.661 340 263.736 340 257.661V199.661C340 193.586 335.075 188.661 329 188.661Z" fill="#DAE8FC"></path>
  <path d="M241.539 234.161V223.979H247.644V225.073H242.772V228.513H247.186V229.607H242.772V234.161H241.539ZM249.755 234.161V223.979H255.861V225.073H250.988V228.513H255.403V229.607H250.988V234.161H249.755ZM266.046 223.979V234.161H264.853L259.305 226.167H259.205V234.161H257.972V223.979H259.165L264.734 231.993H264.833V223.979H266.046ZM272.272 234.161V233.266L275.633 229.587C276.027 229.156 276.352 228.782 276.607 228.463C276.862 228.142 277.051 227.84 277.174 227.559C277.3 227.274 277.363 226.975 277.363 226.664C277.363 226.306 277.276 225.996 277.104 225.734C276.935 225.472 276.703 225.27 276.408 225.128C276.113 224.985 275.782 224.914 275.414 224.914C275.023 224.914 274.681 224.995 274.39 225.157C274.101 225.316 273.878 225.54 273.718 225.829C273.563 226.117 273.485 226.455 273.485 226.843H272.312C272.312 226.246 272.449 225.722 272.724 225.272C272.999 224.821 273.374 224.47 273.848 224.218C274.325 223.966 274.86 223.84 275.454 223.84C276.05 223.84 276.579 223.966 277.04 224.218C277.5 224.47 277.861 224.809 278.123 225.237C278.385 225.664 278.516 226.14 278.516 226.664C278.516 227.038 278.448 227.404 278.312 227.762C278.18 228.117 277.948 228.513 277.616 228.951C277.288 229.385 276.832 229.915 276.249 230.542L273.962 232.988V233.067H278.695V234.161H272.272Z" fill="#393D6A"></path>
  <path d="M329 189.161H191C185.201 189.161 180.5 193.862 180.5 199.661V257.661C180.5 263.46 185.201 268.161 191 268.161H329C334.799 268.161 339.5 263.46 339.5 257.661V199.661C339.5 193.862 334.799 189.161 329 189.161Z" stroke="#000066" stroke-opacity="0.6"></path>
  <path d="M164 403.461V361.661C164 358.9 161.761 356.661 159 356.661H132.26C129.499 356.661 127.26 358.9 127.26 361.661V403.461C127.26 406.222 129.499 408.461 132.26 408.461H159C161.761 408.461 164 406.222 164 403.461Z" fill="#E6726E"></path>
  <path d="M164 403.461V361.661C164 358.9 161.761 356.661 159 356.661H132.26C129.499 356.661 127.26 358.9 127.26 361.661V403.461C127.26 406.222 129.499 408.461 132.26 408.461H159C161.761 408.461 164 406.222 164 403.461Z" stroke="#DB3630" stroke-opacity="0.8"></path>
  <path d="M212.74 403.461V361.661C212.74 358.9 210.501 356.661 207.74 356.661H181C178.239 356.661 176 358.9 176 361.661V403.461C176 406.222 178.239 408.461 181 408.461H207.74C210.501 408.461 212.74 406.222 212.74 403.461Z" fill="#82CBE5"></path>
  <path d="M212.74 403.461V361.661C212.74 358.9 210.501 356.661 207.74 356.661H181C178.239 356.661 176 358.9 176 361.661V403.461C176 406.222 178.239 408.461 181 408.461H207.74C210.501 408.461 212.74 406.222 212.74 403.461Z" stroke="#5286C4" stroke-opacity="0.8"></path>
  <path d="M193.87 356.661C193.87 356.937 194.094 357.161 194.37 357.161C194.646 357.161 194.87 356.937 194.87 356.661H193.87ZM260.354 268.307C260.158 268.112 259.842 268.112 259.646 268.307L256.464 271.489C256.269 271.685 256.269 272.001 256.464 272.196C256.66 272.392 256.976 272.392 257.172 272.196L260 269.368L262.828 272.196C263.024 272.392 263.34 272.392 263.536 272.196C263.731 272.001 263.731 271.685 263.536 271.489L260.354 268.307ZM194.87 356.661C194.87 334.952 211.035 322.676 227.475 310.945C235.663 305.103 243.916 299.394 250.111 292.738C256.321 286.067 260.5 278.409 260.5 268.661H259.5C259.5 278.082 255.475 285.509 249.379 292.057C243.269 298.621 235.115 304.265 226.895 310.131C210.52 321.815 193.87 334.369 193.87 356.661H194.87Z" fill="#5C94CB"></path>
  <path d="M145.13 356.661C145.13 356.937 145.354 357.161 145.63 357.161C145.906 357.161 146.13 356.937 146.13 356.661H145.13ZM80.3536 268.307C80.1583 268.112 79.8417 268.112 79.6464 268.307L76.4645 271.489C76.2692 271.685 76.2692 272.001 76.4645 272.196C76.6597 272.392 76.9763 272.392 77.1716 272.196L80 269.368L82.8284 272.196C83.0237 272.392 83.3403 272.392 83.5355 272.196C83.7308 272.001 83.7308 271.685 83.5355 271.489L80.3536 268.307ZM146.13 356.661C146.13 334.369 129.48 321.815 113.105 310.131C104.885 304.265 96.731 298.621 90.6207 292.057C84.525 285.509 80.5 278.082 80.5 268.661H79.5C79.5 278.409 83.6787 286.067 89.8887 292.738C96.084 299.394 104.337 305.103 112.525 310.945C128.965 322.676 145.13 334.952 145.13 356.661H146.13Z" fill="#DD423C"></path>
  <path d="M259.5 188.661C259.5 188.937 259.724 189.161 260 189.161C260.276 189.161 260.5 188.937 260.5 188.661H259.5ZM194.71 124.295C194.508 124.107 194.192 124.118 194.004 124.321L190.941 127.618C190.753 127.82 190.765 128.137 190.967 128.324C191.17 128.512 191.486 128.501 191.674 128.298L194.396 125.368L197.327 128.09C197.529 128.278 197.846 128.266 198.034 128.064C198.221 127.861 198.21 127.545 198.007 127.357L194.71 124.295ZM260.5 188.661C260.5 180.449 256.371 174.959 250.25 170.704C244.163 166.473 236.036 163.417 227.962 160.076C219.853 156.721 211.771 153.071 205.614 147.648C199.481 142.245 195.255 135.078 194.87 124.642L193.87 124.679C194.266 135.414 198.634 142.831 204.953 148.398C211.249 153.944 219.477 157.648 227.58 161C235.718 164.367 243.706 167.373 249.68 171.525C255.621 175.655 259.5 180.873 259.5 188.661H260.5Z" fill="#5C94CB"></path>
  <path d="M79.5 188.661C79.5 188.937 79.7239 189.161 80 189.161C80.2761 189.161 80.5 188.937 80.5 188.661H79.5ZM145.984 124.307C145.788 124.112 145.472 124.112 145.276 124.307L142.094 127.489C141.899 127.685 141.899 128.001 142.094 128.196C142.29 128.392 142.606 128.392 142.802 128.196L145.63 125.368L148.458 128.196C148.654 128.392 148.97 128.392 149.166 128.196C149.361 128.001 149.361 127.685 149.166 127.489L145.984 124.307ZM80.5 188.661C80.5 180.878 84.471 175.661 90.5362 171.528C96.6331 167.374 104.768 164.368 113.004 161.001C121.205 157.648 129.484 153.944 135.708 148.396C141.958 142.825 146.13 135.4 146.13 124.661H145.13C145.13 135.091 141.098 142.251 135.043 147.649C128.961 153.07 120.833 156.72 112.626 160.075C104.454 163.416 96.1819 166.471 89.9732 170.702C83.7327 174.954 79.5 180.444 79.5 188.661H80.5Z" fill="#DD423C"></path>
  </g>
  <path d="M595.76 308.561C595.76 308.837 595.984 309.061 596.26 309.061C596.536 309.061 596.76 308.837 596.76 308.561H595.76ZM596.614 268.207C596.418 268.012 596.102 268.012 595.906 268.207L592.724 271.389C592.529 271.585 592.529 271.901 592.724 272.097C592.92 272.292 593.236 272.292 593.432 272.097L596.26 269.268L599.088 272.097C599.284 272.292 599.6 272.292 599.796 272.097C599.991 271.901 599.991 271.585 599.796 271.389L596.614 268.207ZM596.76 308.561C596.76 288.561 596.76 288.561 596.76 268.561L595.76 268.561C595.76 288.561 595.76 288.561 595.76 308.561H596.76Z" fill="#929195"></path>
  <path d="M595.76 188.561C595.76 188.837 595.984 189.061 596.26 189.061C596.536 189.061 596.76 188.837 596.76 188.561H595.76ZM596.614 148.207C596.418 148.012 596.102 148.012 595.906 148.207L592.724 151.389C592.529 151.585 592.529 151.901 592.724 152.097C592.92 152.292 593.236 152.292 593.432 152.097L596.26 149.268L599.088 152.097C599.284 152.292 599.6 152.292 599.796 152.097C599.991 151.901 599.991 151.585 599.796 151.389L596.614 148.207ZM596.76 188.561C596.76 168.561 596.76 168.561 596.76 148.561L595.76 148.561C595.76 168.561 595.76 168.561 595.76 188.561H596.76Z" fill="#929195"></path>
  <path d="M595.76 400.361C595.76 400.637 595.984 400.861 596.26 400.861C596.536 400.861 596.76 400.637 596.76 400.361H595.76ZM596.614 360.008C596.418 359.812 596.102 359.812 595.906 360.008L592.724 363.19C592.529 363.385 592.529 363.701 592.724 363.897C592.92 364.092 593.236 364.092 593.432 363.897L596.26 361.068L599.088 363.897C599.284 364.092 599.6 364.092 599.796 363.897C599.991 363.701 599.991 363.385 599.796 363.19L596.614 360.008ZM596.76 400.361C596.76 380.361 596.76 380.361 596.76 360.361L595.76 360.361C595.76 380.361 595.76 380.361 595.76 400.361H596.76Z" fill="#929195"></path>
  <path d="M595.76 95.761C595.76 96.0372 595.984 96.261 596.26 96.261C596.536 96.261 596.76 96.0372 596.76 95.761H595.76ZM620.984 52.4074C620.788 52.2122 620.472 52.2122 620.276 52.4074L617.094 55.5894C616.899 55.7847 616.899 56.1013 617.094 56.2965C617.29 56.4918 617.606 56.4918 617.802 56.2965L620.63 53.4681L623.458 56.2965C623.654 56.4918 623.97 56.4918 624.166 56.2965C624.361 56.1013 624.361 55.7847 624.166 55.5894L620.984 52.4074ZM596.76 95.761C596.76 90.4942 598.248 86.8013 600.469 83.8199C602.707 80.815 605.694 78.5213 608.759 76.0525C611.805 73.5985 614.909 70.9842 617.242 67.3754C619.583 63.7535 621.13 59.1591 621.13 52.761H620.13C620.13 58.9824 618.631 63.3852 616.402 66.8326C614.166 70.2931 611.177 72.8202 608.131 75.2737C605.104 77.7126 601.998 80.0928 599.667 83.2225C597.318 86.3756 595.76 90.2778 595.76 95.761H596.76Z" fill="#929195"></path>
  <path d="M595.87 96C595.87 96.2762 596.094 96.5 596.37 96.5C596.646 96.5 596.87 96.2762 596.87 96H595.87ZM572.354 52.6464C572.158 52.4512 571.842 52.4512 571.646 52.6464L568.464 55.8284C568.269 56.0237 568.269 56.3403 568.464 56.5355C568.66 56.7308 568.976 56.7308 569.172 56.5355L572 53.7071L574.828 56.5355C575.024 56.7308 575.34 56.7308 575.536 56.5355C575.731 56.3403 575.731 56.0237 575.536 55.8284L572.354 52.6464ZM596.87 96C596.87 90.5174 595.312 86.5405 592.968 83.2933C590.638 80.0672 587.536 77.5719 584.505 75.053C581.456 72.5194 578.464 69.9525 576.226 66.5457C573.997 63.1537 572.5 58.9061 572.5 53H571.5C571.5 59.0939 573.05 63.5338 575.39 67.0949C577.721 70.6413 580.822 73.2931 583.865 75.8221C586.927 78.3656 589.917 80.7766 592.157 83.8787C594.381 86.9596 595.87 90.7326 595.87 96H596.87Z" fill="#929195"></path>
  <defs>
  <clippath id="clip0_632_73">
  <rect width="340" height="337" fill="white" transform="translate(0 72)"></rect>
  </clippath>
  </defs>
  </svg>
  </div>
  <div style="text-align: center;margin-bottom: 40px; margin-left: 30px;margin-right: 30px; opacity: 0.7;"> 
    In Mixture of Experts (left), each token is routed to a different expert feed-forward layer. In Mixture of Tokens (right) tokens within each group are mixed and the mixed token is processed by an expert feed-forward layer.
  </div>
</div>
<p><del>In practice, we use multiple different experts, each processing the same groups of tokens, just with groups merged in different ways for different experts. This design is similar in spirit to multi-head attention, with each attention head operating on the same groups of tokens, but aggregating them with different weights. As well, similarly to the Attention layer, each expert works independently from one another, so in later sections we will just explain a single expert’s behavior.</del></p>
<p><a href="#diag-intuition">The diagram</a> shows an intuitive comparison of Mixture of Tokens with Mixture of Experts.</p>
<div class="simontwice_style_small">
  <div>
    <svg width="694" height="659" viewbox="0 0 694 659" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M316.63 48.2654V6.46539C316.63 3.70397 314.391 1.46539 311.63 1.46539L284.89 1.46539C282.128 1.46539 279.89 3.70397 279.89 6.46539V48.2654C279.89 51.0268 282.128 53.2654 284.89 53.2654H311.63C314.391 53.2654 316.63 51.0268 316.63 48.2654Z" fill="#E6726E"></path>
    <path d="M316.63 48.2654V6.46539C316.63 3.70397 314.391 1.46539 311.63 1.46539L284.89 1.46539C282.128 1.46539 279.89 3.70397 279.89 6.46539V48.2654C279.89 51.0268 282.128 53.2654 284.89 53.2654H311.63C314.391 53.2654 316.63 51.0268 316.63 48.2654Z" stroke="#DB3630" stroke-opacity="0.8"></path>
    <path d="M365.37 48.2654V6.46539C365.37 3.70397 363.132 1.46539 360.37 1.46539L333.63 1.46539C330.869 1.46539 328.63 3.70397 328.63 6.46539V48.2654C328.63 51.0268 330.869 53.2654 333.63 53.2654H360.37C363.132 53.2654 365.37 51.0268 365.37 48.2654Z" fill="#82CBE5"></path>
    <path d="M365.37 48.2654V6.46539C365.37 3.70397 363.132 1.46539 360.37 1.46539L333.63 1.46539C330.869 1.46539 328.63 3.70397 328.63 6.46539V48.2654C328.63 51.0268 330.869 53.2654 333.63 53.2654H360.37C363.132 53.2654 365.37 51.0268 365.37 48.2654Z" stroke="#5286C4" stroke-opacity="0.8"></path>
    <path d="M414.11 48.2654V6.46539C414.11 3.70397 411.871 1.46539 409.11 1.46539L382.37 1.46539C379.608 1.46539 377.37 3.70397 377.37 6.46539V48.2654C377.37 51.0268 379.608 53.2654 382.37 53.2654H409.11C411.871 53.2654 414.11 51.0268 414.11 48.2654Z" fill="#F5D44D"></path>
    <path d="M414.11 48.2654V6.46539C414.11 3.70397 411.871 1.46539 409.11 1.46539L382.37 1.46539C379.608 1.46539 377.37 3.70397 377.37 6.46539V48.2654C377.37 51.0268 379.608 53.2654 382.37 53.2654H409.11C411.871 53.2654 414.11 51.0268 414.11 48.2654Z" stroke="#CCAB51" stroke-opacity="0.8"></path>
    <mask id="mask0_632_74" style="mask-type:luminance" maskunits="userSpaceOnUse" x="255" y="145" width="38" height="53">
    <path d="M255.52 150.386V192.186C255.52 194.947 257.759 197.186 260.52 197.186H287.26C290.021 197.186 292.26 194.947 292.26 192.186V150.386C292.26 147.625 290.021 145.386 287.26 145.386H260.52C257.759 145.386 255.52 147.625 255.52 150.386Z" fill="white"></path>
    </mask>
    <g mask="url(#mask0_632_74)">
    <path d="M264.183 157.945L273.923 171.677L283.663 157.945H264.183Z" fill="#C3DDE3"></path>
    <path d="M255.52 145.386L273.89 171.286L255.52 197.186V145.386Z" fill="#82CBE5"></path>
    <path d="M255.52 197.141L273.89 171.286L292.26 197.141H255.52Z" fill="#E6726E"></path>
    <path d="M255.52 145.386L264.705 158.336H283.075L273.89 145.386H255.52Z" fill="#A2D4E0"></path>
    <path d="M292.26 145.386H273.89L292.26 171.286V145.386Z" fill="#F5D44D"></path>
    <path d="M292.26 171.286L283.075 184.236L292.26 197.186V171.286Z" fill="#F5CAB5"></path>
    <path d="M273.89 171.286L283.075 158.336L292.26 171.286L283.075 184.236L273.89 171.286Z" fill="#ED926F"></path>
    </g>
    <path d="M255.52 150.386V192.186C255.52 194.947 257.759 197.186 260.52 197.186H287.26C290.021 197.186 292.26 194.947 292.26 192.186V150.386C292.26 147.625 290.021 145.386 287.26 145.386H260.52C257.759 145.386 255.52 147.625 255.52 150.386Z" stroke="#77767B" stroke-opacity="0.8"></path>
    <mask id="mask1_632_74" style="mask-type:luminance" maskunits="userSpaceOnUse" x="304" y="145" width="37" height="53">
    <path d="M309.26 197.186H336C338.761 197.186 341 194.947 341 192.186V150.386C341 147.625 338.761 145.386 336 145.386H309.26C306.499 145.386 304.26 147.625 304.26 150.386V192.186C304.26 194.947 306.499 197.186 309.26 197.186Z" fill="white"></path>
    </mask>
    <g mask="url(#mask1_632_74)">
    <path d="M313.168 184.973L322.907 171.24L313.168 157.508V184.973Z" fill="#F5D44D"></path>
    <path d="M304.26 197.186L322.63 171.286L341 197.186H304.26Z" fill="#FFDF61"></path>
    <path d="M340.968 197.186L322.63 171.286L340.968 145.386V197.186Z" fill="#E6726E"></path>
    <path d="M304.26 197.186L313.445 184.236V158.336L304.26 171.286V197.186Z" fill="#FBECB2"></path>
    <path d="M304.26 145.386V171.286L322.63 145.386H304.26Z" fill="#82CBE5"></path>
    <path d="M322.63 145.386L331.815 158.336L341 145.386H322.63Z" fill="#F5CAB5"></path>
    <path d="M322.63 171.286L313.445 158.336L322.63 145.386L331.815 158.336L322.63 171.286Z" fill="#A2D4E0"></path>
    </g>
    <path d="M309.26 197.186H336C338.761 197.186 341 194.947 341 192.186V150.386C341 147.625 338.761 145.386 336 145.386H309.26C306.499 145.386 304.26 147.625 304.26 150.386V192.186C304.26 194.947 306.499 197.186 309.26 197.186Z" stroke="#77767B" stroke-opacity="0.8"></path>
    <mask id="mask2_632_74" style="mask-type:luminance" maskunits="userSpaceOnUse" x="353" y="145" width="37" height="53">
    <path d="M353 150.386V192.186C353 194.947 355.239 197.186 358 197.186H384.74C387.501 197.186 389.74 194.947 389.74 192.186V150.386C389.74 147.625 387.501 145.386 384.74 145.386H358C355.239 145.386 353 147.625 353 150.386Z" fill="white"></path>
    </mask>
    <g mask="url(#mask2_632_74)">
    <path d="M361.663 157.945L371.403 171.677L381.143 157.945H361.663Z" fill="#C3DDE3"></path>
    <path d="M353 145.386L371.37 171.286L353 197.186V145.386Z" fill="#F5D44D"></path>
    <path d="M353 197.141L371.37 171.286L389.74 197.141H353Z" fill="#82CBE5"></path>
    <path d="M353 145.386L362.185 158.336H380.555L371.37 145.386H353Z" fill="#A2D4E0"></path>
    <path d="M389.74 145.386H371.37L389.74 171.286V145.386Z" fill="#82CBE5"></path>
    <path d="M389.74 171.286L380.555 184.236L389.74 197.186V171.286Z" fill="#F5CAB5"></path>
    <path d="M371.37 171.286L380.555 158.336L389.74 171.286L380.555 184.236L371.37 171.286Z" fill="#ED926F"></path>
    </g>
    <path d="M353 150.386V192.186C353 194.947 355.239 197.186 358 197.186H384.74C387.501 197.186 389.74 194.947 389.74 192.186V150.386C389.74 147.625 387.501 145.386 384.74 145.386H358C355.239 145.386 353 147.625 353 150.386Z" stroke="#77767B" stroke-opacity="0.8"></path>
    <mask id="mask3_632_74" style="mask-type:luminance" maskunits="userSpaceOnUse" x="401" y="145" width="38" height="53">
    <path d="M438.48 192.186V150.386C438.48 147.625 436.241 145.386 433.48 145.386H406.74C403.979 145.386 401.74 147.625 401.74 150.386V192.186C401.74 194.947 403.979 197.186 406.74 197.186H433.48C436.241 197.186 438.48 194.947 438.48 192.186Z" fill="white"></path>
    </mask>
    <g mask="url(#mask3_632_74)">
    <path d="M429.817 184.627L420.077 170.895L410.337 184.627H429.817Z" fill="#E6726E"></path>
    <path d="M438.48 197.186L420.11 171.286L438.48 145.386V197.186Z" fill="#FFDF61"></path>
    <path d="M438.48 145.432L420.11 171.286L401.74 145.432H438.48Z" fill="#82CBE5"></path>
    <path d="M438.48 197.186L429.295 184.236H410.925L420.11 197.186H438.48Z" fill="#ED926F"></path>
    <path d="M401.74 197.186H420.11L401.74 171.286V197.186Z" fill="#F5D44D"></path>
    <path d="M401.74 171.286L410.925 158.336L401.74 145.386V171.286Z" fill="#C3DDE3"></path>
    <path d="M420.11 171.286L410.925 184.236L401.74 171.286L410.925 158.336L420.11 171.286Z" fill="#FBECB2"></path>
    </g>
    <path d="M438.48 192.186V150.386C438.48 147.625 436.241 145.386 433.48 145.386H406.74C403.979 145.386 401.74 147.625 401.74 150.386V192.186C401.74 194.947 403.979 197.186 406.74 197.186H433.48C436.241 197.186 438.48 194.947 438.48 192.186Z" stroke="#77767B" stroke-opacity="0.8"></path>
    <path d="M434.48 133.886H259.52C250.96 133.886 244.02 140.826 244.02 149.386V193.186C244.02 201.746 250.96 208.686 259.52 208.686H434.48C443.04 208.686 449.98 201.746 449.98 193.186V149.386C449.98 140.826 443.04 133.886 434.48 133.886Z" stroke="#929195"></path>
    <path d="M149 309.386H11C4.92487 309.386 0 314.311 0 320.386V378.386C0 384.461 4.92487 389.386 11 389.386H149C155.075 389.386 160 384.461 160 378.386V320.386C160 314.311 155.075 309.386 149 309.386Z" fill="#DAE8FC"></path>
    <path d="M62.5229 354.886V344.705H68.628V345.798H63.7559V349.239H68.1707V350.332H63.7559V354.886H62.5229ZM70.7397 354.886V344.705H76.8449V345.798H71.9727V349.239H76.3874V350.332H71.9727V354.886H70.7397ZM87.0305 344.705V354.886H85.8373L80.289 346.892H80.1894V354.886H78.9565V344.705H80.1498L85.718 352.719H85.8173V344.705H87.0305ZM96.8357 344.705V354.886H95.6026V345.997H95.543L93.0572 347.648V346.395L95.6026 344.705H96.8357Z" fill="#393D6A"></path>
    <path d="M149 309.886H11C5.20101 309.886 0.5 314.587 0.5 320.386V378.386C0.5 384.185 5.20101 388.886 11 388.886H149C154.799 388.886 159.5 384.185 159.5 378.386V320.386C159.5 314.587 154.799 309.886 149 309.886Z" stroke="#000066" stroke-opacity="0.6"></path>
    <path d="M327 309.386H189C182.925 309.386 178 314.311 178 320.386V378.386C178 384.461 182.925 389.386 189 389.386H327C333.075 389.386 338 384.461 338 378.386V320.386C338 314.311 333.075 309.386 327 309.386Z" fill="#DAE8FC"></path>
    <path d="M239.539 354.886V344.705H245.644V345.798H240.772V349.239H245.186V350.332H240.772V354.886H239.539ZM247.755 354.886V344.705H253.861V345.798H248.988V349.239H253.403V350.332H248.988V354.886H247.755ZM264.046 344.705V354.886H262.853L257.305 346.892H257.205V354.886H255.972V344.705H257.165L262.734 352.719H262.833V344.705H264.046ZM270.272 354.886V353.991L273.633 350.312C274.027 349.882 274.352 349.507 274.607 349.189C274.862 348.867 275.051 348.566 275.174 348.284C275.3 347.999 275.363 347.701 275.363 347.389C275.363 347.031 275.276 346.721 275.104 346.459C274.935 346.198 274.703 345.995 274.408 345.853C274.113 345.71 273.782 345.639 273.414 345.639C273.023 345.639 272.681 345.72 272.39 345.883C272.101 346.042 271.878 346.266 271.718 346.554C271.563 346.842 271.485 347.18 271.485 347.568H270.312C270.312 346.972 270.449 346.448 270.724 345.997C270.999 345.546 271.374 345.195 271.848 344.943C272.325 344.691 272.86 344.565 273.454 344.565C274.05 344.565 274.579 344.691 275.04 344.943C275.5 345.195 275.861 345.535 276.123 345.962C276.385 346.39 276.516 346.865 276.516 347.389C276.516 347.764 276.448 348.13 276.312 348.488C276.18 348.843 275.948 349.239 275.616 349.676C275.288 350.11 274.832 350.641 274.249 351.267L271.962 353.713V353.793H276.695V354.886H270.272Z" fill="#393D6A"></path>
    <path d="M327 309.886H189C183.201 309.886 178.5 314.587 178.5 320.386V378.386C178.5 384.185 183.201 388.886 189 388.886H327C332.799 388.886 337.5 384.185 337.5 378.386V320.386C337.5 314.587 332.799 309.886 327 309.886Z" stroke="#000066" stroke-opacity="0.6"></path>
    <path d="M505 309.386H367C360.925 309.386 356 314.311 356 320.386V378.386C356 384.461 360.925 389.386 367 389.386H505C511.075 389.386 516 384.461 516 378.386V320.386C516 314.311 511.075 309.386 505 309.386Z" fill="#DAE8FC"></path>
    <path d="M417.32 354.886V344.705H423.425V345.798H418.553V349.239H422.968V350.332H418.553V354.886H417.32ZM425.537 354.886V344.705H431.642V345.798H426.77V349.239H431.184V350.332H426.77V354.886H425.537ZM441.827 344.705V354.886H440.634L435.086 346.892H434.986V354.886H433.753V344.705H434.947L440.515 352.719H440.614V344.705H441.827ZM451.493 355.026C450.837 355.026 450.252 354.913 449.738 354.687C449.228 354.462 448.822 354.149 448.52 353.748C448.222 353.343 448.06 352.874 448.033 352.341H449.286C449.312 352.669 449.425 352.952 449.624 353.191C449.823 353.426 450.083 353.609 450.405 353.738C450.726 353.867 451.082 353.932 451.473 353.932C451.911 353.932 452.299 353.856 452.637 353.703C452.975 353.551 453.24 353.339 453.432 353.067C453.624 352.795 453.721 352.48 453.721 352.122C453.721 351.748 453.628 351.418 453.442 351.133C453.257 350.844 452.985 350.619 452.627 350.457C452.269 350.294 451.831 350.213 451.314 350.213H450.499V349.119H451.314C451.719 349.119 452.073 349.046 452.378 348.901C452.687 348.755 452.927 348.549 453.099 348.284C453.275 348.019 453.363 347.707 453.363 347.349C453.363 347.005 453.286 346.705 453.134 346.45C452.982 346.194 452.766 345.995 452.488 345.853C452.213 345.71 451.888 345.639 451.513 345.639C451.162 345.639 450.83 345.704 450.519 345.833C450.211 345.959 449.959 346.143 449.763 346.385C449.568 346.624 449.462 346.912 449.445 347.25H448.252C448.272 346.716 448.432 346.249 448.734 345.848C449.036 345.444 449.43 345.129 449.917 344.903C450.408 344.678 450.946 344.565 451.533 344.565C452.163 344.565 452.703 344.693 453.154 344.948C453.605 345.2 453.951 345.533 454.193 345.947C454.435 346.362 454.556 346.809 454.556 347.29C454.556 347.863 454.405 348.352 454.103 348.756C453.805 349.161 453.399 349.441 452.885 349.597V349.676C453.528 349.782 454.031 350.056 454.392 350.496C454.753 350.934 454.934 351.476 454.934 352.122C454.934 352.676 454.783 353.173 454.481 353.614C454.183 354.051 453.775 354.396 453.258 354.648C452.741 354.9 452.153 355.026 451.493 355.026Z" fill="#393D6A"></path>
    <path d="M505 309.886H367C361.201 309.886 356.5 314.587 356.5 320.386V378.386C356.5 384.185 361.201 388.886 367 388.886H505C510.799 388.886 515.5 384.185 515.5 378.386V320.386C515.5 314.587 510.799 309.886 505 309.886Z" stroke="#000066" stroke-opacity="0.6"></path>
    <path d="M683 309.386H545C538.925 309.386 534 314.311 534 320.386V378.386C534 384.461 538.925 389.386 545 389.386H683C689.075 389.386 694 384.461 694 378.386V320.386C694 314.311 689.075 309.386 683 309.386Z" fill="#DAE8FC"></path>
    <path d="M595.286 354.886V344.705H601.391V345.798H596.519V349.239H600.933V350.332H596.519V354.886H595.286ZM603.502 354.886V344.705H609.608V345.798H604.735V349.239H609.15V350.332H604.735V354.886H603.502ZM619.793 344.705V354.886H618.6L613.052 346.892H612.952V354.886H611.719V344.705H612.912L618.481 352.719H618.58V344.705H619.793ZM625.78 352.798V351.784L630.255 344.705H630.99V346.276H630.493L627.113 351.625V351.705H633.138V352.798H625.78ZM630.573 354.886V352.49V352.018V344.705H631.746V354.886H630.573Z" fill="#393D6A"></path>
    <path d="M683 309.886H545C539.201 309.886 534.5 314.587 534.5 320.386V378.386C534.5 384.185 539.201 388.886 545 388.886H683C688.799 388.886 693.5 384.185 693.5 378.386V320.386C693.5 314.587 688.799 309.886 683 309.886Z" stroke="#000066" stroke-opacity="0.6"></path>
    <mask id="mask4_632_74" style="mask-type:luminance" maskunits="userSpaceOnUse" x="61" y="430" width="37" height="53">
    <path d="M61 435.81V477.61C61 480.371 63.2386 482.61 66 482.61H92.74C95.5014 482.61 97.74 480.371 97.74 477.61V435.81C97.74 433.049 95.5014 430.81 92.74 430.81H66C63.2386 430.81 61 433.049 61 435.81Z" fill="white"></path>
    </mask>
    <g mask="url(#mask4_632_74)">
    <path d="M69.6628 443.369L79.4027 457.102L89.1425 443.369H69.6628Z" fill="#C3DDE3"></path>
    <path d="M61 430.81L79.37 456.71L61 482.61V430.81Z" fill="#82CBE5"></path>
    <path d="M61 482.565L79.37 456.71L97.74 482.565H61Z" fill="#E6726E"></path>
    <path d="M61 430.81L70.185 443.76H88.555L79.37 430.81H61Z" fill="#A2D4E0"></path>
    <path d="M97.7401 430.81H79.3701L97.7401 456.71V430.81Z" fill="#F5D44D"></path>
    <path d="M97.7402 456.71L88.5552 469.66L97.7402 482.61V456.71Z" fill="#F5CAB5"></path>
    <path d="M79.3701 456.71L88.5551 443.76L97.7401 456.71L88.5551 469.66L79.3701 456.71Z" fill="#ED926F"></path>
    </g>
    <path d="M61 435.81V477.61C61 480.371 63.2386 482.61 66 482.61H92.74C95.5014 482.61 97.74 480.371 97.74 477.61V435.81C97.74 433.049 95.5014 430.81 92.74 430.81H66C63.2386 430.81 61 433.049 61 435.81Z" stroke="#77767B" stroke-opacity="0.8"></path>
    <mask id="mask5_632_74" style="mask-type:luminance" maskunits="userSpaceOnUse" x="238" y="430" width="38" height="53">
    <path d="M243.74 482.61H270.48C273.241 482.61 275.48 480.371 275.48 477.61V435.81C275.48 433.049 273.241 430.81 270.48 430.81H243.74C240.979 430.81 238.74 433.049 238.74 435.81V477.61C238.74 480.371 240.979 482.61 243.74 482.61Z" fill="white"></path>
    </mask>
    <g mask="url(#mask5_632_74)">
    <path d="M247.648 470.397L257.387 456.664L247.648 442.932V470.397Z" fill="#F5D44D"></path>
    <path d="M238.74 482.61L257.11 456.71L275.48 482.61H238.74Z" fill="#FFDF61"></path>
    <path d="M275.448 482.61L257.11 456.71L275.448 430.81V482.61Z" fill="#E6726E"></path>
    <path d="M238.74 482.61L247.925 469.66V443.76L238.74 456.71V482.61Z" fill="#FBECB2"></path>
    <path d="M238.74 430.81V456.71L257.11 430.81H238.74Z" fill="#82CBE5"></path>
    <path d="M257.11 430.81L266.295 443.76L275.48 430.81H257.11Z" fill="#F5CAB5"></path>
    <path d="M257.11 456.71L247.925 443.76L257.11 430.81L266.295 443.76L257.11 456.71Z" fill="#A2D4E0"></path>
    </g>
    <path d="M243.74 482.61H270.48C273.241 482.61 275.48 480.371 275.48 477.61V435.81C275.48 433.049 273.241 430.81 270.48 430.81H243.74C240.979 430.81 238.74 433.049 238.74 435.81V477.61C238.74 480.371 240.979 482.61 243.74 482.61Z" stroke="#77767B" stroke-opacity="0.8"></path>
    <mask id="mask6_632_74" style="mask-type:luminance" maskunits="userSpaceOnUse" x="416" y="430" width="38" height="53">
    <path d="M416.48 435.81V477.61C416.48 480.371 418.719 482.61 421.48 482.61H448.22C450.981 482.61 453.22 480.371 453.22 477.61V435.81C453.22 433.049 450.981 430.81 448.22 430.81H421.48C418.719 430.81 416.48 433.049 416.48 435.81Z" fill="white"></path>
    </mask>
    <g mask="url(#mask6_632_74)">
    <path d="M425.143 443.369L434.883 457.102L444.623 443.369H425.143Z" fill="#C3DDE3"></path>
    <path d="M416.48 430.81L434.85 456.71L416.48 482.61V430.81Z" fill="#F5D44D"></path>
    <path d="M416.48 482.565L434.85 456.71L453.22 482.565H416.48Z" fill="#82CBE5"></path>
    <path d="M416.48 430.81L425.665 443.76H444.035L434.85 430.81H416.48Z" fill="#A2D4E0"></path>
    <path d="M453.22 430.81H434.85L453.22 456.71V430.81Z" fill="#82CBE5"></path>
    <path d="M453.22 456.71L444.035 469.66L453.22 482.61V456.71Z" fill="#F5CAB5"></path>
    <path d="M434.85 456.71L444.035 443.76L453.22 456.71L444.035 469.66L434.85 456.71Z" fill="#ED926F"></path>
    </g>
    <path d="M416.48 435.81V477.61C416.48 480.371 418.719 482.61 421.48 482.61H448.22C450.981 482.61 453.22 480.371 453.22 477.61V435.81C453.22 433.049 450.981 430.81 448.22 430.81H421.48C418.719 430.81 416.48 433.049 416.48 435.81Z" stroke="#77767B" stroke-opacity="0.8"></path>
    <mask id="mask7_632_74" style="mask-type:luminance" maskunits="userSpaceOnUse" x="594" y="430" width="37" height="53">
    <path d="M630.96 477.61V435.81C630.96 433.049 628.721 430.81 625.96 430.81H599.22C596.459 430.81 594.22 433.049 594.22 435.81V477.61C594.22 480.371 596.459 482.61 599.22 482.61H625.96C628.721 482.61 630.96 480.371 630.96 477.61Z" fill="white"></path>
    </mask>
    <g mask="url(#mask7_632_74)">
    <path d="M622.297 470.051L612.557 456.319L602.817 470.051H622.297Z" fill="#E6726E"></path>
    <path d="M630.96 482.61L612.59 456.71L630.96 430.81V482.61Z" fill="#FFDF61"></path>
    <path d="M630.96 430.856L612.59 456.71L594.22 430.856H630.96Z" fill="#82CBE5"></path>
    <path d="M630.96 482.61L621.775 469.66H603.405L612.59 482.61H630.96Z" fill="#ED926F"></path>
    <path d="M594.22 482.61H612.59L594.22 456.71V482.61Z" fill="#F5D44D"></path>
    <path d="M594.22 456.71L603.405 443.76L594.22 430.81V456.71Z" fill="#C3DDE3"></path>
    <path d="M612.59 456.71L603.405 469.66L594.22 456.71L603.405 443.76L612.59 456.71Z" fill="#FBECB2"></path>
    </g>
    <path d="M630.96 477.61V435.81C630.96 433.049 628.721 430.81 625.96 430.81H599.22C596.459 430.81 594.22 433.049 594.22 435.81V477.61C594.22 480.371 596.459 482.61 599.22 482.61H625.96C628.721 482.61 630.96 480.371 630.96 477.61Z" stroke="#77767B" stroke-opacity="0.8"></path>
    <path d="M316.63 641.265V599.465C316.63 596.704 314.391 594.465 311.63 594.465H284.89C282.128 594.465 279.89 596.704 279.89 599.465V641.265C279.89 644.026 282.128 646.265 284.89 646.265H311.63C314.391 646.265 316.63 644.026 316.63 641.265Z" fill="#E6726E"></path>
    <path d="M316.63 641.265V599.465C316.63 596.704 314.391 594.465 311.63 594.465H284.89C282.128 594.465 279.89 596.704 279.89 599.465V641.265C279.89 644.026 282.128 646.265 284.89 646.265H311.63C314.391 646.265 316.63 644.026 316.63 641.265Z" stroke="#DB3630" stroke-opacity="0.8"></path>
    <path d="M365.37 641.265V599.465C365.37 596.704 363.131 594.465 360.37 594.465H333.63C330.868 594.465 328.63 596.704 328.63 599.465V641.265C328.63 644.026 330.868 646.265 333.63 646.265H360.37C363.131 646.265 365.37 644.026 365.37 641.265Z" fill="#82CBE5"></path>
    <path d="M365.37 641.265V599.465C365.37 596.704 363.131 594.465 360.37 594.465H333.63C330.868 594.465 328.63 596.704 328.63 599.465V641.265C328.63 644.026 330.868 646.265 333.63 646.265H360.37C363.131 646.265 365.37 644.026 365.37 641.265Z" stroke="#5286C4" stroke-opacity="0.8"></path>
    <path d="M414.11 641.265V599.465C414.11 596.704 411.871 594.465 409.11 594.465H382.37C379.608 594.465 377.37 596.704 377.37 599.465V641.265C377.37 644.026 379.608 646.265 382.37 646.265H409.11C411.871 646.265 414.11 644.026 414.11 641.265Z" fill="#F5D44D"></path>
    <path d="M414.11 641.265V599.465C414.11 596.704 411.871 594.465 409.11 594.465H382.37C379.608 594.465 377.37 596.704 377.37 599.465V641.265C377.37 644.026 379.608 646.265 382.37 646.265H409.11C411.871 646.265 414.11 644.026 414.11 641.265Z" stroke="#CCAB51" stroke-opacity="0.8"></path>
    <path d="M410.11 582.965H283.89C275.33 582.965 268.39 589.905 268.39 598.465V642.265C268.39 650.825 275.33 657.765 283.89 657.765H410.11C418.671 657.765 425.61 650.825 425.61 642.265V598.465C425.61 589.905 418.671 582.965 410.11 582.965Z" stroke="#929195"></path>
    <path d="M346.5 582.465C346.5 582.742 346.724 582.965 347 582.965C347.276 582.965 347.5 582.742 347.5 582.465H346.5ZM80.3534 483.248C80.1581 483.053 79.8415 483.053 79.6462 483.248L76.4643 486.43C76.269 486.626 76.269 486.942 76.4643 487.137C76.6595 487.333 76.9761 487.333 77.1714 487.137L79.9998 484.309L82.8282 487.137C83.0235 487.333 83.3401 487.333 83.5353 487.137C83.7306 486.942 83.7306 486.626 83.5353 486.43L80.3534 483.248ZM347.5 582.465C347.5 576.028 343.147 570.644 335.793 566.034C328.43 561.419 317.944 557.503 305.415 554.024C280.351 547.063 246.943 541.806 213.582 536.248C180.199 530.685 146.863 524.821 121.874 516.648C109.378 512.56 99.0091 507.908 91.7734 502.454C84.5422 497.003 80.4998 490.801 80.4998 483.602H79.4998C79.4998 491.232 83.8011 497.697 91.1715 503.252C98.5373 508.805 109.028 513.498 121.563 517.598C146.637 525.799 180.051 531.675 213.418 537.234C246.807 542.798 280.149 548.045 305.147 554.987C317.649 558.459 328.023 562.344 335.262 566.882C342.509 571.425 346.5 576.545 346.5 582.465H347.5Z" fill="#929195"></path>
    <path d="M346.5 582.465C346.5 582.742 346.724 582.965 347 582.965C347.276 582.965 347.5 582.742 347.5 582.465H346.5ZM258.348 483.242C258.149 483.05 257.832 483.056 257.641 483.254L254.513 486.489C254.321 486.688 254.326 487.005 254.525 487.196C254.723 487.388 255.04 487.383 255.232 487.185L258.012 484.309L260.888 487.089C261.086 487.281 261.403 487.276 261.595 487.077C261.787 486.879 261.781 486.562 261.583 486.37L258.348 483.242ZM347.5 582.465C347.5 569.926 341.906 561.145 333.556 554.123C325.235 547.124 314.138 541.843 303.1 536.294C280.945 525.157 258.994 512.92 258.5 483.593L257.5 483.61C258.006 513.602 280.555 526.08 302.65 537.188C313.737 542.761 324.703 547.984 332.913 554.888C341.094 561.769 346.5 570.289 346.5 582.465H347.5Z" fill="#929195"></path>
    <path d="M346.5 582.465C346.5 582.742 346.724 582.965 347 582.965C347.276 582.965 347.5 582.742 347.5 582.465H346.5ZM436.354 483.248C436.158 483.053 435.842 483.053 435.646 483.248L432.464 486.43C432.269 486.626 432.269 486.942 432.464 487.137C432.66 487.333 432.976 487.333 433.172 487.137L436 484.309L438.828 487.137C439.024 487.333 439.34 487.333 439.536 487.137C439.731 486.942 439.731 486.626 439.536 486.43L436.354 483.248ZM347.5 582.465C347.5 570.291 352.966 561.771 361.226 554.89C369.514 547.985 380.574 542.762 391.724 537.188C402.842 531.63 414.036 525.729 422.444 517.48C430.874 509.208 436.5 498.579 436.5 483.602H435.5C435.5 498.284 430.001 508.663 421.744 516.766C413.464 524.89 402.408 530.73 391.276 536.294C380.176 541.842 368.986 547.124 360.586 554.121C352.159 561.143 346.5 569.924 346.5 582.465H347.5Z" fill="#929195"></path>
    <path d="M346.5 582.465C346.5 582.742 346.724 582.965 347 582.965C347.276 582.965 347.5 582.742 347.5 582.465H346.5ZM614.354 483.248C614.158 483.053 613.842 483.053 613.646 483.248L610.464 486.43C610.269 486.626 610.269 486.942 610.464 487.137C610.66 487.333 610.976 487.333 611.172 487.137L614 484.309L616.828 487.137C617.024 487.333 617.34 487.333 617.536 487.137C617.731 486.942 617.731 486.626 617.536 486.43L614.354 483.248ZM347.5 582.465C347.5 576.545 351.491 571.425 358.738 566.882C365.977 562.344 376.351 558.459 388.853 554.987C413.851 548.045 447.193 542.798 480.582 537.234C513.949 531.675 547.363 525.799 572.437 517.598C584.972 513.498 595.462 508.805 602.828 503.252C610.199 497.697 614.5 491.232 614.5 483.602H613.5C613.5 490.801 609.458 497.003 602.226 502.454C594.991 507.908 584.622 512.56 572.126 516.648C547.137 524.821 513.801 530.685 480.418 536.248C447.057 541.806 413.649 547.063 388.585 554.024C376.056 557.503 365.57 561.419 358.207 566.034C350.853 570.644 346.5 576.028 346.5 582.465H347.5Z" fill="#929195"></path>
    <path d="M78.87 428.64C78.87 428.776 79.0939 428.887 79.37 428.887C79.6461 428.887 79.87 428.776 79.87 428.64H78.87ZM79.7235 388.959C79.5283 388.863 79.2117 388.863 79.0164 388.959L75.8345 390.53C75.6392 390.627 75.6392 390.783 75.8345 390.879C76.0297 390.976 76.3463 390.976 76.5416 390.879L79.37 389.482L82.1984 390.879C82.3937 390.976 82.7103 390.976 82.9055 390.879C83.1008 390.783 83.1008 390.627 82.9055 390.53L79.7235 388.959ZM79.87 428.64V389.133H78.87V428.64H79.87Z" fill="#929195"></path>
    <path d="M256.234 428.64C256.234 428.776 256.458 428.887 256.734 428.887C257.01 428.887 257.234 428.776 257.234 428.64H256.234ZM257.088 388.959C256.892 388.863 256.576 388.863 256.38 388.959L253.198 390.53C253.003 390.627 253.003 390.783 253.198 390.879C253.394 390.976 253.71 390.976 253.906 390.879L256.734 389.482L259.562 390.879C259.758 390.976 260.074 390.976 260.27 390.879C260.465 390.783 260.465 390.627 260.27 390.53L257.088 388.959ZM257.234 428.64V389.133H256.234V428.64H257.234Z" fill="#929195"></path>
    <path d="M433.599 428.64C433.599 428.776 433.823 428.887 434.099 428.887C434.375 428.887 434.599 428.776 434.599 428.64H433.599ZM434.453 388.959C434.257 388.863 433.941 388.863 433.746 388.959L430.564 390.53C430.368 390.627 430.368 390.783 430.564 390.879C430.759 390.976 431.075 390.976 431.271 390.879L434.099 389.482L436.927 390.879C437.122 390.976 437.438 390.976 437.634 390.879C437.829 390.783 437.829 390.627 437.634 390.53L434.453 388.959ZM434.599 428.64V389.133H433.599V428.64H434.599Z" fill="#929195"></path>
    <path d="M610.963 428.64C610.963 428.776 611.187 428.887 611.463 428.887C611.739 428.887 611.963 428.776 611.963 428.64H610.963ZM611.817 388.959C611.621 388.863 611.305 388.863 611.11 388.959L607.928 390.53C607.732 390.627 607.732 390.783 607.928 390.879C608.123 390.976 608.439 390.976 608.635 390.879L611.463 389.482L614.292 390.879C614.487 390.976 614.803 390.976 614.999 390.879C615.194 390.783 615.194 390.627 614.999 390.53L611.817 388.959ZM611.963 428.64V389.133H610.963V428.64H611.963Z" fill="#929195"></path>
    <path d="M79.5 309.386C79.5 309.662 79.7239 309.886 80 309.886C80.2761 309.886 80.5 309.662 80.5 309.386H79.5ZM347.354 208.833C347.158 208.637 346.842 208.637 346.646 208.833L343.464 212.015C343.269 212.21 343.269 212.527 343.464 212.722C343.66 212.917 343.976 212.917 344.172 212.722L347 209.893L349.828 212.722C350.024 212.917 350.34 212.917 350.536 212.722C350.731 212.527 350.731 212.21 350.536 212.015L347.354 208.833ZM80.5 309.386C80.5 303.374 84.5009 298.025 91.751 293.167C98.9918 288.315 109.367 284.026 121.868 280.117C146.865 272.299 180.207 266.042 213.592 259.778C246.957 253.517 280.365 247.249 305.43 239.41C317.961 235.492 328.445 231.169 335.806 226.236C343.157 221.31 347.5 215.699 347.5 209.186H346.5C346.5 215.199 342.499 220.547 335.249 225.406C328.008 230.258 317.633 234.547 305.132 238.456C280.135 246.273 246.793 252.53 213.408 258.795C180.043 265.055 146.635 271.323 121.57 279.162C109.039 283.081 98.5551 287.403 91.1943 292.336C83.8428 297.263 79.5 302.874 79.5 309.386H80.5Z" fill="#929195"></path>
    <path d="M257.5 309.386C257.5 309.662 257.724 309.886 258 309.886C258.276 309.886 258.5 309.662 258.5 309.386H257.5ZM347.354 208.833C347.158 208.637 346.842 208.637 346.646 208.833L343.464 212.015C343.269 212.21 343.269 212.527 343.464 212.722C343.66 212.917 343.976 212.917 344.172 212.722L347 209.893L349.828 212.722C350.024 212.917 350.34 212.917 350.536 212.722C350.731 212.527 350.731 212.21 350.536 212.015L347.354 208.833ZM258.5 309.386C258.5 297.036 263.976 287.766 272.248 280.004C280.539 272.225 291.607 265.992 302.745 259.722C313.857 253.467 325.039 247.175 333.436 239.298C341.851 231.403 347.5 221.886 347.5 209.186H346.5C346.5 221.537 341.024 230.807 332.752 238.569C324.461 246.347 313.393 252.581 302.255 258.851C291.143 265.106 279.961 271.397 271.564 279.275C263.149 287.17 257.5 296.687 257.5 309.386H258.5Z" fill="#929195"></path>
    <path d="M435.5 309.386C435.5 309.662 435.724 309.886 436 309.886C436.276 309.886 436.5 309.662 436.5 309.386H435.5ZM347.346 208.826C347.147 208.634 346.831 208.641 346.639 208.84L343.522 212.085C343.33 212.284 343.337 212.6 343.536 212.792C343.735 212.983 344.051 212.977 344.243 212.778L347.014 209.893L349.898 212.665C350.098 212.856 350.414 212.85 350.605 212.651C350.797 212.451 350.79 212.135 350.591 211.944L347.346 208.826ZM436.5 309.386C436.5 296.689 430.915 287.172 422.578 279.276C414.26 271.398 403.171 265.106 392.121 258.851C381.045 252.581 370.008 246.347 361.669 238.568C353.348 230.804 347.746 221.53 347.5 209.176L346.5 209.196C346.754 221.892 352.527 231.406 360.987 239.299C369.429 247.175 380.58 253.467 391.629 259.721C402.704 265.991 413.678 272.224 421.891 280.002C430.085 287.763 435.5 297.033 435.5 309.386H436.5Z" fill="#929195"></path>
    <path d="M613.5 309.386C613.5 309.662 613.724 309.886 614 309.886C614.276 309.886 614.5 309.662 614.5 309.386H613.5ZM347.346 208.826C347.147 208.634 346.831 208.641 346.639 208.84L343.522 212.085C343.33 212.284 343.337 212.6 343.536 212.792C343.735 212.983 344.051 212.977 344.243 212.778L347.014 209.893L349.898 212.665C350.098 212.856 350.414 212.85 350.605 212.651C350.797 212.451 350.79 212.135 350.591 211.944L347.346 208.826ZM614.5 309.386C614.5 302.874 610.174 297.264 602.847 292.337C595.512 287.404 585.063 283.081 572.572 279.162C547.584 271.323 514.27 265.055 480.967 258.795C447.645 252.53 414.334 246.273 389.29 238.456C376.765 234.546 366.346 230.258 359.036 225.405C351.716 220.545 347.62 215.192 347.5 209.176L346.5 209.196C346.63 215.705 351.065 221.312 358.483 226.238C365.912 231.17 376.438 235.492 388.992 239.41C414.104 247.249 447.48 253.517 480.783 259.778C514.105 266.042 547.354 272.299 572.272 280.116C584.734 284.026 595.074 288.314 602.289 293.166C609.514 298.025 613.5 303.373 613.5 309.386H614.5Z" fill="#929195"></path>
    <path d="M346.5 133.386C346.5 133.662 346.724 133.886 347 133.886C347.276 133.886 347.5 133.662 347.5 133.386H346.5ZM396.094 52.9118C395.898 52.7166 395.582 52.7166 395.387 52.9118L392.205 56.0938C392.009 56.2891 392.009 56.6057 392.205 56.8009C392.4 56.9962 392.716 56.9962 392.912 56.8009L395.74 53.9725L398.569 56.8009C398.764 56.9962 399.08 56.9962 399.276 56.8009C399.471 56.6057 399.471 56.2891 399.276 56.0938L396.094 52.9118ZM347.5 133.386C347.5 113.612 359.495 103.335 371.691 93.1123C383.854 82.9172 396.24 72.7625 396.24 53.2654H395.24C395.24 72.2375 383.256 82.113 371.049 92.3459C358.875 102.551 346.5 113.1 346.5 133.386H347.5Z" fill="#929195"></path>
    <path d="M346.5 133.386C346.5 133.662 346.724 133.886 347 133.886C347.276 133.886 347.5 133.662 347.5 133.386H346.5ZM298.614 52.9118C298.419 52.7166 298.102 52.7166 297.907 52.9118L294.725 56.0938C294.529 56.2891 294.529 56.6057 294.725 56.8009C294.92 56.9962 295.237 56.9962 295.432 56.8009L298.26 53.9725L301.089 56.8009C301.284 56.9962 301.601 56.9962 301.796 56.8009C301.991 56.6057 301.991 56.2891 301.796 56.0938L298.614 52.9118ZM347.5 133.386C347.5 113.1 335.126 102.551 322.951 92.3459C310.744 82.113 298.76 72.2375 298.76 53.2654H297.76C297.76 72.7625 310.147 82.9172 322.309 93.1123C334.505 103.335 346.5 113.612 346.5 133.386H347.5Z" fill="#929195"></path>
    <path d="M346.5 133.386C346.5 133.662 346.724 133.886 347 133.886C347.276 133.886 347.5 133.662 347.5 133.386H346.5ZM347.354 52.9118C347.158 52.7166 346.842 52.7166 346.647 52.9118L343.465 56.0938C343.269 56.2891 343.269 56.6057 343.465 56.8009C343.66 56.9962 343.976 56.9962 344.172 56.8009L347 53.9725L349.829 56.8009C350.024 56.9962 350.34 56.9962 350.536 56.8009C350.731 56.6057 350.731 56.2891 350.536 56.0938L347.354 52.9118ZM347.5 133.386C347.5 93.3259 347.5 93.3259 347.5 53.2654H346.5C346.5 93.3259 346.5 93.3259 346.5 133.386H347.5Z" fill="#929195"></path>
    </svg>
    <figcaption> The standard feed-forward (left) processes each token independently. In Switch (center), many tokens can choose the same expert, increasing the processing time for that expert. In Expert Choice (right) all experts process the same number of tokens, but some tokens might not be picked by any expert, resulting in no update for that input token.</figcaption>
  </div>
</div>
<p>To merge all the tokens for the expert we have to compute the importance weights for each token (those importance weights will be different for each and every expert). We use a simple controller ended with a softmax. Then, after merging the tokens, we process the resulting representation with the actual expert (FFN layer). Each of those experts is a simple MLP network, the same as standard feed-forward layer in vanilla Transformer architecture. After this processing we just distribute the expert output according to the same importance weights. See the equations below for details.</p>
<p><span class="math display">\[
\begin{align*}
\text{importance}_i &amp;= Softmax(Linear(\text{token}_i)) \\
\text{mergedToken} &amp;= \sum_i \text{token}_i * \text{importance}_i \\
\text{expertOutput} &amp;= FFN(\text{mergedToken}) \\
\text{for each } i: \text{distributedOutput}_i &amp;= \text{expertOutput} * \text{importance}_i
\end{align*}
\]</span></p>
<p>The <span class="math inline">\(\text{distributedOutput}_i\)</span> is what will be added to the residual stream to <span class="math inline">\(i\)</span>-th token. See the diagram below for visualization of those equations. <span class="SJ">this diagram could/should be visually improved</span></p>
<!-- {{< include diagrams/_general1.qmd >}} -->
<!-- {{< include diagrams/_ffn1.qmd >}} -->

<div class="mxgraph" style="max-width:100%;border:1px solid transparent;" data-mxgraph="{&quot;highlight&quot;:&quot;#0000ff&quot;,&quot;nav&quot;:true,&quot;resize&quot;:true,&quot;toolbar&quot;:&quot;zoom layers tags lightbox&quot;,&quot;edit&quot;:&quot;_blank&quot;,&quot;xml&quot;:&quot;<mxfile host=\&quot;app.diagrams.net\&quot; modified=\&quot;2023-10-06T16:14:49.567Z\&quot; agent=\&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36\&quot; etag=\&quot;UvRhxeiE3kUv6kb9InzY\&quot; version=\&quot;22.0.3\&quot; type=\&quot;google\&quot;>\n  <diagram id=\&quot;C2AunCsj_dl_T9ErqCql\&quot; name=\&quot;Page-3\&quot;>\n    <mxGraphModel dx=\&quot;1360\&quot; dy=\&quot;775\&quot; grid=\&quot;1\&quot; gridSize=\&quot;10\&quot; guides=\&quot;1\&quot; tooltips=\&quot;1\&quot; connect=\&quot;1\&quot; arrows=\&quot;1\&quot; fold=\&quot;1\&quot; page=\&quot;1\&quot; pageScale=\&quot;1\&quot; pageWidth=\&quot;850\&quot; pageHeight=\&quot;1100\&quot; math=\&quot;0\&quot; shadow=\&quot;0\&quot;>\n      <root>\n        <mxCell id=\&quot;0\&quot; />\n        <mxCell id=\&quot;1\&quot; parent=\&quot;0\&quot; />\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-1\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;rHSgD5Xiz5xGRAaISVyj-2\&quot; target=\&quot;rHSgD5Xiz5xGRAaISVyj-12\&quot; edge=\&quot;1\&quot;>\n          <mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-2\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#363636&amp;quot; style=&amp;quot;font-size: 11px;&amp;quot;&amp;gt;merger:&amp;lt;br&amp;gt;multiplication&amp;lt;br&amp;gt;(reduce-sum)&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;267.5\&quot; y=\&quot;610\&quot; width=\&quot;75\&quot; height=\&quot;50\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-11\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;rHSgD5Xiz5xGRAaISVyj-12\&quot; target=\&quot;rHSgD5Xiz5xGRAaISVyj-14\&quot; edge=\&quot;1\&quot;>\n          <mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-12\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#363636&amp;quot; style=&amp;quot;font-size: 11px;&amp;quot;&amp;gt;merged &amp;lt;br&amp;gt;token&amp;lt;/font&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;275\&quot; y=\&quot;550\&quot; width=\&quot;60\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-13\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;rHSgD5Xiz5xGRAaISVyj-14\&quot; target=\&quot;rHSgD5Xiz5xGRAaISVyj-16\&quot; edge=\&quot;1\&quot;>\n          <mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-14\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#363636&amp;quot;&amp;gt;FFN1&amp;lt;/font&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#000066;fontFamily=Helvetica;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;265.5\&quot; y=\&quot;480\&quot; width=\&quot;79\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-15\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;rHSgD5Xiz5xGRAaISVyj-16\&quot; target=\&quot;rHSgD5Xiz5xGRAaISVyj-21\&quot; edge=\&quot;1\&quot;>\n          <mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-16\&quot; value=\&quot;output\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;275\&quot; y=\&quot;420\&quot; width=\&quot;60\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-59\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;rHSgD5Xiz5xGRAaISVyj-21\&quot; target=\&quot;rHSgD5Xiz5xGRAaISVyj-52\&quot; edge=\&quot;1\&quot;>\n          <mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-21\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#363636&amp;quot; style=&amp;quot;font-size: 11px;&amp;quot;&amp;gt;emitter:&amp;lt;br&amp;gt;multiplication (expand)&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;267.5\&quot; y=\&quot;340\&quot; width=\&quot;75\&quot; height=\&quot;50\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-49\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;rHSgD5Xiz5xGRAaISVyj-26\&quot; target=\&quot;rHSgD5Xiz5xGRAaISVyj-47\&quot; edge=\&quot;1\&quot;>\n          <mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;>\n            <mxPoint x=\&quot;560\&quot; y=\&quot;760\&quot; as=\&quot;targetPoint\&quot; />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-51\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;rHSgD5Xiz5xGRAaISVyj-26\&quot; target=\&quot;rHSgD5Xiz5xGRAaISVyj-2\&quot; edge=\&quot;1\&quot;>\n          <mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-26\&quot; value=\&quot;\&quot; style=\&quot;shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;fontSize=16;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;320\&quot; y=\&quot;830\&quot; width=\&quot;245\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-27\&quot; value=\&quot;\&quot; style=\&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=1;\&quot; parent=\&quot;rHSgD5Xiz5xGRAaISVyj-26\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry width=\&quot;245\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-39\&quot; value=\&quot;emb1\&quot; style=\&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#82b366;overflow=hidden;fillColor=#d5e8d4;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=1;perimeterSpacing=7;\&quot; parent=\&quot;rHSgD5Xiz5xGRAaISVyj-27\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry width=\&quot;62\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot;>\n            <mxRectangle width=\&quot;62\&quot; height=\&quot;30\&quot; as=\&quot;alternateBounds\&quot; />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-28\&quot; value=\&quot;emb2\&quot; style=\&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#82b366;overflow=hidden;fillColor=#d5e8d4;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=1;perimeterSpacing=7;\&quot; parent=\&quot;rHSgD5Xiz5xGRAaISVyj-27\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;62\&quot; width=\&quot;61\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot;>\n            <mxRectangle width=\&quot;61\&quot; height=\&quot;30\&quot; as=\&quot;alternateBounds\&quot; />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-29\&quot; value=\&quot;emb3\&quot; style=\&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#82b366;overflow=hidden;fillColor=#d5e8d4;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=1;perimeterSpacing=7;\&quot; parent=\&quot;rHSgD5Xiz5xGRAaISVyj-27\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;123\&quot; width=\&quot;60\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot;>\n            <mxRectangle width=\&quot;60\&quot; height=\&quot;30\&quot; as=\&quot;alternateBounds\&quot; />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-30\&quot; value=\&quot;emb4\&quot; style=\&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#82b366;overflow=hidden;fillColor=#d5e8d4;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=1;perimeterSpacing=7;\&quot; parent=\&quot;rHSgD5Xiz5xGRAaISVyj-27\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;183\&quot; width=\&quot;62\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot;>\n            <mxRectangle width=\&quot;62\&quot; height=\&quot;30\&quot; as=\&quot;alternateBounds\&quot; />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-50\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;rHSgD5Xiz5xGRAaISVyj-40\&quot; target=\&quot;rHSgD5Xiz5xGRAaISVyj-2\&quot; edge=\&quot;1\&quot;>\n          <mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-58\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;rHSgD5Xiz5xGRAaISVyj-40\&quot; target=\&quot;rHSgD5Xiz5xGRAaISVyj-21\&quot; edge=\&quot;1\&quot;>\n          <mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-40\&quot; value=\&quot;\&quot; style=\&quot;shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;fontSize=16;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;425\&quot; y=\&quot;660\&quot; width=\&quot;245\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-41\&quot; value=\&quot;\&quot; style=\&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=1;\&quot; parent=\&quot;rHSgD5Xiz5xGRAaISVyj-40\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry width=\&quot;245\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-42\&quot; value=\&quot;w1\&quot; style=\&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#82b366;overflow=hidden;fillColor=#d5e8d4;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=1;perimeterSpacing=7;\&quot; parent=\&quot;rHSgD5Xiz5xGRAaISVyj-41\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry width=\&quot;62\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot;>\n            <mxRectangle width=\&quot;62\&quot; height=\&quot;30\&quot; as=\&quot;alternateBounds\&quot; />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-43\&quot; value=\&quot;w2\&quot; style=\&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#82b366;overflow=hidden;fillColor=#d5e8d4;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=1;perimeterSpacing=7;\&quot; parent=\&quot;rHSgD5Xiz5xGRAaISVyj-41\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;62\&quot; width=\&quot;61\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot;>\n            <mxRectangle width=\&quot;61\&quot; height=\&quot;30\&quot; as=\&quot;alternateBounds\&quot; />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-44\&quot; value=\&quot;w3\&quot; style=\&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#82b366;overflow=hidden;fillColor=#d5e8d4;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=1;perimeterSpacing=7;\&quot; parent=\&quot;rHSgD5Xiz5xGRAaISVyj-41\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;123\&quot; width=\&quot;60\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot;>\n            <mxRectangle width=\&quot;60\&quot; height=\&quot;30\&quot; as=\&quot;alternateBounds\&quot; />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-45\&quot; value=\&quot;w4\&quot; style=\&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#82b366;overflow=hidden;fillColor=#d5e8d4;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=1;perimeterSpacing=7;\&quot; parent=\&quot;rHSgD5Xiz5xGRAaISVyj-41\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;183\&quot; width=\&quot;62\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot;>\n            <mxRectangle width=\&quot;62\&quot; height=\&quot;30\&quot; as=\&quot;alternateBounds\&quot; />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-48\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;rHSgD5Xiz5xGRAaISVyj-47\&quot; target=\&quot;HxM0d9VlpgWr96RrhKD8-1\&quot; edge=\&quot;1\&quot;>\n          <mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-47\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#363636&amp;quot;&amp;gt;controller&amp;lt;/font&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;517.5\&quot; y=\&quot;760\&quot; width=\&quot;60\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-52\&quot; value=\&quot;\&quot; style=\&quot;shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;fontSize=16;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;182.5\&quot; y=\&quot;260\&quot; width=\&quot;245\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-53\&quot; value=\&quot;\&quot; style=\&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=1;\&quot; parent=\&quot;rHSgD5Xiz5xGRAaISVyj-52\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry width=\&quot;245\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-54\&quot; value=\&quot;emb1\&quot; style=\&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#82b366;overflow=hidden;fillColor=#d5e8d4;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=1;perimeterSpacing=7;\&quot; parent=\&quot;rHSgD5Xiz5xGRAaISVyj-53\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry width=\&quot;62\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot;>\n            <mxRectangle width=\&quot;62\&quot; height=\&quot;30\&quot; as=\&quot;alternateBounds\&quot; />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-55\&quot; value=\&quot;emb2\&quot; style=\&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#82b366;overflow=hidden;fillColor=#d5e8d4;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=1;perimeterSpacing=7;\&quot; parent=\&quot;rHSgD5Xiz5xGRAaISVyj-53\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;62\&quot; width=\&quot;61\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot;>\n            <mxRectangle width=\&quot;61\&quot; height=\&quot;30\&quot; as=\&quot;alternateBounds\&quot; />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-56\&quot; value=\&quot;emb3\&quot; style=\&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#82b366;overflow=hidden;fillColor=#d5e8d4;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=1;perimeterSpacing=7;\&quot; parent=\&quot;rHSgD5Xiz5xGRAaISVyj-53\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;123\&quot; width=\&quot;60\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot;>\n            <mxRectangle width=\&quot;60\&quot; height=\&quot;30\&quot; as=\&quot;alternateBounds\&quot; />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\&quot;rHSgD5Xiz5xGRAaISVyj-57\&quot; value=\&quot;emb4\&quot; style=\&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#82b366;overflow=hidden;fillColor=#d5e8d4;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=1;perimeterSpacing=7;\&quot; parent=\&quot;rHSgD5Xiz5xGRAaISVyj-53\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;183\&quot; width=\&quot;62\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot;>\n            <mxRectangle width=\&quot;62\&quot; height=\&quot;30\&quot; as=\&quot;alternateBounds\&quot; />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\&quot;HxM0d9VlpgWr96RrhKD8-2\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;HxM0d9VlpgWr96RrhKD8-1\&quot; target=\&quot;rHSgD5Xiz5xGRAaISVyj-40\&quot; edge=\&quot;1\&quot;>\n          <mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;HxM0d9VlpgWr96RrhKD8-1\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#363636&amp;quot;&amp;gt;softmax&amp;lt;/font&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;517.5\&quot; y=\&quot;710\&quot; width=\&quot;60\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n      </root>\n    </mxGraphModel>\n  </diagram>\n</mxfile>\n&quot;}"></div>
<script type="text/javascript" src="https://viewer.diagrams.net/js/viewer-static.min.js"></script>

<section id="how-to-group-tokens-in-mot" class="level2">
<h2 class="anchored" data-anchor-id="how-to-group-tokens-in-mot">How to Group Tokens in MoT</h2>
<p>The only question left is a matter of grouping tokens in an autoregressive decoding. For each and every sentence we will process exactly one token at a time during inference, and we want to simulate that environment during training. Therefore, we cannot put two tokens from the same sequence into a single group even during training, as we will not be processing them at the same time during inference. Fortunately, the training and inference is ussually performed in batches, so we can mix tokens on the same position from multiple sequences. See the diagram below.</p>
<div class="mxgraph" style="max-width:100%;border:1px solid transparent;" data-mxgraph="{&quot;highlight&quot;:&quot;#0000ff&quot;,&quot;nav&quot;:true,&quot;resize&quot;:true,&quot;toolbar&quot;:&quot;zoom layers tags lightbox&quot;,&quot;edit&quot;:&quot;_blank&quot;,&quot;xml&quot;:&quot;<mxfile host=\&quot;app.diagrams.net\&quot; modified=\&quot;2023-10-06T16:15:50.208Z\&quot; agent=\&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36\&quot; etag=\&quot;gr3hoMf3V8pFhms6YLmy\&quot; version=\&quot;22.0.3\&quot; type=\&quot;google\&quot;>\n  <diagram id=\&quot;fbuRVmtAR91k7QgiWp5u\&quot; name=\&quot;Page-5\&quot;>\n    <mxGraphModel dx=\&quot;1360\&quot; dy=\&quot;775\&quot; grid=\&quot;1\&quot; gridSize=\&quot;10\&quot; guides=\&quot;1\&quot; tooltips=\&quot;1\&quot; connect=\&quot;1\&quot; arrows=\&quot;1\&quot; fold=\&quot;1\&quot; page=\&quot;1\&quot; pageScale=\&quot;1\&quot; pageWidth=\&quot;850\&quot; pageHeight=\&quot;1100\&quot; math=\&quot;0\&quot; shadow=\&quot;0\&quot;>\n      <root>\n        <mxCell id=\&quot;0\&quot; />\n        <mxCell id=\&quot;1\&quot; parent=\&quot;0\&quot; />\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-1\&quot; value=\&quot;If\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;180\&quot; y=\&quot;330\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-2\&quot; value=\&quot;music\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;240\&quot; y=\&quot;330\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-3\&quot; value=\&quot;be\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;300\&quot; y=\&quot;330\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-4\&quot; value=\&quot;the\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;360\&quot; y=\&quot;330\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-5\&quot; value=\&quot;food\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;420\&quot; y=\&quot;330\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-8\&quot; value=\&quot;Attention\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;180\&quot; y=\&quot;360\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-9\&quot; value=\&quot;Is\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;240\&quot; y=\&quot;360\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-10\&quot; value=\&quot;All\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;300\&quot; y=\&quot;360\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-11\&quot; value=\&quot;You\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;360\&quot; y=\&quot;360\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-12\&quot; value=\&quot;Need\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;420\&quot; y=\&quot;360\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-14\&quot; value=\&quot;arXiv\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;180\&quot; y=\&quot;390\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-15\&quot; value=\&quot;is\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;240\&quot; y=\&quot;390\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-16\&quot; value=\&quot;a\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;300\&quot; y=\&quot;390\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-17\&quot; value=\&quot;free\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;360\&quot; y=\&quot;390\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-18\&quot; value=\&quot;distribution\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;420\&quot; y=\&quot;390\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-20\&quot; value=\&quot;Warsaw\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;180\&quot; y=\&quot;420\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-21\&quot; value=\&quot;,\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;240\&quot; y=\&quot;420\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-22\&quot; value=\&quot;officially\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;300\&quot; y=\&quot;420\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-23\&quot; value=\&quot;the\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;360\&quot; y=\&quot;420\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;0gGov9fe-cEn-tlOC79J-24\&quot; value=\&quot;Capital\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;420\&quot; y=\&quot;420\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-1\&quot; value=\&quot;\&quot; style=\&quot;html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0.6;dx=40;direction=south;notch=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;295\&quot; y=\&quot;450\&quot; width=\&quot;70\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-2\&quot; value=\&quot;If\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;130\&quot; y=\&quot;530\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-3\&quot; value=\&quot;music\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;220\&quot; y=\&quot;530\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-4\&quot; value=\&quot;be\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;310\&quot; y=\&quot;530\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-5\&quot; value=\&quot;the\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;400\&quot; y=\&quot;530\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-6\&quot; value=\&quot;food\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;490\&quot; y=\&quot;530\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-7\&quot; value=\&quot;Attention\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;130\&quot; y=\&quot;550\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-8\&quot; value=\&quot;Is\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;220\&quot; y=\&quot;550\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-9\&quot; value=\&quot;All\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;310\&quot; y=\&quot;550\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-10\&quot; value=\&quot;You\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;400\&quot; y=\&quot;550\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-11\&quot; value=\&quot;Need\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;490\&quot; y=\&quot;550\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-12\&quot; value=\&quot;arXiv\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;130\&quot; y=\&quot;570\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-13\&quot; value=\&quot;is\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;220\&quot; y=\&quot;570\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-14\&quot; value=\&quot;a\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;310\&quot; y=\&quot;570\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-15\&quot; value=\&quot;free\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;400\&quot; y=\&quot;570\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-16\&quot; value=\&quot;distribution\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;490\&quot; y=\&quot;570\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-17\&quot; value=\&quot;Warsaw\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;130\&quot; y=\&quot;590\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-18\&quot; value=\&quot;,\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;220\&quot; y=\&quot;590\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-19\&quot; value=\&quot;officially\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;310\&quot; y=\&quot;590\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-20\&quot; value=\&quot;the\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;400\&quot; y=\&quot;590\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-21\&quot; value=\&quot;Capital\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;490\&quot; y=\&quot;590\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-24\&quot; value=\&quot;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeWidth=2;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;120\&quot; y=\&quot;520\&quot; width=\&quot;80\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-25\&quot; value=\&quot;group #1\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;130\&quot; y=\&quot;620\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-26\&quot; value=\&quot;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeWidth=2;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;210\&quot; y=\&quot;520\&quot; width=\&quot;80\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-27\&quot; value=\&quot;group #2\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;220\&quot; y=\&quot;620\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-30\&quot; value=\&quot;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeWidth=2;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;300\&quot; y=\&quot;520\&quot; width=\&quot;80\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-31\&quot; value=\&quot;group #3\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;310\&quot; y=\&quot;620\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-32\&quot; value=\&quot;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeWidth=2;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;390\&quot; y=\&quot;520\&quot; width=\&quot;80\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-33\&quot; value=\&quot;group #4\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;400\&quot; y=\&quot;620\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-34\&quot; value=\&quot;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeWidth=2;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;480\&quot; y=\&quot;520\&quot; width=\&quot;80\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;f1csoL0ObmmRQoyrzgdK-35\&quot; value=\&quot;group #5\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;490\&quot; y=\&quot;620\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n      </root>\n    </mxGraphModel>\n  </diagram>\n</mxfile>\n&quot;}"></div>
<script type="text/javascript" src="https://viewer.diagrams.net/js/viewer-static.min.js"></script>
<p>While the maximum size of the group is limited by the batch size (number of sequences), note that those two numbers are not coupled together. We can always, if we want to, make groups smaller than the batch size.</p>
<div class="mxgraph" style="max-width:100%;border:1px solid transparent;" data-mxgraph="{&quot;highlight&quot;:&quot;#0000ff&quot;,&quot;nav&quot;:true,&quot;resize&quot;:true,&quot;toolbar&quot;:&quot;zoom layers tags lightbox&quot;,&quot;edit&quot;:&quot;_blank&quot;,&quot;xml&quot;:&quot;<mxfile host=\&quot;app.diagrams.net\&quot; modified=\&quot;2023-10-09T20:54:25.739Z\&quot; agent=\&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36\&quot; etag=\&quot;Ib8gRLxhNAvU8osuZUP7\&quot; version=\&quot;22.0.4\&quot; type=\&quot;google\&quot;>\n  <diagram id=\&quot;EDdJxNNs_RyqtWAIF5nD\&quot; name=\&quot;Page-7\&quot;>\n    <mxGraphModel dx=\&quot;729\&quot; dy=\&quot;768\&quot; grid=\&quot;1\&quot; gridSize=\&quot;10\&quot; guides=\&quot;1\&quot; tooltips=\&quot;1\&quot; connect=\&quot;1\&quot; arrows=\&quot;1\&quot; fold=\&quot;1\&quot; page=\&quot;1\&quot; pageScale=\&quot;1\&quot; pageWidth=\&quot;850\&quot; pageHeight=\&quot;1100\&quot; math=\&quot;0\&quot; shadow=\&quot;0\&quot;>\n      <root>\n        <mxCell id=\&quot;0\&quot; />\n        <mxCell id=\&quot;1\&quot; parent=\&quot;0\&quot; />\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-11\&quot; value=\&quot;arXiv\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;130\&quot; y=\&quot;490\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-12\&quot; value=\&quot;is\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;220\&quot; y=\&quot;490\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-13\&quot; value=\&quot;a\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;310\&quot; y=\&quot;490\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-14\&quot; value=\&quot;free\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;400\&quot; y=\&quot;490\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-15\&quot; value=\&quot;distribution\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;490\&quot; y=\&quot;490\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-16\&quot; value=\&quot;Warsaw\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;130\&quot; y=\&quot;510\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-17\&quot; value=\&quot;,\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;220\&quot; y=\&quot;510\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-18\&quot; value=\&quot;officially\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;310\&quot; y=\&quot;510\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-19\&quot; value=\&quot;the\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;400\&quot; y=\&quot;510\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-20\&quot; value=\&quot;Capital\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;490\&quot; y=\&quot;510\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-21\&quot; value=\&quot;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeWidth=2;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;120\&quot; y=\&quot;480\&quot; width=\&quot;80\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-22\&quot; value=\&quot;group #6\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;130\&quot; y=\&quot;540\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-23\&quot; value=\&quot;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeWidth=2;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;210\&quot; y=\&quot;480\&quot; width=\&quot;80\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-24\&quot; value=\&quot;group #7\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;220\&quot; y=\&quot;540\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-25\&quot; value=\&quot;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeWidth=2;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;300\&quot; y=\&quot;480\&quot; width=\&quot;80\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-26\&quot; value=\&quot;group #8\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;310\&quot; y=\&quot;540\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-27\&quot; value=\&quot;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeWidth=2;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;390\&quot; y=\&quot;480\&quot; width=\&quot;80\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-28\&quot; value=\&quot;group #9\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;400\&quot; y=\&quot;540\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-29\&quot; value=\&quot;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeWidth=2;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;480\&quot; y=\&quot;480\&quot; width=\&quot;80\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-30\&quot; value=\&quot;group #10\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;490\&quot; y=\&quot;540\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-31\&quot; value=\&quot;If\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;130\&quot; y=\&quot;390\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-32\&quot; value=\&quot;music\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;220\&quot; y=\&quot;390\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-33\&quot; value=\&quot;be\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;310\&quot; y=\&quot;390\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-34\&quot; value=\&quot;the\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;400\&quot; y=\&quot;390\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-35\&quot; value=\&quot;food\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;490\&quot; y=\&quot;390\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-36\&quot; value=\&quot;Attention\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;130\&quot; y=\&quot;410\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-37\&quot; value=\&quot;Is\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;220\&quot; y=\&quot;410\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-38\&quot; value=\&quot;All\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;310\&quot; y=\&quot;410\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-39\&quot; value=\&quot;You\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;400\&quot; y=\&quot;410\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-40\&quot; value=\&quot;Need\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;glass=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;490\&quot; y=\&quot;410\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-51\&quot; value=\&quot;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeWidth=2;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;120\&quot; y=\&quot;380\&quot; width=\&quot;80\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-52\&quot; value=\&quot;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeWidth=2;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;210\&quot; y=\&quot;380\&quot; width=\&quot;80\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-53\&quot; value=\&quot;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeWidth=2;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;300\&quot; y=\&quot;380\&quot; width=\&quot;80\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-54\&quot; value=\&quot;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeWidth=2;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;390\&quot; y=\&quot;380\&quot; width=\&quot;80\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-55\&quot; value=\&quot;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeWidth=2;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;480\&quot; y=\&quot;380\&quot; width=\&quot;80\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-56\&quot; value=\&quot;group #1\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;130\&quot; y=\&quot;440\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-57\&quot; value=\&quot;group #2\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;220\&quot; y=\&quot;440\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-58\&quot; value=\&quot;group #3\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;310\&quot; y=\&quot;440\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-59\&quot; value=\&quot;group #4\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;400\&quot; y=\&quot;440\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n        <mxCell id=\&quot;1bUVf6etFC-JyiSmVQvZ-60\&quot; value=\&quot;group #5\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;>\n          <mxGeometry x=\&quot;490\&quot; y=\&quot;440\&quot; width=\&quot;60\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot; />\n        </mxCell>\n      </root>\n    </mxGraphModel>\n  </diagram>\n</mxfile>\n&quot;}"></div>
<script type="text/javascript" src="https://viewer.diagrams.net/js/viewer-static.min.js"></script>
</section>
<section id="summarized-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="summarized-algorithm">Summarized algorithm</h2>
<p>The pseudocode for computing output of MoT layer is as follows:</p>
<p><span class="math display">\[
\begin{align*}
1. &amp; \text{Group tokens according to position} \\
2. &amp; \text{For each expert and each group of tokens:} \\
&amp; a. \text{Compute importance for all tokens in the group (with softmax, summing up to 1)} \\
&amp; b. \text{Compute the weighted average of token representation (the mixed token)} \\
&amp; c. \text{Run that mixed token through MLP (the most computationally heavy step)} \\
&amp; d. \text{Add the output to the residual stream of each token, scaled by its weight from step (2a)} \\
\end{align*}
\]</span></p>
<!-- 1. Group tokens according to position
2. Independently for each expert and each group:
    a. Compute importance for all tokens in the group (with softmax, summing up to 1)
    b. Compute the weighted average of token representation (the mixed token)
    c. Run that mixed token through MLP (the most computationally heavy step)
    d. Add the output to the residual stream of each token, scaled by its weight from step (2a)
-->
</section>
</section>
<section id="experiments" class="level1">
<h1>Experiments</h1>
<section id="experimental-setup" class="level2">
<h2 class="anchored" data-anchor-id="experimental-setup">Experimental setup</h2>
<p>For the baseline, we train a standard GPT-like model on the language modeling task using cross entropy loss on the C4 dataset <span class="citation" data-cites="2019t5">(<a href="#ref-2019t5" role="doc-biblioref">Raffel et al. 2019</a>)</span>. Our model replaces all feed-forward layers with Mixture of Tokens layers.</p>
<p>In our proof-of-concept experiments, we train a decoder-only Transformer model with the following hyperparameters:</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Model Hyperparameters
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>4 layers</li>
<li>256 embedding dimension</li>
<li>1024 hidden dimension</li>
<li>4 attention heads</li>
</ul>
</div>
</div>
<p>For the model implementing Mixture of Tokens we choose the following hyperparameters:</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mixture of Tokens Hyperparameters
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>32 group size</li>
<li>512 experts</li>
<li>32x more parameters than the feed-forward layer in the baseline model</li>
</ul>
</div>
</div>
<p>When training both the baseline and the Mixture of Token models we use the following setup:</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Training Setup
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>250K training steps</li>
<li>256 context length</li>
<li>256 batch size</li>
<li>lr warmup for the first 1% of training</li>
<li>cosine scheduling to 10% of peak lr at the end of training</li>
</ul>
</div>
</div>
<p>The learning rate was tuned separately for both our model and the baseline:</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Rate
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Baseline: 4e-3</li>
<li>Mixture of Tokens: 2e-3</li>
</ul>
</div>
</div>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<p>Our technique shows very promising results, reducing the required training steps by a factor of 4. The training time gains are also very significant.</p>


<meta charset="utf-8">

    <div>                            <div id="743b4225-1cdb-4050-9ced-c00b8f562f14" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("743b4225-1cdb-4050-9ced-c00b8f562f14")) {                    Plotly.newPlot(                        "743b4225-1cdb-4050-9ced-c00b8f562f14",                        [{"name":"Baseline","x":[1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,11000.0,12000.0,13000.0,14000.0,15000.0,16000.0,17000.0,18000.0,19000.0,20000.0,21000.0,22000.0,23000.0,24000.0,25000.0,26000.0,27000.0,28000.0,29000.0,30000.0,31000.0,32000.0,33000.0,34000.0,35000.0,36000.0,37000.0,38000.0,39000.0,40000.0,41000.0,42000.0,43000.0,44000.0,45000.0,46000.0,47000.0,48000.0,49000.0,50000.0,51000.0,52000.0,53000.0,54000.0,55000.0,56000.0,57000.0,58000.0,59000.0,60000.0,61000.0,62000.0,63000.0,64000.0,65000.0,66000.0,67000.0,68000.0,69000.0,70000.0,71000.0,72000.0,73000.0,74000.0,75000.0,76000.0,77000.0,78000.0,79000.0,80000.0,81000.0,82000.0,83000.0,84000.0,85000.0,86000.0,87000.0,88000.0,89000.0,90000.0,91000.0,92000.0,93000.0,94000.0,95000.0,96000.0,97000.0,98000.0,99000.0,100000.0,101000.0,102000.0,103000.0,104000.0,105000.0,106000.0,107000.0,108000.0,109000.0,110000.0,111000.0,112000.0,113000.0,114000.0,115000.0,116000.0,117000.0,118000.0,119000.0,120000.0,121000.0,122000.0,123000.0,124000.0,125000.0,126000.0,127000.0,128000.0,129000.0,130000.0,131000.0,132000.0,133000.0,134000.0,135000.0,136000.0,137000.0,138000.0,139000.0,140000.0,141000.0,142000.0,143000.0,144000.0,145000.0,146000.0,147000.0,148000.0,149000.0,150000.0,151000.0,152000.0,153000.0,154000.0,155000.0,156000.0,157000.0,158000.0,159000.0,160000.0,161000.0,162000.0,163000.0,164000.0,165000.0,166000.0,167000.0,168000.0,169000.0,170000.0,171000.0,172000.0,173000.0,174000.0,175000.0,176000.0,177000.0,178000.0,179000.0,180000.0,181000.0,182000.0,183000.0,184000.0,185000.0,186000.0,187000.0,188000.0,189000.0,190000.0,191000.0,192000.0,193000.0,194000.0,195000.0,196000.0,197000.0,198000.0,199000.0,200000.0,201000.0,202000.0,203000.0,204000.0,205000.0,206000.0,207000.0,208000.0,209000.0,210000.0,211000.0,212000.0,213000.0,214000.0,215000.0,216000.0,217000.0,218000.0,219000.0,220000.0,221000.0,222000.0,223000.0,224000.0,225000.0,226000.0,227000.0,228000.0,229000.0,230000.0,231000.0,232000.0,233000.0,234000.0,235000.0,236000.0,237000.0,238000.0,239000.0,240000.0,241000.0,242000.0,243000.0,244000.0,245000.0,246000.0,247000.0,248000.0,249000.0,250000.0],"y":[6.74839453125,5.4187265625,4.9736796875,4.735296875,4.630875,4.56698828125,4.519,4.4851484375,4.45952734375,4.43978515625,4.42198828125,4.4113125,4.39663671875,4.38164453125,4.37398046875,4.363734375,4.3577890625,4.34557421875,4.3384140625,4.32876171875,4.3243203125,4.319109375,4.3143203125,4.30580078125,4.2994453125,4.2956015625,4.292625,4.28841796875,4.28327734375,4.2778046875,4.277015625,4.272265625,4.2683046875,4.2671953125,4.262171875,4.26112109375,4.258078125,4.25455859375,4.25040625,4.24560546875,4.2448046875,4.24388671875,4.243,4.237890625,4.235296875,4.23173046875,4.2287109375,4.22712109375,4.22437109375,4.22453125,4.2206796875,4.21865625,4.21700390625,4.2149140625,4.21329296875,4.21173828125,4.20691015625,4.20617578125,4.20566015625,4.2051171875,4.199109375,4.20054296875,4.19573046875,4.19511328125,4.19466015625,4.1915859375,4.190609375,4.18851171875,4.18603125,4.1866171875,4.1823828125,4.1841171875,4.17944140625,4.18012890625,4.17614453125,4.17441015625,4.1732734375,4.171921875,4.1710234375,4.16890625,4.16660546875,4.1675703125,4.16252734375,4.161875,4.16170703125,4.159328125,4.15687890625,4.15765625,4.1536953125,4.15349609375,4.151734375,4.15009765625,4.15083203125,4.1477578125,4.14693359375,4.14521484375,4.14371875,4.140640625,4.1391875,4.1400859375,4.13821875,4.136171875,4.1346953125,4.13290234375,4.13382421875,4.1321171875,4.127845703125,4.12960546875,4.1271328125,4.124853515625,4.126546875,4.12116015625,4.118875,4.1194375,4.11716796875,4.117326171875,4.11452734375,4.11478515625,4.11265625,4.1118515625,4.110716796875,4.10695703125,4.105974609375,4.1069453125,4.1039609375,4.104115234375,4.10241796875,4.10298046875,4.100599609375,4.09512890625,4.09860546875,4.094466796875,4.09503515625,4.093646484375,4.08973828125,4.09240234375,4.09222265625,4.088080078125,4.08678515625,4.085791015625,4.082439453125,4.082064453125,4.08147265625,4.080451171875,4.08063671875,4.07994921875,4.07630078125,4.07576953125,4.074875,4.07455078125,4.073796875,4.071392578125,4.072060546875,4.06762890625,4.066365234375,4.0654765625,4.064796875,4.06455078125,4.0633359375,4.061970703125,4.060384765625,4.0594140625,4.059236328125,4.057814453125,4.056111328125,4.05688671875,4.055232421875,4.05441015625,4.052625,4.05313671875,4.05051171875,4.049529296875,4.0474765625,4.04734765625,4.046658203125,4.04436328125,4.0429375,4.044142578125,4.04340234375,4.039486328125,4.0435625,4.04140234375,4.0408046875,4.0386015625,4.0380625,4.037591796875,4.032896484375,4.0354765625,4.035083984375,4.03198828125,4.032712890625,4.030740234375,4.02956640625,4.029828125,4.0271875,4.025908203125,4.0264765625,4.024916015625,4.02585546875,4.024517578125,4.024865234375,4.02329296875,4.022279296875,4.021298828125,4.021123046875,4.021474609375,4.02086328125,4.01965234375,4.01898046875,4.01805859375,4.017619140625,4.01712109375,4.015287109375,4.01531640625,4.016392578125,4.014390625,4.013958984375,4.0118671875,4.0142265625,4.01219140625,4.011998046875,4.011248046875,4.010705078125,4.01103125,4.01233984375,4.008513671875,4.01001953125,4.00755078125,4.008427734375,4.00748046875,4.006416015625,4.007978515625,4.005435546875,4.00546875,4.00516015625,4.00378515625,4.00555859375,4.0049765625,4.005669921875,4.005052734375,4.002826171875,4.003580078125,4.002212890625,4.00363671875,4.001841796875,4.00212890625,4.003541015625,4.002578125,4.0037109375,4.00257421875],"type":"scatter"},{"name":"Mixture of Tokens","x":[1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,11000.0,12000.0,13000.0,14000.0,15000.0,16000.0,17000.0,18000.0,19000.0,20000.0,21000.0,22000.0,23000.0,24000.0,25000.0,26000.0,27000.0,28000.0,29000.0,30000.0,31000.0,32000.0,33000.0,34000.0,35000.0,36000.0,37000.0,38000.0,39000.0,40000.0,41000.0,42000.0,43000.0,44000.0,45000.0,46000.0,47000.0,48000.0,49000.0,50000.0,51000.0,52000.0,53000.0,54000.0,55000.0,56000.0,57000.0,58000.0,59000.0,60000.0,61000.0,62000.0,63000.0,64000.0,65000.0,66000.0,67000.0,68000.0,69000.0,70000.0,71000.0,72000.0,73000.0,74000.0,75000.0,76000.0,77000.0,78000.0,79000.0,80000.0,81000.0,82000.0,83000.0,84000.0,85000.0,86000.0,87000.0,88000.0,89000.0,90000.0,91000.0,92000.0,93000.0,94000.0,95000.0,96000.0,97000.0,98000.0,99000.0,100000.0,101000.0,102000.0,103000.0,104000.0,105000.0,106000.0,107000.0,108000.0,109000.0,110000.0,111000.0,112000.0,113000.0,114000.0,115000.0,116000.0,117000.0,118000.0,119000.0,120000.0,121000.0,122000.0,123000.0,124000.0,125000.0,126000.0,127000.0,128000.0,129000.0,130000.0,131000.0,132000.0,133000.0,134000.0,135000.0,136000.0,137000.0,138000.0,139000.0,140000.0,141000.0,142000.0,143000.0,144000.0,145000.0,146000.0,147000.0,148000.0,149000.0,150000.0,151000.0,152000.0,153000.0,154000.0,155000.0,156000.0,157000.0,158000.0,159000.0,160000.0,161000.0,162000.0,163000.0,164000.0,165000.0,166000.0,167000.0,168000.0,169000.0,170000.0,171000.0,172000.0,173000.0,174000.0,175000.0,176000.0,177000.0,178000.0,179000.0,180000.0,181000.0,182000.0,183000.0,184000.0,185000.0,186000.0,187000.0,188000.0,189000.0,190000.0,191000.0,192000.0,193000.0,194000.0,195000.0,196000.0,197000.0,198000.0,199000.0,200000.0,201000.0,202000.0,203000.0,204000.0,205000.0,206000.0,207000.0,208000.0,209000.0,210000.0,211000.0,212000.0,213000.0,214000.0,215000.0,216000.0,217000.0,218000.0,219000.0,220000.0,221000.0,222000.0,223000.0,224000.0,225000.0,226000.0,227000.0,228000.0,229000.0,230000.0,231000.0,232000.0,233000.0,234000.0,235000.0,236000.0,237000.0,238000.0,239000.0,240000.0,241000.0,242000.0,243000.0,244000.0,245000.0,246000.0,247000.0,248000.0,249000.0,250000.0],"y":[6.865790036678314,5.500211125850678,5.061204619407654,4.781460484981537,4.641498310565948,4.555344714164734,4.490929737091064,4.443757008075714,4.405196396350861,4.37313479423523,4.344426648139954,4.323108457088471,4.299607085704803,4.279431181430817,4.263306029796601,4.247776464939117,4.234482085704803,4.221364744663239,4.2098522415161135,4.196074651241302,4.187593363761902,4.177408302307129,4.170638454437256,4.159920306205749,4.15081564617157,4.145412252902984,4.139124257087707,4.131852756023407,4.123324332237243,4.11731966304779,4.113346085071564,4.107695070266724,4.101226757526398,4.098156608104706,4.091862853527069,4.088939291715622,4.08453405046463,4.080003803968429,4.07474255156517,4.069562127351761,4.0672049102783205,4.064178363561631,4.0609314668178556,4.056524780988693,4.053007598161697,4.047103298664093,4.043819102048874,4.0414996073246,4.038083200454712,4.03592233991623,4.032123554468155,4.029180178403855,4.027229268789291,4.024126539945603,4.02128267121315,4.018775345087051,4.0136179099082945,4.012527460336686,4.011893786191941,4.0094586644172665,4.003874507665635,4.00408109164238,3.9995777270793913,3.997126739740372,3.9969446184635165,3.9934199278354643,3.9913556628227234,3.9893966519832613,3.9867340905666353,3.986563229560852,3.9814727687835694,3.9834299783706664,3.978228116750717,3.9784797337055204,3.974903697013855,3.972870152950287,3.9708729276657104,3.9691721091270447,3.9676777884960175,3.9655341460704805,3.962736085653305,3.9628406882286074,3.958150596380234,3.9572064304351806,3.9572911744117736,3.9544747989177704,3.9525790514945984,3.9521092398166657,3.9483649508953094,3.948203722476959,3.945921738624573,3.9438791739940644,3.9440752167701723,3.942056930065155,3.9397456793785097,3.938746748685837,3.937531670331955,3.9344002854824067,3.931611962556839,3.932666870355606,3.9304284567832948,3.9282506439685823,3.9271608049869537,3.9252567477226257,3.9263192043304445,3.9234907367229463,3.9210682899951936,3.921439744234085,3.919512340307236,3.916478786468506,3.918222924232483,3.912615067720413,3.909725915670395,3.91176522898674,3.9081051626205445,3.9083814005851747,3.9069166042804717,3.9061199796199797,3.9035818481445315,3.903709605693817,3.9023211553096773,3.8991231470108034,3.89718363571167,3.899226724386215,3.8953543226718903,3.8952864673137664,3.8937351932525637,3.8945165870189666,3.8917897469997405,3.8874791808128357,3.889599235296249,3.886183403491974,3.8874019949436187,3.885254539966583,3.881638179540634,3.884223243713379,3.883069363594055,3.880081481218338,3.878324861049652,3.8768155725002287,3.8742032346725463,3.8739651515483855,3.873274619817734,3.8733756947517395,3.8730960862636565,3.8718043982982637,3.8683799533843994,3.8676790974140167,3.8672288568019866,3.8673909361362457,3.8659597504138947,3.863656238079071,3.8642505462169647,3.8606404564380647,3.858939951658249,3.858395966768265,3.8568559811115266,3.8574499735832215,3.855578766822815,3.8548514432907104,3.8535311052799224,3.852460629701614,3.8520446791648864,3.850679286956787,3.849676181077957,3.8503636083602903,3.8481787927150726,3.847291652441025,3.846029278039932,3.8467375905513763,3.843457180738449,3.8432434759140013,3.84123197722435,3.8409913368225097,3.8404709768295286,3.838491157054901,3.8369598042964936,3.8380221192836763,3.8370410463809965,3.833674565553665,3.837532728433609,3.8359467537403105,3.834789340496063,3.8331626744270326,3.832846212863922,3.831990896940231,3.8268260090351105,3.8300914266109465,3.8295945544242858,3.8270066785812378,3.8272946214675905,3.825755661725998,3.8243437113761902,3.8244080152511595,3.8222766811847686,3.820967532634735,3.8215505781173706,3.820350860118866,3.8214788076877593,3.8193533620834352,3.819955214738846,3.8186098570823668,3.8177401185035706,3.817552139997482,3.816974099159241,3.817406270503998,3.8170814564228057,3.8157693605422973,3.8148661241531374,3.814633913755417,3.8133696205615997,3.813557290315628,3.81179550242424,3.811197649717331,3.812590065956116,3.810574800014496,3.811046081781387,3.808258488416672,3.810983619213104,3.808893218278885,3.8086019842624665,3.8076923871040345,3.8071739885807037,3.8074519782066347,3.8087132613658907,3.8052890610694887,3.806961742401123,3.8044023671150207,3.80590287733078,3.8039762332439424,3.8035476679801943,3.8046592409610747,3.8024042971134184,3.802197088241577,3.801558027267456,3.8005723276138306,3.8025530395507814,3.8023419806957244,3.802598600387573,3.8017730872631073,3.7998546545505523,3.8000860295295715,3.7992646408081057,3.8004151334762573,3.7985526072978972,3.798954046010971,3.800132167816162,3.799162902355194,3.8003664946556093,3.798871917963028],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"text":"Training Loss vs Step","x":0.5},"shapes":[{"line":{"color":"red","dash":"dot","width":0.5},"type":"line","x0":61000.0,"x1":250000.0,"y0":4.00257421875,"y1":4.00257421875}],"annotations":[{"arrowcolor":"black","arrowhead":3,"arrowwidth":0.5,"ax":0.0,"ay":50,"font":{"color":"black","size":11},"showarrow":true,"text":"24% of training steps","x":117700.0,"y":4.00257421875}],"xaxis":{"range":[0,250000.0],"title":{"text":"training step"}},"yaxis":{"range":[3.5,5],"title":{"text":"loss"}}},                        {"responsive": true}                    )                };                            </script>        </div>

    
<div style="text-align: center;margin-bottom: 40px; margin-left: 30px;margin-right: 30px; opacity:0.7"> Our Mixture of Tokens model attains the dense model's final training loss in just 24% of steps.
</div>



<meta charset="utf-8">

    <div>                            <div id="4c45a9bd-584f-4960-b285-8c98c1ddcfad" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("4c45a9bd-584f-4960-b285-8c98c1ddcfad")) {                    Plotly.newPlot(                        "4c45a9bd-584f-4960-b285-8c98c1ddcfad",                        [{"name":"Baseline","x":[0.0,0.08762166666666667,0.17644361111111112,0.26527666666666666,0.3539075,0.4435047222222222,0.5321094444444444,0.6218075000000001,0.7105758333333333,0.7999666666666667,0.8883986111111112,0.9774852777777778,1.0673408333333334,1.1558666666666666,1.2442119444444444,1.3331069444444446,1.419881388888889,1.5081022222222222,1.5953297222222222,1.6828311111111112,1.7700372222222223,1.8575183333333334,1.9448580555555555,2.0327033333333335,2.121116944444444,2.2089166666666666,2.29659,2.385211388888889,2.473233333333333,2.559935,2.6478683333333333,2.7348616666666667,2.8230225,2.9098430555555552,2.998060277777778,3.0854044444444444,3.1721883333333336,3.2592933333333334,3.3472327777777777,3.433851388888889,3.521051388888889,3.609291666666667,3.6965080555555554,3.7832800000000004,3.8702430555555556,3.9576874999999996,4.044698333333334,4.1319525,4.218946944444444,4.306704444444445,4.393870277777778,4.481081388888889,4.568294444444445,4.655444444444444,4.742686388888888,4.8297897222222215,4.916908888888889,5.004116111111111,5.0910649999999995,5.178214166666667,5.265334999999999,5.3524344444444445,5.439638333333334,5.526818333333333,5.613704722222222,5.700817499999999,5.787931944444445,5.875058888888889,5.962191666666667,6.049612222222222,6.136620833333333,6.224062222222222,6.311106666666666,6.398553611111112,6.4857233333333335,6.572978055555556,6.6600463888888894,6.7472336111111115,6.834268333333334,6.921397222222222,7.00843111111111,7.095643055555556,7.182788888888889,7.2697433333333334,7.356875,7.443795,7.530955277777777,7.6179775,7.704945833333333,7.792298611111112,7.879179722222222,7.966483888888889,8.053386944444444,8.140718055555554,8.227731944444445,8.315153333333333,8.401953055555555,8.489047222222222,8.57599888888889,8.6630075,8.750449444444444,8.83744138888889,8.92451,9.01161361111111,9.09861861111111,9.185570555555554,9.27280861111111,9.359810833333334,9.446755555555555,9.533864999999999,9.620834166666667,9.707910833333333,9.794974722222221,9.8820975,9.969790833333334,10.059529166666668,10.148275277777778,10.237225555555556,10.325973055555554,10.413803611111112,10.500648055555555,10.588213055555556,10.67548861111111,10.762519166666667,10.850113055555555,10.937474166666666,11.025301944444445,11.11185888888889,11.199786666666668,11.2870425,11.374980555555556,11.462117222222224,11.549749166666667,11.636829444444444,11.724797222222222,11.811960555555554,11.899705555555556,11.987722777777778,12.074925555555556,12.162574166666667,12.250062777777778,12.337125277777778,12.42514888888889,12.511965277777778,12.59950138888889,12.687078055555556,12.77459138888889,12.862399166666668,12.949969166666667,13.038156388888888,13.12617388888889,13.214363888888888,13.302555555555555,13.390345833333335,13.477509722222223,13.565365,13.65278638888889,13.741053888888889,13.828498055555556,13.917450277777778,14.0049925,14.092954166666667,14.180871388888889,14.269054166666667,14.35682,14.444571944444446,14.532745555555556,14.621474444444443,14.70994611111111,14.798998888888889,14.88682,14.975245555555555,15.063854444444443,15.151840277777778,15.239972222222223,15.328056388888887,15.416480555555555,15.505451111111112,15.593709166666667,15.682551388888887,15.770987222222221,15.859359166666666,15.947549166666668,16.035676111111112,16.124238333333334,16.212366666666664,16.3009725,16.389469444444444,16.477648333333335,16.56602611111111,16.654208055555554,16.7425775,16.830786111111113,16.918509444444442,17.00650472222222,17.094911111111113,17.183713333333333,17.272284444444445,17.36049527777778,17.449826388888887,17.538273611111112,17.62639638888889,17.715115555555556,17.802473333333335,17.891330555555555,17.980198333333334,18.069332777777777,18.158273333333334,18.24664333333333,18.335828611111108,18.424611666666667,18.51265777777778,18.601486666666666,18.690482499999998,18.779454722222223,18.868869166666666,18.95748888888889,19.0462675,19.135793333333332,19.22511777777778,19.313645833333332,19.402723055555555,19.492199444444445,19.581441666666667,19.670004166666665,19.759194444444447,19.847888333333334,19.93624,20.025037777777776,20.11338388888889,20.202275,20.29097833333333,20.37863888888889,20.467515833333334,20.556151944444444,20.644791944444446,20.733088611111114,20.821204722222223,20.909725277777778,20.998593055555556,21.086310555555553,21.174205555555556,21.26254472222222,21.351176666666667,21.440162222222224,21.528179166666668,21.61698777777778,21.705759444444443,21.794127777777778,21.883115000000004],"y":[6.74839453125,5.4187265625,4.9736796875,4.735296875,4.630875,4.56698828125,4.519,4.4851484375,4.45952734375,4.43978515625,4.42198828125,4.4113125,4.39663671875,4.38164453125,4.37398046875,4.363734375,4.3577890625,4.34557421875,4.3384140625,4.32876171875,4.3243203125,4.319109375,4.3143203125,4.30580078125,4.2994453125,4.2956015625,4.292625,4.28841796875,4.28327734375,4.2778046875,4.277015625,4.272265625,4.2683046875,4.2671953125,4.262171875,4.26112109375,4.258078125,4.25455859375,4.25040625,4.24560546875,4.2448046875,4.24388671875,4.243,4.237890625,4.235296875,4.23173046875,4.2287109375,4.22712109375,4.22437109375,4.22453125,4.2206796875,4.21865625,4.21700390625,4.2149140625,4.21329296875,4.21173828125,4.20691015625,4.20617578125,4.20566015625,4.2051171875,4.199109375,4.20054296875,4.19573046875,4.19511328125,4.19466015625,4.1915859375,4.190609375,4.18851171875,4.18603125,4.1866171875,4.1823828125,4.1841171875,4.17944140625,4.18012890625,4.17614453125,4.17441015625,4.1732734375,4.171921875,4.1710234375,4.16890625,4.16660546875,4.1675703125,4.16252734375,4.161875,4.16170703125,4.159328125,4.15687890625,4.15765625,4.1536953125,4.15349609375,4.151734375,4.15009765625,4.15083203125,4.1477578125,4.14693359375,4.14521484375,4.14371875,4.140640625,4.1391875,4.1400859375,4.13821875,4.136171875,4.1346953125,4.13290234375,4.13382421875,4.1321171875,4.127845703125,4.12960546875,4.1271328125,4.124853515625,4.126546875,4.12116015625,4.118875,4.1194375,4.11716796875,4.117326171875,4.11452734375,4.11478515625,4.11265625,4.1118515625,4.110716796875,4.10695703125,4.105974609375,4.1069453125,4.1039609375,4.104115234375,4.10241796875,4.10298046875,4.100599609375,4.09512890625,4.09860546875,4.094466796875,4.09503515625,4.093646484375,4.08973828125,4.09240234375,4.09222265625,4.088080078125,4.08678515625,4.085791015625,4.082439453125,4.082064453125,4.08147265625,4.080451171875,4.08063671875,4.07994921875,4.07630078125,4.07576953125,4.074875,4.07455078125,4.073796875,4.071392578125,4.072060546875,4.06762890625,4.066365234375,4.0654765625,4.064796875,4.06455078125,4.0633359375,4.061970703125,4.060384765625,4.0594140625,4.059236328125,4.057814453125,4.056111328125,4.05688671875,4.055232421875,4.05441015625,4.052625,4.05313671875,4.05051171875,4.049529296875,4.0474765625,4.04734765625,4.046658203125,4.04436328125,4.0429375,4.044142578125,4.04340234375,4.039486328125,4.0435625,4.04140234375,4.0408046875,4.0386015625,4.0380625,4.037591796875,4.032896484375,4.0354765625,4.035083984375,4.03198828125,4.032712890625,4.030740234375,4.02956640625,4.029828125,4.0271875,4.025908203125,4.0264765625,4.024916015625,4.02585546875,4.024517578125,4.024865234375,4.02329296875,4.022279296875,4.021298828125,4.021123046875,4.021474609375,4.02086328125,4.01965234375,4.01898046875,4.01805859375,4.017619140625,4.01712109375,4.015287109375,4.01531640625,4.016392578125,4.014390625,4.013958984375,4.0118671875,4.0142265625,4.01219140625,4.011998046875,4.011248046875,4.010705078125,4.01103125,4.01233984375,4.008513671875,4.01001953125,4.00755078125,4.008427734375,4.00748046875,4.006416015625,4.007978515625,4.005435546875,4.00546875,4.00516015625,4.00378515625,4.00555859375,4.0049765625,4.005669921875,4.005052734375,4.002826171875,4.003580078125,4.002212890625,4.00363671875,4.001841796875,4.00212890625,4.003541015625,4.002578125,4.0037109375,4.00257421875],"type":"scatter"},{"name":"Mixture of Tokens","x":[0.0,0.1102025,0.22032138888888889,0.33063944444444443,0.4408547222222222,0.55116,0.6615341666666668,0.7717666666666667,0.8822316666666667,0.9925736111111111,1.1029411111111111,1.2137411111111112,1.324238888888889,1.4347152777777779,1.5451597222222222,1.655526388888889,1.765925,1.8763033333333334,1.9867336111111111,2.0971166666666665,2.2076133333333336,2.318064166666667,2.4284366666666664,2.5388622222222224,2.6492127777777776,2.7596202777777776,2.870053333333333,2.9804244444444445,3.0908752777777777,3.201222222222222,3.311739166666667,3.4221605555555556,3.532686388888889,3.643100555555556,3.7536358333333335,3.8640230555555557,3.974463611111111,4.084901111111111,4.195413333333333,4.305719722222222,4.416119722222223,4.526548611111111,4.636904722222222,4.7472297222222215,4.8576258333333335,4.967887777777778,5.078225277777778,5.188641388888889,5.298884722222223,5.409263055555556,5.519609444444445,5.629938888888889,5.740241944444445,5.850555277777778,5.960919722222223,6.0711772222222224,6.181602222222223,6.291845555555556,6.402167222222222,6.512474444444444,6.622768333333333,6.732979444444444,6.843288055555555,6.843288055555555,6.953314722222222,7.063289722222223,7.173268055555557,7.283314166666667,7.3932725,7.503346666666667,7.613356111111111,7.723425000000001,7.833574722222222,7.9436550000000015,8.053704999999999,8.163783055555555,8.273855833333334,8.383854722222223,8.49399611111111,8.604089722222222,8.71408138888889,8.824217500000001,8.934220833333333,9.044411666666665,9.154599166666667,9.264683611111112,9.374765277777778,9.4850125,9.595071111111112,9.705115000000001,9.815252222222224,9.925120833333335,10.035108055555556,10.1452525,10.255217777777778,10.365317500000002,10.475235,10.585409166666667,10.695249722222224,10.80515611111111,10.9150025,11.024954722222223,11.135028333333333,11.245003333333335,11.354947222222224,11.465120555555556,11.575130833333333,11.685120555555557,11.79513388888889,11.905186944444445,12.015026111111112,12.124869722222224,12.235156111111111,12.345049444444445,12.454888055555555,12.564795555555555,12.674625277777777,12.784670833333333,12.894639722222223,13.004474444444444,13.114481666666666,13.224713611111113,13.3347425,13.444596944444443,13.554369722222223,13.66424277777778,13.774108611111112,13.884061666666668,13.994094722222222,14.103895277777777,14.213770555555556,14.323564444444445,14.433430833333334,14.543593055555556,14.653517222222224,14.763287777777778,14.873133333333334,14.983110833333333,15.093224166666669,15.202986111111112,15.312870277777776,15.422733055555554,15.53278277777778,15.64267638888889,15.752639444444444,15.862639444444444,15.972501944444442,16.082318333333333,16.19223777777778,16.302058055555555,16.412016944444446,16.521855277777778,16.631579444444444,16.741500000000002,16.85148388888889,16.961374444444445,17.07116388888889,17.181066666666666,17.290792777777778,17.40053888888889,17.510147222222223,17.619923611111112,17.72970972222222,17.83961888888889,17.949476944444445,18.05931222222222,18.168992222222222,18.279121666666665,18.388841944444444,18.498518611111113,18.60816916666667,18.71802361111111,18.827864722222223,18.937888333333337,19.047698333333333,19.15737777777778,19.267007222222222,19.376971944444442,19.486947777777775,19.59681972222222,19.70655277777778,19.816338055555555,19.92609361111111,20.035820277777777,20.145579722222223,20.255375833333332,20.365146666666668,20.47489638888889,20.58456638888889,20.694322222222223,20.80390611111111,20.913588055555557,21.023211944444444,21.132928055555556,21.2426775,21.352590833333334,21.462215277777776,21.571809722222223,21.68151138888889,21.79109777777778,21.90075555555556,22.010525833333336,22.12054277777778,22.230148888888888,22.339839444444443,22.449536666666667,22.55939138888889,22.669127222222222,22.778843333333334,22.888418333333334,22.998050833333334,23.107671111111113,23.21736416666667,23.32705888888889,23.436874444444445,23.54648666666667,23.6560725,23.765639999999998,23.87541388888889,23.985128888888887,24.09484,24.204535000000003,24.314268888888886,24.423895555555553,24.533535,24.643296111111113,24.753114444444446,24.862688333333335,24.9724975,25.082420000000003,25.192441666666667,25.302096388888888,25.41210277777778,25.521807222222222,25.631496388888888,25.741141111111112,25.85082,25.9608,26.070731944444447,26.180374722222222,26.29001638888889,26.399621111111113,26.509409444444444,26.619260555555556,26.728955000000003,26.838776388888892,26.948435833333335,27.058179166666665,27.168012500000003,27.27768888888889],"y":[6.865790036678314,5.500211125850678,5.061204619407654,4.781460484981537,4.641498310565948,4.555344714164734,4.490929737091064,4.443757008075714,4.405196396350861,4.37313479423523,4.344426648139954,4.323108457088471,4.299607085704803,4.279431181430817,4.263306029796601,4.247776464939117,4.234482085704803,4.221364744663239,4.2098522415161135,4.196074651241302,4.187593363761902,4.177408302307129,4.170638454437256,4.159920306205749,4.15081564617157,4.145412252902984,4.139124257087707,4.131852756023407,4.123324332237243,4.11731966304779,4.113346085071564,4.107695070266724,4.101226757526398,4.098156608104706,4.091862853527069,4.088939291715622,4.08453405046463,4.080003803968429,4.07474255156517,4.069562127351761,4.0672049102783205,4.064178363561631,4.0609314668178556,4.056524780988693,4.053007598161697,4.047103298664093,4.043819102048874,4.0414996073246,4.038083200454712,4.03592233991623,4.032123554468155,4.029180178403855,4.027229268789291,4.024126539945603,4.02128267121315,4.018775345087051,4.0136179099082945,4.012527460336686,4.011893786191941,4.0094586644172665,4.003874507665635,4.00408109164238,3.9995777270793913,3.997126739740372,3.9969446184635165,3.9934199278354643,3.9913556628227234,3.9893966519832613,3.9867340905666353,3.986563229560852,3.9814727687835694,3.9834299783706664,3.978228116750717,3.9784797337055204,3.974903697013855,3.972870152950287,3.9708729276657104,3.9691721091270447,3.9676777884960175,3.9655341460704805,3.962736085653305,3.9628406882286074,3.958150596380234,3.9572064304351806,3.9572911744117736,3.9544747989177704,3.9525790514945984,3.9521092398166657,3.9483649508953094,3.948203722476959,3.945921738624573,3.9438791739940644,3.9440752167701723,3.942056930065155,3.9397456793785097,3.938746748685837,3.937531670331955,3.9344002854824067,3.931611962556839,3.932666870355606,3.9304284567832948,3.9282506439685823,3.9271608049869537,3.9252567477226257,3.9263192043304445,3.9234907367229463,3.9210682899951936,3.921439744234085,3.919512340307236,3.916478786468506,3.918222924232483,3.912615067720413,3.909725915670395,3.91176522898674,3.9081051626205445,3.9083814005851747,3.9069166042804717,3.9061199796199797,3.9035818481445315,3.903709605693817,3.9023211553096773,3.8991231470108034,3.89718363571167,3.899226724386215,3.8953543226718903,3.8952864673137664,3.8937351932525637,3.8945165870189666,3.8917897469997405,3.8874791808128357,3.889599235296249,3.886183403491974,3.8874019949436187,3.885254539966583,3.881638179540634,3.884223243713379,3.883069363594055,3.880081481218338,3.878324861049652,3.8768155725002287,3.8742032346725463,3.8739651515483855,3.873274619817734,3.8733756947517395,3.8730960862636565,3.8718043982982637,3.8683799533843994,3.8676790974140167,3.8672288568019866,3.8673909361362457,3.8659597504138947,3.863656238079071,3.8642505462169647,3.8606404564380647,3.858939951658249,3.858395966768265,3.8568559811115266,3.8574499735832215,3.855578766822815,3.8548514432907104,3.8535311052799224,3.852460629701614,3.8520446791648864,3.850679286956787,3.849676181077957,3.8503636083602903,3.8481787927150726,3.847291652441025,3.846029278039932,3.8467375905513763,3.843457180738449,3.8432434759140013,3.84123197722435,3.8409913368225097,3.8404709768295286,3.838491157054901,3.8369598042964936,3.8380221192836763,3.8370410463809965,3.833674565553665,3.837532728433609,3.8359467537403105,3.834789340496063,3.8331626744270326,3.832846212863922,3.831990896940231,3.8268260090351105,3.8300914266109465,3.8295945544242858,3.8270066785812378,3.8272946214675905,3.825755661725998,3.8243437113761902,3.8244080152511595,3.8222766811847686,3.820967532634735,3.8215505781173706,3.820350860118866,3.8214788076877593,3.8193533620834352,3.819955214738846,3.8186098570823668,3.8177401185035706,3.817552139997482,3.816974099159241,3.817406270503998,3.8170814564228057,3.8157693605422973,3.8148661241531374,3.814633913755417,3.8133696205615997,3.813557290315628,3.81179550242424,3.811197649717331,3.812590065956116,3.810574800014496,3.811046081781387,3.808258488416672,3.810983619213104,3.808893218278885,3.8086019842624665,3.8076923871040345,3.8071739885807037,3.8074519782066347,3.8087132613658907,3.8052890610694887,3.806961742401123,3.8044023671150207,3.80590287733078,3.8039762332439424,3.8035476679801943,3.8046592409610747,3.8024042971134184,3.802197088241577,3.801558027267456,3.8005723276138306,3.8025530395507814,3.8023419806957244,3.802598600387573,3.8017730872631073,3.7998546545505523,3.8000860295295715,3.7992646408081057,3.8004151334762573,3.7985526072978972,3.798954046010971,3.800132167816162,3.799162902355194,3.8003664946556093,3.798871917963028],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"text":"Training Loss vs Time","x":0.5},"shapes":[{"line":{"color":"red","dash":"dot","width":0.5},"type":"line","x0":61000.0,"x1":250000.0,"y0":4.00257421875,"y1":4.00257421875},{"line":{"color":"red","dash":"dot","width":0.5},"type":"line","x0":6.622768333333333,"x1":21.883115000000004,"y0":4.00257421875,"y1":4.00257421875}],"annotations":[{"arrowcolor":"black","arrowhead":3,"arrowwidth":0.5,"ax":0.0,"ay":50,"font":{"color":"black","size":11},"showarrow":true,"text":"24% of training steps","x":117700.0,"y":4.00257421875},{"arrowcolor":"black","arrowhead":3,"arrowwidth":0.5,"ax":0.0,"ay":50,"font":{"color":"black","size":11},"showarrow":true,"text":"33% of training time","x":11.200872333333333,"y":4.00257421875}],"xaxis":{"range":[0,21.88],"title":{"text":"time (hours)"}},"yaxis":{"range":[3.5,5],"title":{"text":"loss"}}},                        {"responsive": true}                    )                };                            </script>        </div>

<div style="text-align: center;margin-bottom: 40px; margin-left: 30px;margin-right: 30px; opacity:0.7;"> If we measure actual training time, the final dense model's loss is achieved in only 33% of time.

</div>



</section>
</section>
<section id="next-steps" class="level1">
<h1>Next steps</h1>
<section id="scaling-up" class="level2">
<h2 class="anchored" data-anchor-id="scaling-up">Scaling Up</h2>
<p>Our preliminary experiments suggest that Mixture of Tokens might work even better for larger model sizes. In upcoming weeks we aim to prepare a comprehensive comparison of larger models and compare them to Mixture of Experts methods.</p>
</section>
<section id="from-mixture-of-tokens-to-mixture-of-experts" class="level2">
<h2 class="anchored" data-anchor-id="from-mixture-of-tokens-to-mixture-of-experts">From Mixture of Tokens to Mixture of Experts</h2>
<p>How do we get from MoT to MoE? Assume that the controller in a Mixture of Tokens layer decided to mix in a very particular way: for a given group, it concentrated the entire weight on just one token. In this extreme case, each expert would receive a single, unmixed token. This would make the Mixture of Tokens forward pass equivalent to the Expert Choice described in <a href="#sec-back">Background</a>.</p>
<p>This scenario has its advantages: in the default Mixture of Tokens setup for autoregressive training, tokens are aggregated across the batch dimension. However, during decoding, this setup allows for information to be exchanged between different examples. This could be undesirable in some use cases, e.g.&nbsp;when different examples in the same batch come from different users in the industry setting, possibly with privacy issues.</p>
<p>How could we make the controller focus on a single example? One can achieve this by adding a temperature parameter to the softmax operation used by the controller. Low temperature forces the weight distribution to concentrate - in the limit (as temperature approaches 0) causing the weights to focus exclusively on the token with the highest controller score.</p>


<meta charset="utf-8">     <link rel="stylesheet" type="text/css" href="styles.css">

<div style="display: flex; justify-content: center; margin-top: 10px;margin-bottom: 10px;">

    <div>                            <div id="43772678-6f7b-4480-8495-2681146f30b0" class="plotly-graph-div" style="height:500px; width:600px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("43772678-6f7b-4480-8495-2681146f30b0")) {                    Plotly.newPlot(                        "43772678-6f7b-4480-8495-2681146f30b0",                        [{"name":"m = -2.0","visible":false,"width":1,"x":[0,1,2,3,4],"y":[2.3585902325762717e-10,3.8166188062950703e-7,0.0006175968555866627,0.9993816395847932,3.8166188062950703e-7],"type":"bar"},{"name":"m = -1.9","visible":false,"width":1,"x":[0,1,2,3,4],"y":[1.943191600192735e-9,1.556548607805128e-6,0.0012468371972273768,0.9987500477623653,1.556548607805128e-6],"type":"bar"},{"name":"m = -1.7999999999999998","visible":false,"width":1,"x":[0,1,2,3,4],"y":[1.3091411623662016e-8,5.55028123468243e-6,0.002353116888356672,0.9976357694577622,5.55028123468243e-6],"type":"bar"},{"name":"m = -1.6999999999999997","visible":false,"width":1,"x":[0,1,2,3,4],"y":[7.349391967491945e-8,0.000017520905886650827,0.004176973339382746,0.9957879113549243,0.000017520905886650827],"type":"bar"},{"name":"m = -1.5999999999999996","visible":false,"width":1,"x":[0,1,2,3,4],"y":[3.496847495862724e-7,0.0000495166599967827,0.007011743063253207,0.9928888739320035,0.0000495166599967827],"type":"bar"},{"name":"m = -1.4999999999999996","visible":false,"width":1,"x":[0,1,2,3,4],"y":[1.4318080650933487e-6,0.00012654868517082558,0.011184857879272153,0.9885606129423211,0.00012654868517082558],"type":"bar"},{"name":"m = -1.3999999999999995","visible":false,"width":1,"x":[0,1,2,3,4],"y":[5.114765880859076e-6,0.00029510510886228343,0.017026590718946626,0.9823780842974481,0.00029510510886228343],"type":"bar"},{"name":"m = -1.2999999999999994","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.000016137774660346915,0.0006329930506533397,0.02482871465295376,0.9738891614710792,0.0006329930506533397],"type":"bar"},{"name":"m = -1.1999999999999993","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.00004547144976937645,0.0012579033099242266,0.03479811497420013,0.962640606956182,0.0012579033099242266],"type":"bar"},{"name":"m = -1.0999999999999992","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.00011556504767715092,0.002330876319713249,0.04701234955553234,0.948210332757364,0.002330876319713249],"type":"bar"},{"name":"m = -0.9999999999999991","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.00026729665063827116,0.004050683540041418,0.06138512062303107,0.9302462156462477,0.004050683540041418],"type":"bar"},{"name":"m = -0.899999999999999","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.0005672227592177564,0.006636600982175805,0.07764933948940547,0.9085102357870252,0.006636600982175805],"type":"bar"},{"name":"m = -0.7999999999999989","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.0011125067914550372,0.010300132592497829,0.0953636707999584,0.882923557223591,0.010300132592497829],"type":"bar"},{"name":"m = -0.6999999999999988","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.0020303532205375166,0.015210142661061118,0.11394492220845391,0.8536044392488862,0.015210142661061118],"type":"bar"},{"name":"m = -0.5999999999999988","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.0034695712153256235,0.021459121884230246,0.1327235797922746,0.8208886052239392,0.021459121884230246],"type":"bar"},{"name":"m = -0.49999999999999867","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.005584144286925808,0.029039369409604898,0.15101418093402152,0.7853229359598429,0.029039369409604898],"type":"bar"},{"name":"m = -0.3999999999999986","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.008511621434038682,0.03783585336747395,0.16818790769054828,0.747628764140465,0.03783585336747395],"type":"bar"},{"name":"m = -0.2999999999999985","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.012351406053967876,0.047637902466797034,0.1837337175638424,0.7086390714485957,0.047637902466797034],"type":"bar"},{"name":"m = -0.1999999999999984","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.01714842734010911,0.05816647903920825,0.19729735075502997,0.6692212638264443,0.05816647903920825],"type":"bar"},{"name":"m = -0.09999999999999831","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.022886005934507046,0.06910980021538267,0.20869366631635392,0.6302007273183737,0.06910980021538267],"type":"bar"},{"name":"m = 1.7763568394002505e-15","visible":true,"width":1,"x":[0,1,2,3,4],"y":[0.029488820138600456,0.08015892392545462,0.21789454629539393,0.5922987857150964,0.08015892392545462],"type":"bar"},{"name":"m = 0.10000000000000187","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.0368340871603731,0.09103655380344557,0.22499957966444933,0.5560932255682864,0.09103655380344557],"type":"bar"},{"name":"m = 0.20000000000000195","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.044767432875180126,0.10151551900506973,0.23019860503509407,0.5220029240795863,0.10151551900506973],"type":"bar"},{"name":"m = 0.30000000000000204","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.05311971506147246,0.11142663160256953,0.23373420237526757,0.4902928193581208,0.11142663160256953],"type":"bar"},{"name":"m = 0.40000000000000213","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.06172191363389667,0.1206578770208364,0.23586960335559146,0.461092728968839,0.1206578770208364],"type":"bar"},{"name":"m = 0.5000000000000022","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.07041647569924682,0.12914785687335442,0.2368645799062455,0.4344232306477987,0.12914785687335442],"type":"bar"},{"name":"m = 0.6000000000000023","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.07906467785034012,0.13687633590636492,0.23695956071073077,0.41022308962619936,0.13687633590636492],"type":"bar"},{"name":"m = 0.7000000000000024","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.08755037633621836,0.1438541100036119,0.23636683051435903,0.38837457314219903,0.1438541100036119],"type":"bar"},{"name":"m = 0.8000000000000025","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.09578092148037771,0.15011362086423077,0.23526709516557004,0.3687247416255908,0.15011362086423077],"type":"bar"},{"name":"m = 0.9000000000000026","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.10368610751011462,0.15570104616453603,0.23380968153680654,0.3511021186240068,0.15570104616453603],"type":"bar"},{"name":"m = 1.0000000000000027","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.11121593818431469,0.1606700915269281,0.23211491745445031,0.3353289613073789,0.1606700915269281],"type":"bar"},{"name":"m = 1.1000000000000028","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.11833781801329532,0.16507740456772885,0.2302776065699979,0.3212297662812491,0.16507740456772885],"type":"bar"},{"name":"m = 1.2000000000000028","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.12503359736371555,0.1689793793857502,0.22837086398891054,0.3086367798758735,0.1689793793857502],"type":"bar"},{"name":"m = 1.300000000000003","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.13129674272376315,0.17243007054645032,0.22644986167865283,0.29739325450468335,0.17243007054645032],"type":"bar"},{"name":"m = 1.400000000000003","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.13712978317849456,0.1754799451652688,0.22455523841326183,0.2873550880777061,0.1754799451652688],"type":"bar"},{"name":"m = 1.500000000000003","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.14254210011149576,0.17817523914922867,0.2227160664887983,0.2783913551012487,0.17817523914922867],"type":"bar"},{"name":"m = 1.6000000000000032","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.14754807306483136,0.18055772987830773,0.2209523522850976,0.2703841148934556,0.18055772987830773],"type":"bar"},{"name":"m = 1.7000000000000033","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.15216556294246605,0.1826647822365077,0.21927709544982035,0.2632277771346982,0.1826647822365077],"type":"bar"},{"name":"m = 1.8000000000000034","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.1564146974232201,0.18452956327769168,0.21769795476010462,0.2568282212612919,0.18452956327769168],"type":"bar"},{"name":"m = 1.9000000000000035","visible":false,"width":1,"x":[0,1,2,3,4],"y":[0.16031691709057636,0.18618135158260915,0.21621857696741278,0.2511018027767926,0.18618135158260915],"type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"yaxis":{"range":[0,1]},"title":{"text":"Effects of temperature on the weight distribution","y":0.9,"x":0.5,"xanchor":"center","yanchor":"top"},"xaxis":{"showticklabels":false},"sliders":[{"active":20,"pad":{"t":50},"steps":[{"args":[{"visible":[true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.14"}],"label":"","method":"update"},{"args":[{"visible":[false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.15"}],"label":"","method":"update"},{"args":[{"visible":[false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.17"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.18"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.2"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.22"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.25"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.27"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.3"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.33"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.37"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.41"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.45"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.5"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.55"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.61"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.67"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.74"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.82"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 0.9"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 1.0"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 1.11"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 1.22"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 1.35"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 1.49"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 1.65"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 1.82"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 2.01"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 2.23"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 2.46"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false]},{"title":"Temperature: 2.72"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false]},{"title":"Temperature: 3.0"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false]},{"title":"Temperature: 3.32"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false]},{"title":"Temperature: 3.67"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false]},{"title":"Temperature: 4.06"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false]},{"title":"Temperature: 4.48"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false]},{"title":"Temperature: 4.95"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false]},{"title":"Temperature: 5.47"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false]},{"title":"Temperature: 6.05"}],"label":"","method":"update"},{"args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true]},{"title":"Temperature: 6.69"}],"label":"","method":"update"}],"tickcolor":"white"}],"bargap":0,"autosize":false,"width":600,"height":500},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
<div style="text-align: center;margin-bottom: 40px; margin-left: 30px;margin-right: 30px; opacity:0.7; "> Decreasing the temperature to 0 results in a weight concentration, while increasing it causes the weights to become more uniform.
</div>


<p>Interestingly, simply allowing the temperature parameter to be learnable for the controller in a Mixture of Tokens layer encourages this phenomenon.</p>

<meta charset="utf-8">

    <div>                            <div id="ca473683-e6d3-4635-927f-2d62f2fe3141" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("ca473683-e6d3-4635-927f-2d62f2fe3141")) {                    Plotly.newPlot(                        "ca473683-e6d3-4635-927f-2d62f2fe3141",                        [{"legendwidth":3,"name":" layer 0","x":[1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,11000.0,12000.0,13000.0,14000.0,15000.0,16000.0,17000.0,18000.0,19000.0,20000.0,21000.0,22000.0,23000.0,24000.0,25000.0,26000.0,27000.0,28000.0,29000.0,30000.0,31000.0,32000.0,33000.0,34000.0,35000.0,36000.0,37000.0,38000.0,39000.0,40000.0,41000.0,42000.0,43000.0,44000.0,45000.0,46000.0,47000.0,48000.0,49000.0,50000.0,51000.0,52000.0,53000.0,54000.0,55000.0,56000.0,57000.0,58000.0,59000.0,60000.0,61000.0,62000.0,63000.0,64000.0,65000.0,66000.0,67000.0,68000.0,69000.0,70000.0,71000.0,72000.0,73000.0,74000.0,75000.0,76000.0,77000.0,78000.0,79000.0,80000.0,81000.0,82000.0,83000.0,84000.0,85000.0,86000.0,87000.0,88000.0,89000.0,90000.0,91000.0,92000.0,93000.0,94000.0,95000.0,96000.0,97000.0,98000.0,99000.0,100000.0],"y":[0.08900570869445801,0.30222105979919434,0.3811308443546295,0.42427685856819153,0.4414798319339752,0.4382210373878479,0.4101978838443756,0.3460236191749573,0.2557637095451355,0.15760314464569092,0.0719526931643486,-0.01615685410797596,-0.08970662206411362,-0.15294472873210907,-0.21539010107517242,-0.27438679337501526,-0.3267332911491394,-0.37629324197769165,-0.42226120829582214,-0.4651094675064087,-0.5071684122085571,-0.5400383472442627,-0.5758959054946899,-0.6062338352203369,-0.6347663402557373,-0.6631847023963928,-0.6872196197509766,-0.7156113982200623,-0.7369757890701294,-0.7572553753852844,-0.7751361727714539,-0.7917455434799194,-0.8077942728996277,-0.8287920355796814,-0.8399633765220642,-0.8517056107521057,-0.8654342293739319,-0.8831998705863953,-0.8977015018463135,-0.8982211351394653,-0.9133849143981934,-0.9247669577598572,-0.9290046691894531,-0.9379158020019531,-0.9521044492721558,-0.9481417536735535,-0.9571996927261353,-0.965322732925415,-0.9671446084976196,-0.9750908613204956,-0.9907655715942383,-0.9956114292144775,-1.0021411180496216,-1.0038506984710693,-1.012423038482666,-1.0168449878692627,-1.0213584899902344,-1.0255051851272583,-1.0264008045196533,-1.032080888748169,-1.0278189182281494,-1.0379126071929932,-1.0382238626480103,-1.0399909019470215,-1.0434600114822388,-1.0404486656188965,-1.0412970781326294,-1.0395735502243042,-1.0458600521087646,-1.0563063621520996,-1.0585217475891113,-1.0632396936416626,-1.0661834478378296,-1.0610371828079224,-1.0650993585586548,-1.0665242671966553,-1.073858380317688,-1.0747954845428467,-1.0737131834030151,-1.084474802017212,-1.0794130563735962,-1.0748109817504883,-1.0795133113861084,-1.0782920122146606,-1.0833700895309448,-1.0834002494812012,-1.0812615156173706,-1.0918382406234741,-1.0910539627075195,-1.0905370712280273,-1.0968012809753418,-1.0990537405014038,-1.1021212339401245,-1.0957667827606201,-1.088361144065857,-1.0966511964797974,-1.099544882774353,-1.1015686988830566,-1.0994398593902588,-1.0994353294372559],"type":"scatter"},{"legendwidth":3,"name":" layer 1","x":[1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,11000.0,12000.0,13000.0,14000.0,15000.0,16000.0,17000.0,18000.0,19000.0,20000.0,21000.0,22000.0,23000.0,24000.0,25000.0,26000.0,27000.0,28000.0,29000.0,30000.0,31000.0,32000.0,33000.0,34000.0,35000.0,36000.0,37000.0,38000.0,39000.0,40000.0,41000.0,42000.0,43000.0,44000.0,45000.0,46000.0,47000.0,48000.0,49000.0,50000.0,51000.0,52000.0,53000.0,54000.0,55000.0,56000.0,57000.0,58000.0,59000.0,60000.0,61000.0,62000.0,63000.0,64000.0,65000.0,66000.0,67000.0,68000.0,69000.0,70000.0,71000.0,72000.0,73000.0,74000.0,75000.0,76000.0,77000.0,78000.0,79000.0,80000.0,81000.0,82000.0,83000.0,84000.0,85000.0,86000.0,87000.0,88000.0,89000.0,90000.0,91000.0,92000.0,93000.0,94000.0,95000.0,96000.0,97000.0,98000.0,99000.0,100000.0],"y":[0.04430804029107094,0.07556591928005219,0.03727312013506889,-0.17955711483955383,-0.39200910925865173,-0.577592134475708,-0.7377877235412598,-0.8926605582237244,-1.0284143686294556,-1.1577558517456055,-1.266943335533142,-1.3632005453109741,-1.4470916986465454,-1.529073715209961,-1.6035685539245605,-1.671685814857483,-1.7263591289520264,-1.7867765426635742,-1.834466814994812,-1.8787566423416138,-1.9272512197494507,-1.962210774421692,-1.9980204105377197,-2.025101661682129,-2.058443069458008,-2.0937564373016357,-2.11991024017334,-2.1421642303466797,-2.1610889434814453,-2.184603214263916,-2.2065649032592773,-2.234058141708374,-2.248163938522339,-2.268674373626709,-2.274939775466919,-2.2785046100616455,-2.3100621700286865,-2.3111989498138428,-2.3334453105926514,-2.3527650833129883,-2.354788064956665,-2.377499580383301,-2.3844947814941406,-2.401156187057495,-2.4172239303588867,-2.42590594291687,-2.4324004650115967,-2.4487907886505127,-2.4608154296875,-2.470615863800049,-2.4711945056915283,-2.4911580085754395,-2.5097906589508057,-2.497159481048584,-2.510054111480713,-2.517538547515869,-2.5323336124420166,-2.5396342277526855,-2.5453195571899414,-2.5614376068115234,-2.5700926780700684,-2.574227809906006,-2.588808059692383,-2.58137583732605,-2.611001968383789,-2.610201358795166,-2.6244003772735596,-2.6136326789855957,-2.613724708557129,-2.6303257942199707,-2.6615545749664307,-2.6521832942962646,-2.668638229370117,-2.6899335384368896,-2.6853623390197754,-2.6881518363952637,-2.688436508178711,-2.704071521759033,-2.722116470336914,-2.7124338150024414,-2.7238430976867676,-2.7167398929595947,-2.723619222640991,-2.7396695613861084,-2.7434048652648926,-2.7422115802764893,-2.7495739459991455,-2.7560224533081055,-2.768157720565796,-2.771907091140747,-2.782127618789673,-2.7798714637756348,-2.783444404602051,-2.778143882751465,-2.7967851161956787,-2.802999973297119,-2.8055689334869385,-2.8032891750335693,-2.816715717315674,-2.8325188159942627],"type":"scatter"},{"legendwidth":3,"name":" layer 2","x":[1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,11000.0,12000.0,13000.0,14000.0,15000.0,16000.0,17000.0,18000.0,19000.0,20000.0,21000.0,22000.0,23000.0,24000.0,25000.0,26000.0,27000.0,28000.0,29000.0,30000.0,31000.0,32000.0,33000.0,34000.0,35000.0,36000.0,37000.0,38000.0,39000.0,40000.0,41000.0,42000.0,43000.0,44000.0,45000.0,46000.0,47000.0,48000.0,49000.0,50000.0,51000.0,52000.0,53000.0,54000.0,55000.0,56000.0,57000.0,58000.0,59000.0,60000.0,61000.0,62000.0,63000.0,64000.0,65000.0,66000.0,67000.0,68000.0,69000.0,70000.0,71000.0,72000.0,73000.0,74000.0,75000.0,76000.0,77000.0,78000.0,79000.0,80000.0,81000.0,82000.0,83000.0,84000.0,85000.0,86000.0,87000.0,88000.0,89000.0,90000.0,91000.0,92000.0,93000.0,94000.0,95000.0,96000.0,97000.0,98000.0,99000.0,100000.0],"y":[0.04487866908311844,0.1263405978679657,0.1312984824180603,0.03210868686437607,-0.12854929268360138,-0.3027312159538269,-0.4856831729412079,-0.6652482151985168,-0.8374553918838501,-0.9889509081840515,-1.1240792274475098,-1.2564611434936523,-1.381625771522522,-1.4847389459609985,-1.5951358079910278,-1.6872977018356323,-1.7961817979812622,-1.8881728649139404,-1.988033413887024,-2.0823311805725098,-2.1968941688537598,-2.2985990047454834,-2.3799922466278076,-2.4911341667175293,-2.593071699142456,-2.7220778465270996,-2.824535846710205,-2.9363038539886475,-3.0486669540405273,-3.1487998962402344,-3.225821018218994,-3.3339591026306152,-3.4138052463531494,-3.471637725830078,-3.54024338722229,-3.595097780227661,-3.684210777282715,-3.7040534019470215,-3.7579660415649414,-3.8077383041381836,-3.84244441986084,-3.8759944438934326,-3.9095370769500732,-3.953354597091675,-3.995727062225342,-4.02662992477417,-4.03870153427124,-4.076952934265137,-4.080837249755859,-4.108806610107422,-4.128809928894043,-4.145481586456299,-4.153382301330566,-4.175668716430664,-4.197953224182129,-4.19615364074707,-4.215184211730957,-4.238047122955322,-4.236061096191406,-4.260715007781982,-4.279820442199707,-4.301680088043213,-4.309135913848877,-4.350719451904297,-4.361852645874023,-4.36381721496582,-4.369556427001953,-4.385476112365723,-4.403065204620361,-4.407578945159912,-4.403848171234131,-4.430674076080322,-4.42336368560791,-4.434772968292236,-4.4438276290893555,-4.46500825881958,-4.461613178253174,-4.48953104019165,-4.497055530548096,-4.504618167877197,-4.519876003265381,-4.525937080383301,-4.540170669555664,-4.553900241851807,-4.570667743682861,-4.567363262176514,-4.586719036102295,-4.6000847816467285,-4.6108222007751465,-4.617687225341797,-4.608168125152588,-4.634494304656982,-4.643772125244141,-4.642448902130127,-4.646487712860107,-4.666088104248047,-4.677887439727783,-4.676239013671875,-4.688296794891357,-4.705937385559082],"type":"scatter"},{"legendwidth":3,"name":" layer 3","x":[1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,11000.0,12000.0,13000.0,14000.0,15000.0,16000.0,17000.0,18000.0,19000.0,20000.0,21000.0,22000.0,23000.0,24000.0,25000.0,26000.0,27000.0,28000.0,29000.0,30000.0,31000.0,32000.0,33000.0,34000.0,35000.0,36000.0,37000.0,38000.0,39000.0,40000.0,41000.0,42000.0,43000.0,44000.0,45000.0,46000.0,47000.0,48000.0,49000.0,50000.0,51000.0,52000.0,53000.0,54000.0,55000.0,56000.0,57000.0,58000.0,59000.0,60000.0,61000.0,62000.0,63000.0,64000.0,65000.0,66000.0,67000.0,68000.0,69000.0,70000.0,71000.0,72000.0,73000.0,74000.0,75000.0,76000.0,77000.0,78000.0,79000.0,80000.0,81000.0,82000.0,83000.0,84000.0,85000.0,86000.0,87000.0,88000.0,89000.0,90000.0,91000.0,92000.0,93000.0,94000.0,95000.0,96000.0,97000.0,98000.0,99000.0,100000.0],"y":[0.09433476626873016,0.25629952549934387,0.3717612028121948,0.4045041501522064,0.37035641074180603,0.27167797088623047,0.11321467161178589,-0.07791228592395782,-0.2755046486854553,-0.46445420384407043,-0.6424990296363831,-0.8004688024520874,-0.9534161686897278,-1.0863510370254517,-1.2134507894515991,-1.3254098892211914,-1.4336737394332886,-1.5420318841934204,-1.6373416185379028,-1.7180153131484985,-1.8259791135787964,-1.9156198501586914,-1.99811851978302,-2.0771491527557373,-2.1548798084259033,-2.221287488937378,-2.2968740463256836,-2.3733813762664795,-2.4474916458129883,-2.511726140975952,-2.5726499557495117,-2.641624689102173,-2.683645486831665,-2.7501251697540283,-2.7962937355041504,-2.853562831878662,-2.9126031398773193,-2.9638543128967285,-3.0103018283843994,-3.0406594276428223,-3.089019775390625,-3.122042417526245,-3.1566531658172607,-3.1904044151306152,-3.2227060794830322,-3.243476629257202,-3.283832311630249,-3.318957567214966,-3.342186689376831,-3.3680694103240967,-3.3946986198425293,-3.4034230709075928,-3.4327139854431152,-3.464843511581421,-3.4912033081054688,-3.5044827461242676,-3.5174927711486816,-3.5454368591308594,-3.5739243030548096,-3.584336996078491,-3.597644567489624,-3.6185975074768066,-3.638488292694092,-3.659519910812378,-3.674334764480591,-3.6951816082000732,-3.69903302192688,-3.708359956741333,-3.7273905277252197,-3.7363414764404297,-3.7627780437469482,-3.76949143409729,-3.7840442657470703,-3.792079448699951,-3.8098604679107666,-3.8224642276763916,-3.8237600326538086,-3.841094970703125,-3.8454315662384033,-3.8664379119873047,-3.872392416000366,-3.887895107269287,-3.8846755027770996,-3.903825044631958,-3.9203946590423584,-3.9296412467956543,-3.933441400527954,-3.943378448486328,-3.9630045890808105,-3.9658331871032715,-3.972343683242798,-3.9868881702423096,-3.9924256801605225,-3.998711585998535,-4.01833963394165,-4.026423931121826,-4.022006988525391,-4.038408279418945,-4.04371976852417,-4.05835485458374],"type":"scatter"}],                        {"template":{"data":{"scatter":[{"type":"scatter"}]}},"title":{"text":"Log Controller Temperature","x":0.5},"xaxis":{"range":[0,100000.0],"title":{"text":"training step"},"gridwidth":1,"linecolor":"white","gridcolor":"white","zerolinecolor":"white"},"yaxis":{"range":[-7,1],"title":{"text":"log temperature"},"gridwidth":1,"linecolor":"white","gridcolor":"white","zerolinecolor":"white"},"plot_bgcolor":"#E5ECF6"},                        {"responsive": true}                    )                };                            </script>        </div>


<p>As expected, this results in the controller focusing more on one token. We measured this by monitoring the entropy of weights produced by the controller (averaged over all token groups and all experts).</p>
<p><span class="SJ">SA: change naming “Controller Weights” suggest “controller parameters”. Rather it’d be “token weights” or “token importance scores”</span></p>

<meta charset="utf-8">

<div style="display: flex; justify-content: center; margin-top: 10px;margin-bottom: 10px;">
    <div>                            <div id="a8cc4f90-2b47-4934-b7b0-8c2b7f6fd578" class="plotly-graph-div" style="height:100%; width:1100px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a8cc4f90-2b47-4934-b7b0-8c2b7f6fd578")) {                    Plotly.newPlot(                        "a8cc4f90-2b47-4934-b7b0-8c2b7f6fd578",                        [{"legendgroup":"0","line":{"color":"#1f77b4"},"mode":"lines","name":" layer 0","showlegend":true,"x":[1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,11000.0,12000.0,13000.0,14000.0,15000.0,16000.0,17000.0,18000.0,19000.0,20000.0,21000.0,22000.0,23000.0,24000.0,25000.0,26000.0,27000.0,28000.0,29000.0,30000.0,31000.0,32000.0,33000.0,34000.0,35000.0,36000.0,37000.0,38000.0,39000.0,40000.0,41000.0,42000.0,43000.0,44000.0,45000.0,46000.0,47000.0,48000.0,49000.0,50000.0,51000.0,52000.0,53000.0,54000.0,55000.0,56000.0,57000.0,58000.0,59000.0,60000.0,61000.0,62000.0,63000.0,64000.0,65000.0,66000.0,67000.0,68000.0,69000.0,70000.0,71000.0,72000.0,73000.0,74000.0,75000.0,76000.0,77000.0,78000.0,79000.0,80000.0,81000.0,82000.0,83000.0,84000.0,85000.0,86000.0,87000.0,88000.0,89000.0,90000.0,91000.0,92000.0,93000.0,94000.0,95000.0,96000.0,97000.0,98000.0,99000.0,100000.0,101000.0],"y":[0.92165743496418,0.9537076325654984,0.9641520408630371,0.9707946148872375,0.9748303187131881,0.9772490072488785,0.9792727726221084,0.9803931768417359,0.9815029253959656,0.9809452077388764,0.9812650203943253,0.9809211638689042,0.9799649496793746,0.9803055855035782,0.9800663259506226,0.9794309798002243,0.9785979282617568,0.9779348073244095,0.9774929559230805,0.9772777146816254,0.9772291843891143,0.9765390749454498,0.9752409230470658,0.9747462890148163,0.9736543172121048,0.9738814332008362,0.9725726986408234,0.9729867669343948,0.9725049557209015,0.971193381512165,0.9700378065824509,0.972120799267292,0.9702390851020813,0.9693312009096146,0.9705306073665619,0.9687958587646485,0.9685319063425064,0.9682176224827767,0.9681972056150436,0.9683018844604492,0.9672884285211563,0.9655007892966271,0.9668098423957825,0.9658587105512619,0.9649084169149399,0.9650109154939651,0.9643661723136902,0.9643112291097641,0.9625832327723504,0.9634430497288704,0.9629028873562813,0.9611653248071671,0.9613701857089997,0.9607486838459969,0.9617892017006874,0.9611273327589035,0.9614785772919655,0.9613744383573533,0.960025037920475,0.9590885294675827,0.9589457839488983,0.9568801142811775,0.958223774266243,0.9586807201385498,0.9577963348984718,0.9578436374306679,0.954541852235794,0.9572062803983689,0.9582873189210892,0.954517337679863,0.956145688867569,0.954642564535141,0.956679963183403,0.9534107337117195,0.9545042137861252,0.9539822288274765,0.9531985828459263,0.954096318423748,0.9537069139003753,0.9547244686841965,0.9528305056095123,0.9524892906427384,0.9526572220802307,0.9507636413216591,0.9528706477046013,0.951709820073843,0.9508637555360794,0.9507011790513993,0.9524161209106445,0.9515883259534835,0.9491049999892711,0.9505788665294648,0.9486254699110985,0.9487330667257309,0.9499433557510376,0.9495876786828041,0.9483286616683007,0.9466950996160507,0.9473373399436474,0.9475804080843926,0.9464072032451629],"type":"scatter","xaxis":"x","yaxis":"y"},{"legendgroup":"1","line":{"color":"#ff7f0e"},"mode":"lines","name":" layer 1","showlegend":true,"x":[1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,11000.0,12000.0,13000.0,14000.0,15000.0,16000.0,17000.0,18000.0,19000.0,20000.0,21000.0,22000.0,23000.0,24000.0,25000.0,26000.0,27000.0,28000.0,29000.0,30000.0,31000.0,32000.0,33000.0,34000.0,35000.0,36000.0,37000.0,38000.0,39000.0,40000.0,41000.0,42000.0,43000.0,44000.0,45000.0,46000.0,47000.0,48000.0,49000.0,50000.0,51000.0,52000.0,53000.0,54000.0,55000.0,56000.0,57000.0,58000.0,59000.0,60000.0,61000.0,62000.0,63000.0,64000.0,65000.0,66000.0,67000.0,68000.0,69000.0,70000.0,71000.0,72000.0,73000.0,74000.0,75000.0,76000.0,77000.0,78000.0,79000.0,80000.0,81000.0,82000.0,83000.0,84000.0,85000.0,86000.0,87000.0,88000.0,89000.0,90000.0,91000.0,92000.0,93000.0,94000.0,95000.0,96000.0,97000.0,98000.0,99000.0,100000.0],"y":[0.8448272092223167,0.8217169033676386,0.8321842997014522,0.8321399267701433,0.8277010530701373,0.8165141468452756,0.8140942838557996,0.8121389493394643,0.8008707857378525,0.798304186603264,0.7835945077733719,0.7828037355650682,0.7833213209515205,0.7834315252395114,0.7780477473651175,0.7735495794006507,0.7638288771183055,0.7767243298908288,0.7691222990173731,0.7570353112551748,0.7560667943108798,0.757005366626769,0.7552742941594727,0.7483573015009221,0.7462340259422923,0.7458924244752568,0.7427659225831638,0.7379847318911125,0.743790123815689,0.7555631750343004,0.7327042521221862,0.73777696635631,0.7301552246783659,0.7332568694002563,0.7290530669171021,0.7221174256972445,0.736826236642812,0.7209475353189609,0.734492157463622,0.7256312675344075,0.7232308097283708,0.7187863171049105,0.7185497338263228,0.7367153626081594,0.7238405214633798,0.7149482413537176,0.7159919257308033,0.7121178625585975,0.7034054076721682,0.7034399343807074,0.7046593779982498,0.6986309523091809,0.7053715299483126,0.7030005521967072,0.7101364845934748,0.6999556888202049,0.702212187455371,0.6922109979403116,0.6991845773900535,0.701386817426171,0.6876890079641643,0.6985455523864684,0.6912573434411974,0.6823875464694888,0.6914654560182387,0.7020607347361297,0.6873143670311498,0.6830892979218166,0.6768999705660977,0.6731979591296078,0.6826270550779302,0.6751514521141379,0.6828046687322689,0.683308404654729,0.676021258819932,0.6735219463513533,0.6711647533092964,0.6766370332389774,0.6713873692686055,0.6677969265644766,0.6667771602909682,0.6612211314260283,0.6679332894531963,0.6618269348678301,0.6641376388928966,0.6546681990503103,0.6654422322223591,0.6606857070244463,0.6625996579640433,0.6567794547581776,0.6602965158752466,0.6662426366033551,0.6510068488170727,0.6552321177197268,0.6466896517605497,0.649204857083531,0.6516548634245714,0.6501904505805031,0.652594139582066,0.6440703149004332],"type":"scatter","xaxis":"x","yaxis":"y"},{"legendgroup":"2","line":{"color":"#2ca02c"},"mode":"lines","name":" layer 2","showlegend":true,"x":[1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,11000.0,12000.0,13000.0,14000.0,15000.0,16000.0,17000.0,18000.0,19000.0,20000.0,21000.0,22000.0,23000.0,24000.0,25000.0,26000.0,27000.0,28000.0,29000.0,30000.0,31000.0,32000.0,33000.0,34000.0,35000.0,36000.0,37000.0,38000.0,39000.0,40000.0,41000.0,42000.0,43000.0,44000.0,45000.0,46000.0,47000.0,48000.0,49000.0,50000.0,51000.0,52000.0,53000.0,54000.0,55000.0,56000.0,57000.0,58000.0,59000.0,60000.0,61000.0,62000.0,63000.0,64000.0,65000.0,66000.0,67000.0,68000.0,69000.0,70000.0,71000.0,72000.0,73000.0,74000.0,75000.0,76000.0,77000.0,78000.0,79000.0,80000.0,81000.0,82000.0,83000.0,84000.0,85000.0,86000.0,87000.0,88000.0,89000.0,90000.0,91000.0,92000.0,93000.0,94000.0,95000.0,96000.0,97000.0,98000.0,99000.0,100000.0],"y":[0.7722973927922547,0.6559462137325136,0.6024278965591217,0.5783895385667075,0.5621955046894126,0.5506525123587184,0.5409721347910406,0.5338979229996966,0.5368617843583885,0.5190026022517572,0.5134305426328434,0.5060884857210918,0.518810770077041,0.49110075017527505,0.4956903163003131,0.49474360413376545,0.48675325834151034,0.48556659509335587,0.4697376942115404,0.4865743593682002,0.47882299562338665,0.4792569794440712,0.46555240875286774,0.46497373569015615,0.4646032187173756,0.46470145772857085,0.45538281869678504,0.46286638315631007,0.4662515777544999,0.4540631524942215,0.4550174711688217,0.43897561420519304,0.4528349189855568,0.44318131597870886,0.42669746122772123,0.4400195694959104,0.444899121665287,0.4303240912695432,0.42693079242509274,0.4235818214914406,0.4336392187232322,0.43046187944936465,0.4280177757852112,0.4215140363999206,0.42682098182089356,0.4302369472071487,0.4155343790575401,0.4180437433848709,0.42323378063424133,0.42280214147695017,0.40719545923301104,0.41905898498646255,0.4275089533399723,0.4145953412683295,0.402781341942201,0.4054356300172953,0.3954028975425128,0.40434580647045576,0.4026036180235803,0.4152863758088458,0.40942632119558775,0.3952778430029658,0.40064779413035156,0.40965680569117274,0.40883196409891787,0.40187835575768854,0.3990027065511298,0.3871524942678703,0.39073980584160106,0.39246004926150124,0.38742225447444817,0.3825635109133685,0.3885848280523137,0.3886826888848933,0.39586437771303107,0.3718449005974511,0.37864103530392046,0.39716207392271047,0.378479009069705,0.38670727978384556,0.3781415212406703,0.3740616612152167,0.38342091833532743,0.3629652990971918,0.3859590382536081,0.36995553924582447,0.37095099503650264,0.3769915975560255,0.3749623239016635,0.3592196345178012,0.37153408770509894,0.37871152805247044,0.36459816992476535,0.3753378888703937,0.3671763628380478,0.35711539640987905,0.34991736695061443,0.3600953984884578,0.36168713123632884,0.3512023155527678],"type":"scatter","xaxis":"x","yaxis":"y"},{"legendgroup":"3","line":{"color":"#d62728"},"mode":"lines","name":" layer 3","showlegend":true,"x":[1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,11000.0,12000.0,13000.0,14000.0,15000.0,16000.0,17000.0,18000.0,19000.0,20000.0,21000.0,22000.0,23000.0,24000.0,25000.0,26000.0,27000.0,28000.0,29000.0,30000.0,31000.0,32000.0,33000.0,34000.0,35000.0,36000.0,37000.0,38000.0,39000.0,40000.0,41000.0,42000.0,43000.0,44000.0,45000.0,46000.0,47000.0,48000.0,49000.0,50000.0,51000.0,52000.0,53000.0,54000.0,55000.0,56000.0,57000.0,58000.0,59000.0,60000.0,61000.0,62000.0,63000.0,64000.0,65000.0,66000.0,67000.0,68000.0,69000.0,70000.0,71000.0,72000.0,73000.0,74000.0,75000.0,76000.0,77000.0,78000.0,79000.0,80000.0,81000.0,82000.0,83000.0,84000.0,85000.0,86000.0,87000.0,88000.0,89000.0,90000.0,91000.0,92000.0,93000.0,94000.0,95000.0,96000.0,97000.0,98000.0,99000.0,100000.0],"y":[0.8715342770397663,0.7563840482832166,0.6787617796732622,0.6528457936210447,0.6258480319176486,0.6167701655907164,0.5908677737925034,0.5625608380850808,0.553168118660172,0.5413605096366622,0.5371362210628268,0.5208337308690217,0.500715189199614,0.5131875762606299,0.4855127637560037,0.4787632030510622,0.49017494323011634,0.4744561730828431,0.4703783956524824,0.4643645489462219,0.4499479755333503,0.44304364668841845,0.4385655379950353,0.4483753401699074,0.45055119838459834,0.4433678617870539,0.4413828658033328,0.4143515089155264,0.41790545650279265,0.409716886232653,0.4164775029495541,0.4153489554596392,0.42129530001666116,0.39575785730884033,0.3986048113581078,0.39664891801199287,0.40149036977345687,0.39588152550976513,0.380501053674941,0.3871564977659722,0.3873142003157334,0.3972908046274407,0.39005280990460106,0.38230537468148434,0.3811394893728527,0.37433971095310564,0.36588672227086916,0.38594001070975775,0.37729162565715996,0.3600199444201515,0.36119389514538386,0.362499430104576,0.3619848948852615,0.35084061244380343,0.3523015611710458,0.3603563743001653,0.34828754460128686,0.36250620396798405,0.34684317296629236,0.33774791543417515,0.3509933290677892,0.33680192165539274,0.33659239384465006,0.3442538598237439,0.34214196307952965,0.33588723023925665,0.33817818437583475,0.32992137678777583,0.342627684748625,0.3256225838220834,0.3331347160754857,0.32714901844235567,0.3099391706641805,0.3237953711258679,0.3070028626662501,0.3127640469981423,0.32574220974099044,0.32155173354327743,0.3118888948699014,0.31953101684277546,0.3185955140292701,0.3048032246031492,0.3055707586859885,0.30984961762255464,0.30695482688295017,0.30554239344514567,0.3036470383680623,0.3223421485470438,0.3028053871244494,0.29802733198807274,0.3059280758551896,0.2907288318468633,0.29907489729361963,0.2864277255310832,0.3106224581154248,0.2870746413920228,0.2868439871416087,0.2916403426885214,0.29206981816071437,0.28223625568409],"type":"scatter","xaxis":"x","yaxis":"y"},{"legendgroup":"0","line":{"color":"#1f77b4"},"mode":"lines","name":" layer 0","showlegend":false,"x":[1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,11000.0,12000.0,13000.0,14000.0,15000.0,16000.0,17000.0,18000.0,19000.0,20000.0,21000.0,22000.0,23000.0,24000.0,25000.0,26000.0,27000.0,28000.0,29000.0,30000.0,31000.0,32000.0,33000.0,34000.0,35000.0,36000.0,37000.0,38000.0,39000.0,40000.0,41000.0,42000.0,43000.0,44000.0,45000.0,46000.0,47000.0,48000.0,49000.0,50000.0,51000.0,52000.0,53000.0,54000.0,55000.0,56000.0,57000.0,58000.0,59000.0,60000.0,61000.0,62000.0,63000.0,64000.0,65000.0,66000.0,67000.0,68000.0,69000.0,70000.0,71000.0,72000.0,73000.0,74000.0,75000.0,76000.0,77000.0,78000.0,79000.0,80000.0,81000.0,82000.0,83000.0,84000.0,85000.0,86000.0,87000.0,88000.0,89000.0,90000.0,91000.0,92000.0,93000.0,94000.0,95000.0,96000.0,97000.0,98000.0],"y":[0.89086248909235,0.8644292178928852,0.8523376576393843,0.8486142926033586,0.8400725663350895,0.852438898584526,0.8437088695743121,0.8416408833896567,0.8384214633447875,0.838208167452825,0.8304289664540981,0.8390987699114588,0.8348054993933952,0.832502015713725,0.8291249090147812,0.8367012242144323,0.8313521085052576,0.8289861032769031,0.8315928379640068,0.8314172805224996,0.8359201511613019,0.8338472211609153,0.825757310867355,0.8265110114500054,0.8289206028524548,0.8326800642013099,0.8227166965956183,0.8364572617230226,0.8312763545330796,0.8361929567589635,0.8271251071165485,0.8366180827041906,0.8424304233471548,0.8368227513846077,0.8288042521832764,0.8468078449397075,0.8290758000724189,0.8368429309121377,0.8346154235289778,0.8409557789598866,0.8257166984982609,0.8403508026877936,0.8341345391232631,0.8324122544030792,0.8274218728967033,0.8319391852801349,0.8412568667424425,0.8359379903690286,0.8283483121914774,0.8310950115282744,0.8389336141445025,0.8204436027857537,0.835322708371594,0.8362537790127069,0.8383139328332195,0.8248578099684393,0.8352540714991253,0.8468696637945766,0.836755584168349,0.8351646215740554,0.8343299862837029,0.8309736611950953,0.8378195850667718,0.8326213155062451,0.8341084865037972,0.8351649405607859,0.8357892941238835,0.8405818851182867,0.8408711731698102,0.8389013791661589,0.8309207435371165,0.8415484996804312,0.8374351927639515,0.8430736563152376,0.8258967241586299,0.8259295080666805,0.833834044209552,0.8279855058945123,0.8304250654968731,0.8349615833999114,0.8407030041922117,0.8340771166525683,0.8314482023546563,0.8363641194375611,0.8316882868606819,0.8438857734246565,0.8341140189739417,0.8228204969157094,0.8276419306169268,0.8318715001306293,0.8364172200721312,0.8335525600158711,0.8277703761147314,0.8330009362914549,0.8242503774814016,0.8172291101948532,0.833876819385061,0.8274510631705758],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"legendgroup":"1","line":{"color":"#ff7f0e"},"mode":"lines","name":" layer 1","showlegend":false,"x":[1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,11000.0,12000.0,13000.0,14000.0,15000.0,16000.0,17000.0,18000.0,19000.0,20000.0,21000.0,22000.0,23000.0,24000.0,25000.0,26000.0,27000.0,28000.0,29000.0,30000.0,31000.0,32000.0,33000.0,34000.0,35000.0,36000.0,37000.0,38000.0,39000.0,40000.0,41000.0,42000.0,43000.0,44000.0,45000.0,46000.0,47000.0,48000.0,49000.0,50000.0,51000.0,52000.0,53000.0,54000.0,55000.0,56000.0,57000.0,58000.0,59000.0,60000.0,61000.0,62000.0,63000.0,64000.0,65000.0,66000.0,67000.0,68000.0,69000.0,70000.0,71000.0,72000.0,73000.0,74000.0,75000.0,76000.0,77000.0,78000.0,79000.0,80000.0,81000.0,82000.0,83000.0,84000.0,85000.0,86000.0,87000.0,88000.0,89000.0,90000.0,91000.0,92000.0,93000.0,94000.0,95000.0,96000.0,97000.0],"y":[0.7904013652026654,0.7041459442342981,0.6527332540594505,0.6215502320222965,0.5997066967217645,0.5895811267837586,0.5638540130962567,0.5482966472836311,0.5482257710717406,0.5445516289886716,0.5299333176748166,0.5118093874162757,0.5127946552791608,0.4988313516136023,0.49552940912077775,0.48250768454816007,0.4727812751782991,0.4672652864035746,0.47032303958304267,0.4657289479116869,0.46885498606512555,0.45231046217302373,0.45579348714076595,0.45941626917390005,0.455969677726197,0.45866764803001986,0.45362316494987026,0.45186337396226256,0.4469991051936948,0.43547278607966344,0.4415331499786664,0.4383502118522067,0.4435555359800773,0.45777182236213576,0.44587231738081756,0.4399918648589568,0.42112844407761924,0.43996207785756053,0.436758847288627,0.42858397740182097,0.4430226076903378,0.4386000865802358,0.426943723839647,0.43871067636461647,0.4250367404809088,0.43881591459106295,0.4312418129772362,0.4424245444877224,0.43864615939725643,0.4230601672578694,0.42997644682174213,0.4322088173103701,0.4331277580587621,0.43906814448452397,0.4305478559919633,0.42502761156787744,0.42019778895976895,0.43427151283254917,0.4406816261989332,0.4291862242617683,0.4331927451830692,0.42831819975442176,0.42392962642389703,0.4314787970340427,0.4327969901045235,0.41628851314872534,0.4245201760612901,0.4162418897842208,0.4375872464053409,0.4316150415881202,0.4141608311830618,0.41940453866109145,0.4205237403737611,0.4259437457664947,0.40674423612645466,0.42909084774810596,0.42589860753549147,0.4175990165409719,0.41582839896598545,0.4071301862435203,0.4166386063608676,0.4162498610555869,0.41855635437122735,0.41491699357819123,0.40673450171037584,0.4239377379741646,0.4288944794386442,0.4148993493124296,0.40768599878982387,0.4193852960000031,0.4178658023610254,0.42471949128176223,0.40336342424630767,0.423131295125496,0.4284465201147712,0.4172552004622946,0.41165589722125606],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"legendgroup":"2","line":{"color":"#2ca02c"},"mode":"lines","name":" layer 2","showlegend":false,"x":[1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,11000.0,12000.0,13000.0,14000.0,15000.0,16000.0,17000.0,18000.0,19000.0,20000.0,21000.0,22000.0,23000.0,24000.0,25000.0,26000.0,27000.0,28000.0,29000.0,30000.0,31000.0,32000.0,33000.0,34000.0,35000.0,36000.0,37000.0,38000.0,39000.0,40000.0,41000.0,42000.0,43000.0,44000.0,45000.0,46000.0,47000.0,48000.0,49000.0,50000.0,51000.0,52000.0,53000.0,54000.0,55000.0,56000.0,57000.0,58000.0,59000.0,60000.0,61000.0,62000.0,63000.0,64000.0,65000.0,66000.0,67000.0,68000.0,69000.0,70000.0,71000.0,72000.0,73000.0,74000.0,75000.0,76000.0,77000.0,78000.0,79000.0,80000.0,81000.0,82000.0,83000.0,84000.0,85000.0,86000.0,87000.0,88000.0,89000.0,90000.0,91000.0,92000.0,93000.0,94000.0,95000.0,96000.0,97000.0],"y":[0.7229836520170793,0.530863743326416,0.4508699969195872,0.35773073126747396,0.33712336664073755,0.2854549766617637,0.24965010534992652,0.22620178778709152,0.19825033176203807,0.17132192549443367,0.15542165909030506,0.1311256162097216,0.11983693527291796,0.11118503993258401,0.10426724027509304,0.08636236934924377,0.08925114424860867,0.0746282206456157,0.07305633302701016,0.0714652289318152,0.05949244704380992,0.06279195810150666,0.059580892576670826,0.05034018549172263,0.05144289441121598,0.05062113243533192,0.04649164913663469,0.04834414203287575,0.03987707491266741,0.04556678374467008,0.04473667511074879,0.041341566836231726,0.04549169764183584,0.03823126572645957,0.03823223775074036,0.0371804967467162,0.03717967203221053,0.03732235735946295,0.038593914906468345,0.037095481926684236,0.029942092457316112,0.03666461751330114,0.033786080692203534,0.026576507624797956,0.03441201221254985,0.032510136144291636,0.03533536299445612,0.0318940556870098,0.03044323891515452,0.03168501091463886,0.028812916988770882,0.028225291579116105,0.029840287799038766,0.030082593762049508,0.0318728229503332,0.028203222643532182,0.029197103083558024,0.02787928727198,0.029166656284913575,0.02877634818004135,0.028345034978350326,0.025659447895302053,0.02886320692134388,0.025825156862027136,0.026792969944649376,0.02508289825901984,0.026906745974117467,0.03066679777110379,0.024377164257937296,0.02466479919077367,0.029082880738780535,0.024837247804117134,0.0255887250231465,0.029166616775278896,0.027948003218243672,0.02554114915817716,0.020840998609149182,0.027065530490676993,0.02553040387158735,0.02604664381621535,0.025004106765562206,0.023641814087835694,0.020333899246741238,0.024183388368729256,0.02755647081765518,0.027177429188607948,0.02423544019982982,0.02608678044198681,0.024798473895074263,0.02366266164940302,0.021217096394284672,0.02241947183133951,0.024978903978978926,0.024947919201207387,0.02163056868474301,0.023492019671053743,0.023759637163844192],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"legendgroup":"3","line":{"color":"#d62728"},"mode":"lines","name":" layer 3","showlegend":false,"x":[1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,11000.0,12000.0,13000.0,14000.0,15000.0,16000.0,17000.0,18000.0,19000.0,20000.0,21000.0,22000.0,23000.0,24000.0,25000.0,26000.0,27000.0,28000.0,29000.0,30000.0,31000.0,32000.0,33000.0,34000.0,35000.0,36000.0,37000.0,38000.0,39000.0,40000.0,41000.0,42000.0,43000.0,44000.0,45000.0,46000.0,47000.0,48000.0,49000.0,50000.0,51000.0,52000.0,53000.0,54000.0,55000.0,56000.0,57000.0,58000.0,59000.0,60000.0,61000.0,62000.0,63000.0,64000.0,65000.0,66000.0,67000.0,68000.0,69000.0,70000.0,71000.0,72000.0,73000.0,74000.0,75000.0,76000.0,77000.0,78000.0,79000.0,80000.0,81000.0,82000.0,83000.0,84000.0,85000.0,86000.0,87000.0,88000.0,89000.0,90000.0,91000.0,92000.0,93000.0,94000.0,95000.0,96000.0,97000.0],"y":[0.8433747150942683,0.6671036101341088,0.5307124264045133,0.4503013466138116,0.39468407025766367,0.3464810396724336,0.3044515543658752,0.24717202550475026,0.23127736924839193,0.19682523720769993,0.1689789678985878,0.14868146051126566,0.1297958198113448,0.126525910365644,0.11121194390353141,0.10266214237022639,0.09755868942517443,0.09087168003862857,0.0814845584552159,0.07872690717214335,0.07550727795035614,0.08027365455967209,0.07342782147102482,0.07620559396445407,0.06674873133881655,0.07335025579901291,0.06660078532781404,0.06342307385997935,0.06683058103217161,0.06698964829820041,0.058890685883900735,0.06784741775847994,0.058534703357125864,0.06444121459163651,0.0660471233999969,0.05825959838700303,0.059431428689898085,0.06771871870616926,0.06625532236704777,0.060447917335829694,0.061702449676851234,0.06578003453024114,0.05225785393522466,0.06497469662214833,0.06646148651830804,0.06438535277481376,0.061620187765481525,0.06474799634075679,0.06888767773166819,0.05824573745344489,0.06408088793993207,0.06311577084019636,0.055364495116883634,0.06174047668739677,0.06568022483366702,0.058372973681106895,0.06569471176818652,0.060655756134803666,0.06764538330691235,0.06611906741042221,0.05938042674477095,0.05982507174814092,0.06111039154043258,0.05974460362281808,0.05797796394272148,0.06323790822950394,0.05592634120747605,0.06677835879531734,0.06490744488616461,0.06318688060356462,0.06803042128935546,0.0655247621026504,0.06330699014174024,0.06799380128155963,0.06950088037024398,0.06243826084638307,0.06460864567249941,0.056669515031152036,0.06179937107994208,0.05565478795974036,0.059292623892537116,0.06517752889973896,0.06402876638956857,0.056917393898127035,0.05646783183335402,0.061873233135139115,0.06351391420532833,0.06428590268736441,0.07490020486603521,0.06910988049512719,0.06335772955130435,0.060994286040395994,0.0661142794280524,0.060886590054476844,0.06662038401541188,0.06759999177630309,0.058394757102825066],"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"scatter":[{"type":"scatter"}]}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"training step"},"range":[1000.0,95000],"gridwidth":1,"linecolor":"white","gridcolor":"white","zerolinecolor":"white"},"yaxis":{"anchor":"x","domain":[0.0,1.0],"range":[0.0,1.0],"gridwidth":1,"linecolor":"white","gridcolor":"white","zerolinecolor":"white"},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"training step"},"range":[1000.0,95000],"gridwidth":1,"linecolor":"white","gridcolor":"white","zerolinecolor":"white"},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"range":[0.0,1.0],"gridwidth":1,"linecolor":"white","gridcolor":"white","zerolinecolor":"white"},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Mixture of Tokens","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Mixture of Tokens + Learnable Temperature","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"title":{"text":"Mean Entropy of Controller Weights","x":0.5},"width":1100,"plot_bgcolor":"#E5ECF6"},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
<div style="text-align: center;margin-bottom: 40px; margin-left: 30px;margin-right: 30px; opacity: 0.7;"> Allowing the temperature parameter to be learnable causes the mean entropy of weights drops to lower levels; in blocks 3 and 4, the entropy is near zero - which means that on average, almost all of the weight is attributed to just one token in a group.
</div>


<p>Interestingly, this comes at a cost of model performance.</p>


<meta charset="utf-8">

    <div>                            <div id="c01eeff4-2af7-4f04-9a2d-e031e193cd8e" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("c01eeff4-2af7-4f04-9a2d-e031e193cd8e")) {                    Plotly.newPlot(                        "c01eeff4-2af7-4f04-9a2d-e031e193cd8e",                        [{"name":"Mixture of Tokens","x":[1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,11000.0,12000.0,13000.0,14000.0,15000.0,16000.0,17000.0,18000.0,19000.0,20000.0,21000.0,22000.0,23000.0,24000.0,25000.0,26000.0,27000.0,28000.0,29000.0,30000.0,31000.0,32000.0,33000.0,34000.0,35000.0,36000.0,37000.0,38000.0,39000.0,40000.0,41000.0,42000.0,43000.0,44000.0,45000.0,46000.0,47000.0,48000.0,49000.0,50000.0,51000.0,52000.0,53000.0,54000.0,55000.0,56000.0,57000.0,58000.0,59000.0,60000.0,61000.0,62000.0,63000.0,64000.0,65000.0,66000.0,67000.0,68000.0,69000.0,70000.0,71000.0,72000.0,73000.0,74000.0,75000.0,76000.0,77000.0,78000.0,79000.0,80000.0,81000.0,82000.0,83000.0,84000.0,85000.0,86000.0,87000.0,88000.0,89000.0,90000.0,91000.0,92000.0,93000.0,94000.0,95000.0,96000.0,97000.0,98000.0,99000.0,100000.0,101000.0],"y":[6.918517035961151,5.551436553955078,5.0994048924446105,4.791284382343292,4.6247055625915525,4.527974368095398,4.456279224872589,4.402963979721069,4.3587812805175785,4.320325888633728,4.286883773803711,4.260787344455719,4.233225079059601,4.209809429645539,4.190095009326935,4.172042701721192,4.155731592655182,4.140487894058228,4.126637262821197,4.110589207172394,4.100636847019196,4.089007250070572,4.080440891504288,4.068159204244614,4.057788845300674,4.049972422361374,4.042480718612671,4.033562863111496,4.023763687610626,4.0155852353572845,4.011307383060456,4.0032365396022795,3.9953905274868013,3.9910224938392638,3.9830223090648653,3.9790543451309204,3.9743673293590547,3.968254778146744,3.961279109239578,3.9548626294136047,3.9507014994621277,3.9479884495735167,3.9431491885185244,3.9379277470111846,3.9341268956661226,3.926838760137558,3.9223360385894774,3.9181150472164155,3.9154972441196443,3.9117663230895996,3.90666405582428,3.902803817510605,3.899450142621994,3.89549116230011,3.8926183795928955,3.8894086337089537,3.8827987551689147,3.881021465301514,3.8794152085781097,3.875662763595581,3.8697057509422303,3.8685294506549837,3.8641657972335817,3.860497103691101,3.858923060417175,3.855267280817032,3.852627447605133,3.8491425139904023,3.845853754758835,3.844241472005844,3.839265150308609,3.840915034532547,3.8346545467376707,3.834509412050247,3.8291555683612826,3.8265615458488464,3.823843043088913,3.821787975549698,3.81968749833107,3.8164778306484224,3.812446595907211,3.8122864351272585,3.806402993917465,3.8049569432735444,3.8044334149360655,3.8014086873531343,3.7983676357269287,3.7970819687843322,3.79331490278244,3.7922652232646943,3.789400108575821,3.786338768720627,3.7856433959007263,3.783725396156311,3.779744246006012,3.7791175713539125,3.777110816478729,3.7721693065166475,3.7699952456951142,3.7701578793525696,3.7672179126739502],"type":"scatter"},{"name":"Mixture of Tokens + learnable temperature","x":[1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,11000.0,12000.0,13000.0,14000.0,15000.0,16000.0,17000.0,18000.0,19000.0,20000.0,21000.0,22000.0,23000.0,24000.0,25000.0,26000.0,27000.0,28000.0,29000.0,30000.0,31000.0,32000.0,33000.0,34000.0,35000.0,36000.0,37000.0,38000.0,39000.0,40000.0,41000.0,42000.0,43000.0,44000.0,45000.0,46000.0,47000.0,48000.0,49000.0,50000.0,51000.0,52000.0,53000.0,54000.0,55000.0,56000.0,57000.0,58000.0,59000.0,60000.0,61000.0,62000.0,63000.0,64000.0,65000.0,66000.0,67000.0,68000.0,69000.0,70000.0,71000.0,72000.0,73000.0,74000.0,75000.0,76000.0,77000.0,78000.0,79000.0,80000.0,81000.0,82000.0,83000.0,84000.0,85000.0,86000.0,87000.0,88000.0,89000.0,90000.0,91000.0,92000.0,93000.0,94000.0,95000.0,96000.0,97000.0,98000.0],"y":[6.961397614479065,5.527785311222076,5.083639989376068,4.787743222236633,4.615931591033935,4.518774859905243,4.447623687267304,4.394269061565399,4.351596297264099,4.3148665552139285,4.2831786742210385,4.258995296955109,4.23391444683075,4.213500856399536,4.197779324054718,4.183571853637695,4.172718603610992,4.162315162658691,4.153363065719605,4.144326208591461,4.139844332695008,4.134223731517792,4.1320511360168455,4.128011023521423,4.125094155788422,4.124519281864166,4.12172156381607,4.119281227111816,4.117195324897766,4.113595326900482,4.116644356250763,4.1153996109962465,4.114202406167984,4.114312876224518,4.11244775557518,4.112156430959701,4.1166483950614925,4.1139272215366365,4.1137141661643986,4.1126526355743405,4.1122781994342805,4.1139959030151365,4.114704311847687,4.114071372509002,4.114762283325195,4.112463498830795,4.111863212108612,4.110423413276672,4.111453009605408,4.111878177404404,4.1124672584533695,4.112732958078384,4.110842957258225,4.111398991346359,4.111745715856552,4.110214241027832,4.109309510707855,4.111585279226303,4.112042271375656,4.112441778182983,4.108191835880279,4.108944616794586,4.1057060277462005,4.103640729188919,4.104259989500045,4.102907100915909,4.102294079780578,4.102260387897491,4.099589063882828,4.100596388578415,4.096009262084961,4.098943897724151,4.094337257623672,4.0928680262565615,4.089011654376984,4.088371151685715,4.088033726453781,4.0864808559417725,4.085967931270599,4.083175613641739,4.0793143343925475,4.079367556810379,4.07477033495903,4.073304653167725,4.073782430648803,4.0708997683525086,4.068306635379791,4.064981014966965,4.060795704603195,4.060072214841843,4.057314954996109,4.05608574795723,4.056312828063965,4.055731618404389,4.051531780958175,4.048383668184281,4.0453285748958585,4.044117529153824],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"text":"Training Loss vs Step","x":0.5},"xaxis":{"range":[0,90000],"title":{"text":"training step"}},"yaxis":{"range":[3.5,5],"title":{"text":"loss"}}},                        {"responsive": true}                    )                };                            </script>        </div>


<p>We expect allowing the temperature to be learned at the end of training to be a very promising direction for “private” autoregressive decoding. That way, we would retain all the benefits of training with a high rate of token mixing, and prevent token mixing during inference.</p>
</section>
</section>
<section id="conclusions" class="level1">
<h1>Conclusions</h1>
<p>We have shown the preliminary results showing the promise of Mixture of Tokens improving the stability of training in comparison with MoE approaches and decreasing the training time <span class="math inline">\(3\times\)</span> when compared to the vanilla Transformer. We expect even greater improvements in larger models - more thorough experiments are underway at the moment and we plan to release the paper with more results in the coming weeks. In the meantime, you can contact us with any feedback you have at llm.random.team@gmail.com.<span class="SJ">add twitter begging ’retweet us.</span></p>
<ul>
<li>Method: SJ / MP / TO</li>
<li>TO przejrzy i myśli zmianie narracji</li>
</ul>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-BengioBPP15" class="csl-entry" role="listitem">
Bengio, Emmanuel, Pierre-Luc Bacon, Joelle Pineau, and Doina Precup. 2015. <span>“Conditional Computation in Neural Networks for Faster Models.”</span> <em>CoRR</em>. <a href="http://arxiv.org/abs/1511.06297">http://arxiv.org/abs/1511.06297</a>.
</div>
<div id="ref-chi2022representation" class="csl-entry" role="listitem">
Chi, Zewen, Li Dong, Shaohan Huang, Damai Dai, Shuming Ma, Barun Patra, Saksham Singhal, et al. 2022. <span>“On the Representation Collapse of Sparse Mixture of Experts.”</span> <a href="https://arxiv.org/abs/2204.09179">https://arxiv.org/abs/2204.09179</a>.
</div>
<div id="ref-clark2022unified" class="csl-entry" role="listitem">
Clark, Aidan, Diego de las Casas, Aurelia Guy, Arthur Mensch, Michela Paganini, Jordan Hoffmann, Bogdan Damoc, et al. 2022. <span>“Unified Scaling Laws for Routed Language Models.”</span> <a href="https://arxiv.org/abs/2202.01169">https://arxiv.org/abs/2202.01169</a>.
</div>
<div id="ref-dai2022stablemoe" class="csl-entry" role="listitem">
Dai, Damai, Li Dong, Shuming Ma, Bo Zheng, Zhifang Sui, Baobao Chang, and Furu Wei. 2022. <span>“StableMoE: Stable Routing Strategy for Mixture of Experts.”</span> <a href="https://arxiv.org/abs/2204.08396">https://arxiv.org/abs/2204.08396</a>.
</div>
<div id="ref-du2022glam" class="csl-entry" role="listitem">
Du, Nan, Yanping Huang, Andrew M. Dai, Simon Tong, Dmitry Lepikhin, Yuanzhong Xu, Maxim Krikun, et al. 2022. <span>“GLaM: Efficient Scaling of Language Models with Mixture-of-Experts.”</span> <a href="https://arxiv.org/abs/2112.06905">https://arxiv.org/abs/2112.06905</a>.
</div>
<div id="ref-fedus2022switch" class="csl-entry" role="listitem">
Fedus, William, Barret Zoph, and Noam Shazeer. 2022. <span>“Switch Transformers: Scaling to Trillion Parameter Models with Simple and Efficient Sparsity.”</span> <a href="https://arxiv.org/abs/2101.03961">https://arxiv.org/abs/2101.03961</a>.
</div>
<div id="ref-hoffmann2022training" class="csl-entry" role="listitem">
Hoffmann, Jordan, Sebastian Borgeaud, Arthur Mensch, Elena Buchatskaya, Trevor Cai, Eliza Rutherford, Diego de Las Casas, et al. 2022. <span>“Training Compute-Optimal Large Language Models.”</span> <a href="https://arxiv.org/abs/2203.15556">https://arxiv.org/abs/2203.15556</a>.
</div>
<div id="ref-jaszczur2021sparse" class="csl-entry" role="listitem">
Jaszczur, Sebastian, Aakanksha Chowdhery, Afroz Mohiuddin, Łukasz Kaiser, Wojciech Gajewski, Henryk Michalewski, and Jonni Kanerva. 2021. <span>“Sparse Is Enough in Scaling Transformers.”</span> <a href="https://arxiv.org/abs/2111.12763">https://arxiv.org/abs/2111.12763</a>.
</div>
<div id="ref-kaplan2020scaling" class="csl-entry" role="listitem">
Kaplan, Jared, Sam McCandlish, Tom Henighan, Tom B. Brown, Benjamin Chess, Rewon Child, Scott Gray, Alec Radford, Jeffrey Wu, and Dario Amodei. 2020. <span>“Scaling Laws for Neural Language Models.”</span> <a href="https://arxiv.org/abs/2001.08361">https://arxiv.org/abs/2001.08361</a>.
</div>
<div id="ref-base" class="csl-entry" role="listitem">
Lewis, Mike, Shruti Bhosale, Tim Dettmers, Naman Goyal, and Luke Zettlemoyer. 2021. <span>“<span>BASE</span> Layers: Simplifying Training of Large, Sparse Models.”</span> <em>CoRR</em>. <a href="https://arxiv.org/abs/2103.16716">https://arxiv.org/abs/2103.16716</a>.
</div>
<div id="ref-muqeeth2023soft" class="csl-entry" role="listitem">
Muqeeth, Mohammed, Haokun Liu, and Colin Raffel. 2023. <span>“Soft Merging of Experts with Adaptive Routing.”</span> <a href="https://arxiv.org/abs/2306.03745">https://arxiv.org/abs/2306.03745</a>.
</div>
<div id="ref-mustafa2022multimodal" class="csl-entry" role="listitem">
Mustafa, Basil, Carlos Riquelme, Joan Puigcerver, Rodolphe Jenatton, and Neil Houlsby. 2022. <span>“Multimodal Contrastive Learning with LIMoE: The Language-Image Mixture of Experts.”</span> <a href="https://arxiv.org/abs/2206.02770">https://arxiv.org/abs/2206.02770</a>.
</div>
<div id="ref-nawrot2022hierarchical" class="csl-entry" role="listitem">
Nawrot, Piotr, Szymon Tworkowski, Michał Tyrolski, Łukasz Kaiser, Yuhuai Wu, Christian Szegedy, and Henryk Michalewski. 2022. <span>“Hierarchical Transformers Are More Efficient Language Models.”</span> <a href="https://arxiv.org/abs/2110.13711">https://arxiv.org/abs/2110.13711</a>.
</div>
<div id="ref-puigcerver2023sparse" class="csl-entry" role="listitem">
Puigcerver, Joan, Carlos Riquelme, Basil Mustafa, and Neil Houlsby. 2023. <span>“From Sparse to Soft Mixtures of Experts.”</span> <a href="https://arxiv.org/abs/2308.00951">https://arxiv.org/abs/2308.00951</a>.
</div>
<div id="ref-rae2022scaling" class="csl-entry" role="listitem">
Rae, Jack W., Sebastian Borgeaud, Trevor Cai, Katie Millican, Jordan Hoffmann, Francis Song, John Aslanides, et al. 2022. <span>“Scaling Language Models: Methods, Analysis &amp; Insights from Training Gopher.”</span> <a href="https://arxiv.org/abs/2112.11446">https://arxiv.org/abs/2112.11446</a>.
</div>
<div id="ref-2019t5" class="csl-entry" role="listitem">
Raffel, Colin, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter J. Liu. 2019. <span>“Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer.”</span> <em>arXiv e-Prints</em>. <a href="https://arxiv.org/abs/1910.10683">https://arxiv.org/abs/1910.10683</a>.
</div>
<div id="ref-bpr" class="csl-entry" role="listitem">
Riquelme, Carlos, Joan Puigcerver, Basil Mustafa, Maxim Neumann, Rodolphe Jenatton, André Susano Pinto, Daniel Keysers, and Neil Houlsby. 2021. <span>“Scaling Vision with Sparse Mixture of Experts.”</span> <em>CoRR</em>. <a href="https://arxiv.org/abs/2106.05974">https://arxiv.org/abs/2106.05974</a>.
</div>
<div id="ref-04426" class="csl-entry" role="listitem">
Roller, Stephen, Sainbayar Sukhbaatar, Arthur Szlam, and Jason Weston. 2021. <span>“Hash Layers for Large Sparse Models.”</span> <em>CoRR</em>. <a href="https://arxiv.org/abs/2106.04426">https://arxiv.org/abs/2106.04426</a>.
</div>
<div id="ref-shazeer2017outrageously" class="csl-entry" role="listitem">
Shazeer, Noam, Azalia Mirhoseini, Krzysztof Maziarz, Andy Davis, Quoc Le, Geoffrey Hinton, and Jeff Dean. 2017. <span>“Outrageously Large Neural Networks: The Sparsely-Gated Mixture-of-Experts Layer.”</span> <a href="https://arxiv.org/abs/1701.06538">https://arxiv.org/abs/1701.06538</a>.
</div>
<div id="ref-zhou2022mixtureofexperts" class="csl-entry" role="listitem">
Zhou, Yanqi, Tao Lei, Hanxiao Liu, Nan Du, Yanping Huang, Vincent Zhao, Andrew Dai, Zhifeng Chen, Quoc Le, and James Laudon. 2022. <span>“Mixture-of-Experts with Expert Choice Routing.”</span> <a href="https://arxiv.org/abs/2202.09368">https://arxiv.org/abs/2202.09368</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><em>router</em> is also commonly used in MoE literature.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>